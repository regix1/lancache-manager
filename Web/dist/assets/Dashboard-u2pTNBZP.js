import{j as e,r,d as xe,e as ve,f as ge,g as pe,I as be,A as ye,U as fe,D as Ce,h as je,Z as Ne,T as we,H as De,i as ke,k as Se,l as Te,m as ae,n as Le,E as Re,b as Me,G as He,o as Ee}from"./react-vendor-LpjEarnW.js";import{u as Ae,S as J}from"./index-CXPP-Msr.js";import{f,C as Z,a as q,b as se}from"./Card-vPWNGdfI.js";import{C as Be}from"./charts-B1PwCyAI.js";import{C as Ie}from"./Tooltip-a5JlcxGz.js";import"./vendor-BmYUbuLR.js";import"./tanstack-CPlEqbpz.js";const Oe=({title:o,value:x,subtitle:b,icon:y,color:m,tooltip:n})=>{const d=N=>{const v={blue:"var(--theme-icon-blue)",green:"var(--theme-icon-green)",emerald:"var(--theme-icon-emerald)",purple:"var(--theme-icon-purple)",indigo:"var(--theme-icon-indigo)",orange:"var(--theme-icon-orange)",yellow:"var(--theme-icon-yellow)",cyan:"var(--theme-icon-cyan)",red:"var(--theme-icon-red)"};return v[N]||v.blue};return e.jsx("div",{className:"rounded-lg p-4 border transition-all hover:shadow-lg relative group",style:{backgroundColor:"var(--theme-card-bg)",borderColor:"var(--theme-card-border)",cursor:n?"help":"default"},title:n,"data-stat-card":o.toLowerCase().replace(/\s+/g,""),children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium inline-block transition-colors",style:{color:n?"var(--theme-text-secondary)":"var(--theme-text-muted)",borderBottom:n?"1px dotted currentColor":"none",paddingBottom:n?"1px":"0",opacity:n?"0.9":"1"},children:o}),e.jsx("p",{className:"text-2xl font-bold mt-1",style:{color:"var(--theme-text-primary)"},children:x}),b&&e.jsx("p",{className:"text-xs mt-1",style:{color:"var(--theme-text-secondary)"},children:b})]}),e.jsx("div",{className:"p-3 rounded-lg",style:{backgroundColor:d(m)},children:e.jsx(y,{className:"w-6 h-6",style:{color:"#ffffff"}})})]})})},Pe=({serviceStats:o})=>{var T;const[x,b]=r.useState(0),[y,m]=r.useState(100),[n,d]=r.useState(0),N=r.useRef(null),v=r.useRef(null),M=r.useRef(""),C=[{name:"Service Distribution",id:"service"},{name:"Cache Hit Ratio",id:"hit-ratio"},{name:"Bandwidth Saved",id:"bandwidth"}],R=()=>{const a=getComputedStyle(document.documentElement),c=[a.getPropertyValue("--theme-chart-1").trim(),a.getPropertyValue("--theme-chart-2").trim(),a.getPropertyValue("--theme-chart-3").trim(),a.getPropertyValue("--theme-chart-4").trim(),a.getPropertyValue("--theme-chart-5").trim(),a.getPropertyValue("--theme-chart-6").trim(),a.getPropertyValue("--theme-chart-7").trim(),a.getPropertyValue("--theme-chart-8").trim()],u=["#3b82f6","#10b981","#f59e0b","#ef4444","#8b5cf6","#06b6d4","#f97316","#ec4899"];return c.map((l,i)=>l||u[i])},I=r.useMemo(()=>{if(!o||o.length===0)return{labels:[],data:[],colors:[]};const a=o.reduce((l,i)=>l+(i.totalBytes||0),0);if(a===0)return{labels:[],data:[],colors:[]};const c=R(),u=o.map(l=>({name:l.service,value:l.totalBytes,percentage:l.totalBytes/a*100})).sort((l,i)=>i.value-l.value);return{labels:u.map(l=>l.name),data:u.map(l=>l.value),colors:u.map((l,i)=>c[i%c.length])}},[o]),V=r.useMemo(()=>{if(!o||o.length===0)return{labels:[],data:[],colors:[]};const a=o.reduce((p,g)=>p+(g.totalCacheHitBytes||0),0),c=o.reduce((p,g)=>p+(g.totalCacheMissBytes||0),0);if(a+c===0)return{labels:[],data:[],colors:[]};const l=getComputedStyle(document.documentElement),i=l.getPropertyValue("--theme-chart-cache-hit").trim()||"#10b981",S=l.getPropertyValue("--theme-chart-cache-miss").trim()||"#f59e0b";return{labels:["Cache Hits","Cache Misses"],data:[a,c],colors:[i,S]}},[o]),h=r.useMemo(()=>{if(!o||o.length===0)return{labels:[],data:[],colors:[]};const a=o.map(l=>({name:l.service,value:l.totalCacheHitBytes||0,percentage:0})).filter(l=>l.value>0).sort((l,i)=>i.value-l.value),c=a.reduce((l,i)=>l+i.value,0);if(c===0)return{labels:[],data:[],colors:[]};a.forEach(l=>{l.percentage=l.value/c*100});const u=R();return{labels:a.map(l=>l.name),data:a.map(l=>l.value),colors:a.map((l,i)=>u[i%u.length])}},[o]),w=r.useMemo(()=>{var a;switch((a=C[x])==null?void 0:a.id){case"service":return I;case"hit-ratio":return V;case"bandwidth":return h;default:return I}},[x,I,V,h]),H=r.useMemo(()=>{var S;const a=(S=C[x])==null?void 0:S.id,c=o.reduce((p,g)=>p+(g.totalBytes||0),0),u=o.reduce((p,g)=>p+(g.totalCacheHitBytes||0),0),l=o.reduce((p,g)=>p+(g.totalCacheMissBytes||0),0),i=c>0?(u/c*100).toFixed(1):"0";switch(a){case"service":return{title:"Total Data by Service",description:"Shows the distribution of all data transferred across different gaming services",stats:[{label:"Total Data",value:f(c)},{label:"Services",value:o.length},{label:"Hit Ratio",value:`${i}%`}]};case"hit-ratio":return{title:"Cache Performance",description:"Ratio of data served from cache (hits) vs downloaded from internet (misses)",stats:[{label:"Cache Hits",value:f(u)},{label:"Cache Misses",value:f(l)},{label:"Efficiency",value:`${i}%`}]};case"bandwidth":return{title:"Internet Bandwidth Saved",description:"Amount of internet bandwidth saved by serving cached content locally",stats:[{label:"Total Saved",value:f(u)},{label:"Downloads Avoided",value:Math.round(u/(50*1024*1024*1024))||"0"},{label:"Cache Efficiency",value:`${i}%`}]};default:return{title:"",description:"",stats:[]}}},[x,o]);r.useEffect(()=>{const a=()=>{setTimeout(()=>{v.current&&(v.current.destroy(),v.current=null,d(c=>c+1))},50)};return window.addEventListener("themechange",a),()=>window.removeEventListener("themechange",a)},[]),r.useEffect(()=>{const a=setTimeout(()=>{d(c=>c+1)},100);return()=>clearTimeout(a)},[]),r.useEffect(()=>{if(!N.current||w.labels.length===0)return;const a=JSON.stringify({labels:w.labels,data:w.data}),c=a!==M.current;M.current=a,v.current&&v.current.destroy();const u=getComputedStyle(document.documentElement),l=u.getPropertyValue("--theme-chart-border").trim()||"#1f2937",i=u.getPropertyValue("--theme-chart-text").trim()||"#9ca3af",S=N.current.getContext("2d");if(S)return v.current=new Be(S,{type:"doughnut",data:{labels:w.labels,datasets:[{data:w.data,backgroundColor:w.colors,borderColor:l,borderWidth:2,borderRadius:0,spacing:0}]},options:{responsive:!0,maintainAspectRatio:!0,aspectRatio:1,layout:{padding:0},animation:{animateRotate:c,animateScale:!1,duration:c?750:0},plugins:{legend:{display:!1},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.8)",titleColor:"#ffffff",bodyColor:i,borderColor:l,borderWidth:1,cornerRadius:6,padding:12,displayColors:!0,callbacks:{label:p=>{var z;const g=p.raw,k=p.dataset.data.reduce((W,Y)=>W+Y,0),_=(g/k*100).toFixed(1),F=(z=C[x])==null?void 0:z.id;return F==="bandwidth"?`${p.label}: ${f(g)} saved (${_}%)`:F==="hit-ratio"?`${p.label}: ${f(g)} (${_}%)`:`${p.label}: ${f(g)} (${_}%)`}}}},cutout:"50%",radius:"90%"}}),()=>{v.current&&v.current.destroy()}},[w,y,x,n]);const O=200+(y-100)*2;return e.jsxs(Z,{padding:"none",children:[e.jsxs("div",{className:"p-6 pb-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("button",{onClick:()=>b(a=>(a-1+C.length)%C.length),className:"p-1 rounded-lg transition-colors mr-2",style:{color:"var(--theme-text-muted)"},onMouseEnter:a=>a.currentTarget.style.backgroundColor="var(--theme-bg-hover)",onMouseLeave:a=>a.currentTarget.style.backgroundColor="transparent",children:e.jsx(xe,{className:"w-4 h-4"})}),e.jsx("div",{className:"w-48 text-center",children:e.jsx("h3",{className:"text-lg font-semibold text-themed-primary truncate",children:(T=C[x])==null?void 0:T.name})}),e.jsx("button",{onClick:()=>b(a=>(a+1)%C.length),className:"p-1 rounded-lg transition-colors ml-2",style:{color:"var(--theme-text-muted)"},onMouseEnter:a=>a.currentTarget.style.backgroundColor="var(--theme-bg-hover)",onMouseLeave:a=>a.currentTarget.style.backgroundColor="transparent",children:e.jsx(ve,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>m(Math.max(60,y-10)),className:"p-1 rounded-lg transition-colors",style:{color:"var(--theme-text-muted)"},onMouseEnter:a=>a.currentTarget.style.backgroundColor="var(--theme-bg-hover)",onMouseLeave:a=>a.currentTarget.style.backgroundColor="transparent",children:e.jsx(ge,{className:"w-4 h-4"})}),e.jsxs("span",{className:"text-xs text-themed-muted",children:[y,"%"]}),e.jsx("button",{onClick:()=>m(Math.min(140,y+10)),className:"p-1 rounded-lg transition-colors",style:{color:"var(--theme-text-muted)"},onMouseEnter:a=>a.currentTarget.style.backgroundColor="var(--theme-bg-hover)",onMouseLeave:a=>a.currentTarget.style.backgroundColor="transparent",children:e.jsx(pe,{className:"w-4 h-4"})})]})]}),e.jsx("div",{className:"flex space-x-1",children:C.map((a,c)=>e.jsx("button",{onClick:()=>b(c),className:"h-1 flex-1 rounded-full transition-colors",style:{backgroundColor:c===x?"var(--theme-primary)":"var(--theme-bg-hover)"}},c))})]}),e.jsx("div",{className:"px-6 pb-6",children:w.labels.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex justify-center items-center",style:{height:`${O}px`,width:"100%"},children:e.jsx("div",{style:{width:`${Math.min(O,400)}px`,height:`${Math.min(O,400)}px`},children:e.jsx("canvas",{ref:N,style:{maxHeight:"100%",maxWidth:"100%"}},n)})}),w.labels.length>0&&e.jsx("div",{className:"mt-4 flex flex-wrap justify-center gap-3",children:w.labels.map((a,c)=>{const u=w.data[c],l=w.data.reduce((S,p)=>S+p,0),i=(u/l*100).toFixed(1);return e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("div",{className:"w-3 h-3 rounded",style:{backgroundColor:w.colors[c]}}),e.jsxs("span",{className:"text-xs text-themed-muted",children:[a,":"]}),e.jsxs("span",{className:"text-xs text-themed-primary font-medium",children:[i,"%"]})]},a)})}),e.jsxs("div",{className:"mt-6 pt-4 border-t",style:{borderColor:"var(--theme-border-primary)"},children:[e.jsxs("div",{className:"flex items-start gap-2 mb-3",children:[e.jsx(be,{className:"w-4 h-4 text-themed-muted mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-sm font-medium text-themed-secondary mb-1",children:H.title}),e.jsx("p",{className:"text-xs text-themed-muted leading-relaxed",children:H.description})]})]}),H.stats.length>0&&e.jsx("div",{className:"grid grid-cols-3 gap-4 mt-4",children:H.stats.map((a,c)=>e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xs text-themed-muted mb-0.5",children:a.label}),e.jsx("div",{className:"text-sm font-semibold text-themed-secondary",children:a.value})]},c))})]})]}):e.jsx("div",{className:"flex items-center justify-center h-48",children:e.jsx("p",{className:"text-themed-muted",children:"No data available"})})})]})},re=r.memo(({downloads:o=[],timeRange:x="24h"})=>{const b=r.useMemo(()=>({"15m":"Last 15 Minutes","30m":"Last 30 Minutes","1h":"Last Hour","6h":"Last 6 Hours","12h":"Last 12 Hours","24h":"Last 24 Hours","7d":"Last 7 Days","30d":"Last 30 Days","90d":"Last 90 Days",all:"All Time"})[x]||"Recent",[x]),y=8,m=r.useMemo(()=>[...o].sort((d,N)=>new Date(N.startTime).getTime()-new Date(d.startTime).getTime()).slice(0,y),[o]),n=r.useMemo(()=>{const d=o.length,N=o.reduce((C,R)=>C+(R.totalBytes||0),0),v=o.reduce((C,R)=>C+(R.cacheHitBytes||0),0),M=N>0?v/N*100:0;return{totalDownloads:d,totalBytes:N,totalCacheHits:v,overallHitRate:M}},[o]);return e.jsxs(Z,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-themed-primary",children:"Recent Downloads"}),e.jsxs("div",{className:"flex items-center gap-3",children:[o.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"text-xs text-themed-muted",children:[n.totalDownloads," total"]}),e.jsxs("span",{className:`text-xs px-2 py-0.5 rounded ${n.overallHitRate>50?"hit-rate-high":"hit-rate-warning"}`,children:[q(n.overallHitRate)," hit"]})]}),e.jsx("span",{className:"text-xs text-themed-muted",children:b})]})]}),e.jsx("div",{className:"space-y-3 max-h-[400px] overflow-y-auto",children:m.length>0?m.map((d,N)=>e.jsxs("div",{className:"rounded-lg p-3 border transition-all duration-200 themed-card hover:shadow-lg",style:{backgroundColor:"var(--theme-bg-primary)",borderColor:"var(--theme-border-primary)"},onMouseEnter:v=>v.currentTarget.style.borderColor="var(--theme-border-secondary)",onMouseLeave:v=>v.currentTarget.style.borderColor="var(--theme-border-primary)",children:[e.jsxs("div",{className:"flex justify-between items-start mb-1",children:[e.jsx("span",{className:"font-medium text-sm text-themed-accent",children:d.service}),e.jsx("span",{className:"text-xs text-themed-muted",children:se(d.startTime)})]}),e.jsx("div",{className:"text-xs text-themed-muted",children:d.clientIp}),d.gameName&&e.jsx("div",{className:"text-xs text-themed-muted mt-1 truncate",children:d.gameName}),e.jsxs("div",{className:"flex justify-between items-center mt-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-themed-primary text-sm",children:f(d.totalBytes)}),e.jsxs("div",{className:"flex gap-2 text-xs",children:[e.jsxs("span",{className:"cache-hit",children:["↓ ",f(d.cacheHitBytes)]}),e.jsxs("span",{className:"cache-miss",children:["↑ ",f(d.cacheMissBytes)]})]})]}),e.jsxs("span",{className:`text-xs px-2 py-1 rounded hit-rate-badge ${d.cacheHitPercent>75?"high":d.cacheHitPercent>50?"medium":d.cacheHitPercent>25?"low":"warning"}`,children:[q(d.cacheHitPercent)," Hit"]})]})]},d.id||N)):e.jsxs("div",{className:"flex items-center justify-center h-32 text-themed-muted",children:["No downloads in the ",b.toLowerCase()]})}),o.length>y&&e.jsx("div",{className:"mt-3 pt-3 border-t text-center",style:{borderColor:"var(--theme-border-primary)"},children:e.jsxs("span",{className:"text-xs text-themed-muted",children:["Showing ",y," of ",o.length," downloads"]})})]})});re.displayName="RecentDownloadsPanel";const le=r.memo(({clientStats:o=[],timeRange:x="24h"})=>{const b=r.useMemo(()=>({"15m":"Last 15 Minutes","30m":"Last 30 Minutes","1h":"Last Hour","6h":"Last 6 Hours","12h":"Last 12 Hours","24h":"Last 24 Hours","7d":"Last 7 Days","30d":"Last 30 Days","90d":"Last 90 Days",all:"All Time"})[x]||"Last 24 Hours",[x]),y=r.useMemo(()=>o.slice(0,10),[o]);return e.jsxs(Z,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-themed-primary flex items-center gap-2",children:["Top Clients",e.jsx(Ie,{})]}),e.jsx("span",{className:"text-xs text-themed-muted",children:b})]}),y.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-xs text-themed-muted uppercase tracking-wider",children:[e.jsx("th",{className:"pb-3",children:"Client IP"}),e.jsx("th",{className:"pb-3",children:"Total Downloaded"}),e.jsx("th",{className:"pb-3",children:"Cache Hits"}),e.jsx("th",{className:"pb-3",children:"Cache Misses"}),e.jsx("th",{className:"pb-3",children:"Hit Rate"}),e.jsx("th",{className:"pb-3",children:"Last Seen"})]})}),e.jsx("tbody",{className:"text-sm",children:y.map((m,n)=>e.jsxs("tr",{className:"hover:bg-themed-hover transition-colors",children:[e.jsx("td",{className:"py-3 text-themed-primary",children:m.clientIp}),e.jsx("td",{className:"py-3 text-themed-secondary",children:f(m.totalBytes)}),e.jsx("td",{className:"py-3 cache-hit",children:f(m.totalCacheHitBytes)}),e.jsx("td",{className:"py-3 cache-miss",children:f(m.totalCacheMissBytes)}),e.jsx("td",{className:"py-3",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs hit-rate-badge ${m.cacheHitPercent>50?"high":"warning"}`,children:q(m.cacheHitPercent)})}),e.jsx("td",{className:"py-3 text-themed-muted",children:se(m.lastSeen)})]},`${m.clientIp}-${n}`))})]})}):e.jsx("div",{className:"flex items-center justify-center h-32 text-themed-muted",children:"No client data available for selected time range"})]})});le.displayName="TopClientsTable";const G={totalCache:!0,usedSpace:!0,bandwidthSaved:!0,addedToCache:!0,totalServed:!0,activeDownloads:!0,activeClients:!0,cacheHitRatio:!0},Q=["totalCache","usedSpace","bandwidthSaved","addedToCache","totalServed","activeDownloads","activeClients","cacheHitRatio"],B={totalCache:"Total storage capacity of your LANCache system",usedSpace:"Amount of storage currently occupied by cached content",bandwidthSaved:"Amount of internet bandwidth saved by serving files from local cache instead of downloading them again",addedToCache:"New content downloaded and stored in cache for future use",totalServed:"Total amount of data delivered to clients (cache hits + new downloads)",activeDownloads:"Number of downloads currently in progress",activeClients:"Number of unique client devices that have accessed the cache",cacheHitRatio:"Percentage of requests served from cache vs downloaded from internet. Higher is better!"},Je=()=>{const{cacheInfo:o,activeDownloads:x,latestDownloads:b,clientStats:y,serviceStats:m}=Ae(),[n,d]=r.useState(null),[N]=r.useState(!1),[v,M]=r.useState(!1),[C,R]=r.useState(""),[I,V]=r.useState(!1),[h,w]=r.useState("24h"),H=r.useRef(null),O=r.useRef(null),[T,a]=r.useState(null),[c,u]=r.useState(null),l=r.useRef(0),[i,S]=r.useState(()=>{const t=localStorage.getItem(J.DASHBOARD_CARD_ORDER);if(t)try{const s=JSON.parse(t);if(Q.every(D=>s.includes(D)))return s}catch(s){console.error("Failed to parse card order:",s)}return Q});r.useEffect(()=>{localStorage.setItem(J.DASHBOARD_CARD_ORDER,JSON.stringify(i))},[i]);const p=[{label:"Last 15 minutes",value:"15m"},{label:"Last 30 minutes",value:"30m"},{label:"Last 1 hour",value:"1h"},{label:"Last 6 hours",value:"6h"},{label:"Last 12 hours",value:"12h"},{label:"Last 24 hours",value:"24h"},{label:"Last 7 days",value:"7d"},{label:"Last 30 days",value:"30d"},{label:"Last 90 days",value:"90d"},{label:"All time",value:"all"}],g=r.useCallback(t=>{const s=p.find(j=>j.value===t);return s?s.label:"Last 24 hours"},[]),[k,_]=r.useState(()=>{const t=localStorage.getItem(J.DASHBOARD_CARD_VISIBILITY);if(t)try{return{...G,...JSON.parse(t)}}catch(s){return console.error("Failed to parse card visibility settings:",s),G}return G});r.useEffect(()=>{localStorage.setItem(J.DASHBOARD_CARD_VISIBILITY,JSON.stringify(k))},[k]),r.useEffect(()=>{const t=s=>{H.current&&!H.current.contains(s.target)&&(M(!1),R("")),O.current&&!O.current.contains(s.target)&&V(!1)};return document.addEventListener("mousedown",t),()=>document.removeEventListener("mousedown",t)},[]);const F=r.useCallback((t,s)=>{var P;const j=s.reduce((A,$)=>A+($.totalCacheHitBytes||0),0),D=s.reduce((A,$)=>A+($.totalCacheMissBytes||0),0),L=j+D;return{totalBandwidthSaved:j,totalAddedToCache:D,totalServed:L,cacheHitRatio:L>0?j/L:0,activeDownloads:x.length,uniqueClients:[...new Set(t.map(A=>A.clientIp))].length,topService:((P=s[0])==null?void 0:P.service)||"steam",period:{duration:h,bandwidthSaved:j,addedToCache:D,totalServed:L,hitRatio:L>0?j/L:0,downloads:t.length}}},[h,x]);r.useEffect(()=>{if(b&&m){const t=F(b,m);d(t)}},[b,m,F]);const z=r.useCallback(t=>{_(s=>({...s,[t]:!s[t]}))},[]),W=r.useCallback((t,s)=>{a(s),t.dataTransfer.effectAllowed="move"},[]),Y=r.useCallback(()=>{a(null),u(null),l.current=0},[]),oe=r.useCallback(t=>{t.preventDefault(),t.dataTransfer.dropEffect="move"},[]),ne=r.useCallback((t,s)=>{t.preventDefault(),l.current++,s&&s!==T&&u(s)},[T]),ce=r.useCallback(()=>{l.current--,l.current===0&&u(null)},[]),ie=r.useCallback((t,s)=>{t.preventDefault(),t.stopPropagation(),T&&s&&T!==s&&S(j=>{const D=[...j],L=D.indexOf(T),P=D.indexOf(s);return D.splice(L,1),D.splice(P,0,T),D}),u(null),l.current=0},[T]),de=r.useCallback(()=>{S(Q)},[]),E=r.useMemo(()=>{var D,L,P,A;const t=[...new Set(x.map($=>$.clientIp))].length,s=x.length,j=m.reduce(($,ue)=>$+(ue.totalDownloads||0),0);return{activeClients:t,totalActiveDownloads:s,totalDownloads:j,bandwidthSaved:((D=n==null?void 0:n.period)==null?void 0:D.bandwidthSaved)||0,addedToCache:((L=n==null?void 0:n.period)==null?void 0:L.addedToCache)||0,totalServed:((P=n==null?void 0:n.period)==null?void 0:P.totalServed)||0,cacheHitRatio:((A=n==null?void 0:n.period)==null?void 0:A.hitRatio)||0,uniqueClients:(n==null?void 0:n.uniqueClients)||y.length}},[x,m,n,y]),X=r.useMemo(()=>{var t;return{totalCache:{key:"totalCache",title:"Total Cache",value:o?f(o.totalCacheSize):"0 B",subtitle:"Drive capacity",icon:ke,color:"blue",visible:k.totalCache,tooltip:B.totalCache},usedSpace:{key:"usedSpace",title:"Used Space",value:o?f(o.usedCacheSize):"0 B",subtitle:o?q(o.usagePercent):"0%",icon:De,color:"green",visible:k.usedSpace,tooltip:B.usedSpace},bandwidthSaved:{key:"bandwidthSaved",title:"Bandwidth Saved",value:f(E.bandwidthSaved),subtitle:h==="all"?"All-time saved":g(h).toLowerCase(),icon:we,color:"emerald",visible:k.bandwidthSaved,tooltip:B.bandwidthSaved},addedToCache:{key:"addedToCache",title:"Added to Cache",value:f(E.addedToCache),subtitle:h==="all"?"All-time cached":g(h).toLowerCase(),icon:Ne,color:"purple",visible:k.addedToCache,tooltip:B.addedToCache},totalServed:{key:"totalServed",title:"Total Served",value:f(E.totalServed),subtitle:h==="all"?"All-time served":g(h).toLowerCase(),icon:je,color:"indigo",visible:k.totalServed,tooltip:B.totalServed},activeDownloads:{key:"activeDownloads",title:"Active Downloads",value:E.totalActiveDownloads,subtitle:`${((t=n==null?void 0:n.period)==null?void 0:t.downloads)||b.length} in period`,icon:Ce,color:"orange",visible:k.activeDownloads,tooltip:B.activeDownloads},activeClients:{key:"activeClients",title:"Active Clients",value:E.uniqueClients,subtitle:`${E.totalDownloads} downloads`,icon:fe,color:"yellow",visible:k.activeClients,tooltip:B.activeClients},cacheHitRatio:{key:"cacheHitRatio",title:"Cache Hit Ratio",value:q(E.cacheHitRatio*100),subtitle:h==="all"?"Overall":g(h).toLowerCase(),icon:ye,color:"cyan",visible:k.cacheHitRatio,tooltip:B.cacheHitRatio}}},[o,k,E,h,g,n,b]),K=r.useMemo(()=>i.map(t=>X[t]).filter(t=>t!==void 0),[i,X]),me=K.filter(t=>t.visible),ee=K.filter(t=>!t.visible),U=ee.length,te=ee.filter(t=>t.title.toLowerCase().includes(C.toLowerCase())||t.subtitle&&t.subtitle.toLowerCase().includes(C.toLowerCase())),he=t=>({blue:"from-blue-500 to-blue-600",green:"from-green-500 to-green-600",emerald:"from-emerald-500 to-emerald-600",purple:"from-purple-500 to-purple-600",indigo:"from-indigo-500 to-indigo-600",orange:"from-orange-500 to-orange-600",yellow:"from-yellow-500 to-yellow-600",cyan:"from-cyan-500 to-cyan-600"})[t]||"from-gray-500 to-gray-600";return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-themed-primary tracking-tight",children:"Dashboard"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:de,className:"p-2 transition-colors rounded-lg",style:{color:"var(--theme-text-muted)",backgroundColor:"transparent"},onMouseEnter:t=>t.currentTarget.style.backgroundColor="var(--theme-bg-hover)",onMouseLeave:t=>t.currentTarget.style.backgroundColor="transparent",title:"Reset card layout to default",children:e.jsx(Se,{className:"w-4 h-4"})}),e.jsxs("div",{className:"relative",ref:O,children:[e.jsxs("button",{onClick:()=>V(!I),className:"flex items-center gap-2 px-4 py-2 rounded-lg border transition-colors",style:{backgroundColor:"var(--theme-bg-secondary)",borderColor:"var(--theme-border-primary)"},onMouseEnter:t=>t.currentTarget.style.backgroundColor="var(--theme-bg-hover)",onMouseLeave:t=>t.currentTarget.style.backgroundColor="var(--theme-bg-secondary)",children:[e.jsx(Te,{className:"w-4 h-4",style:{color:"var(--theme-text-muted)"}}),e.jsx("span",{className:"text-sm text-themed-secondary",children:g(h)}),e.jsx(ae,{className:`w-4 h-4 transition-transform ${I?"rotate-180":""}`,style:{color:"var(--theme-text-muted)"}})]}),I&&e.jsx("div",{className:"absolute right-0 mt-2 w-56 rounded-lg border shadow-xl z-50",style:{backgroundColor:"var(--theme-bg-secondary)",borderColor:"var(--theme-border-primary)"},children:e.jsxs("div",{className:"p-2",children:[e.jsx("div",{className:"text-xs font-semibold px-2 py-1.5 text-themed-muted",children:"Time Range"}),p.map(t=>e.jsx("button",{onClick:()=>{w(t.value),V(!1)},className:`w-full text-left px-3 py-2 rounded text-sm transition-colors ${h===t.value?"text-themed-accent":"text-themed-secondary"}`,style:{backgroundColor:h===t.value?"var(--theme-bg-hover)":"transparent"},onMouseEnter:s=>{h!==t.value&&(s.currentTarget.style.backgroundColor="var(--theme-bg-hover)")},onMouseLeave:s=>{h!==t.value&&(s.currentTarget.style.backgroundColor="transparent")},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:t.label}),h===t.value&&e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})]})},t.value))]})})]})]})]}),U>0&&e.jsxs("div",{className:"relative",ref:H,children:[e.jsxs("div",{className:"rounded-lg px-4 py-2 border flex items-center justify-between",style:{backgroundColor:"var(--theme-bg-secondary)",borderColor:"var(--theme-border-primary)"},children:[e.jsxs("span",{className:"text-sm text-themed-muted",children:[U," stat card",U!==1?"s":""," hidden"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>M(!v),className:"flex items-center gap-1 text-xs text-themed-accent transition-colors px-2 py-1 rounded-lg",onMouseEnter:t=>t.currentTarget.style.backgroundColor="var(--theme-bg-hover)",onMouseLeave:t=>t.currentTarget.style.backgroundColor="transparent",children:["Add cards",e.jsx(ae,{className:`w-3 h-3 transition-transform ${v?"rotate-180":""}`})]}),e.jsx("button",{onClick:()=>_(G),className:"text-xs text-themed-accent transition-colors px-2 py-1 rounded-lg",onMouseEnter:t=>t.currentTarget.style.backgroundColor="var(--theme-bg-hover)",onMouseLeave:t=>t.currentTarget.style.backgroundColor="transparent",children:"Show all"})]})]}),v&&e.jsxs("div",{className:"absolute right-0 mt-2 w-80 rounded-lg border shadow-xl z-50",style:{backgroundColor:"var(--theme-bg-secondary)",borderColor:"var(--theme-border-primary)"},children:[e.jsx("div",{className:"p-3 border-b",style:{borderColor:"var(--theme-border-primary)"},children:e.jsxs("div",{className:"relative",children:[e.jsx(Le,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-themed-muted"}),e.jsx("input",{type:"text",value:C,onChange:t=>R(t.target.value),placeholder:"Search hidden cards...",className:"w-full pl-10 pr-3 py-2 rounded-lg focus:outline-none text-sm themed-input",style:{backgroundColor:"var(--theme-bg-hover)",color:"var(--theme-text-primary)",border:"2px solid var(--theme-primary)"},autoFocus:!0})]})}),e.jsx("div",{className:"max-h-96 overflow-y-auto p-2",children:te.length>0?te.map(t=>{const s=t.icon;return e.jsxs("button",{onClick:()=>{z(t.key),U===1&&(M(!1),R(""))},className:"w-full p-3 rounded-lg transition-colors flex items-center gap-3 group",onMouseEnter:j=>j.currentTarget.style.backgroundColor="var(--theme-bg-hover)",onMouseLeave:j=>j.currentTarget.style.backgroundColor="transparent",children:[e.jsx("div",{className:`p-2 rounded-lg bg-gradient-to-br ${he(t.color)} group-hover:scale-110 transition-transform`,children:e.jsx(s,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("div",{className:"text-sm text-themed-secondary font-medium",children:t.title}),e.jsx("div",{className:"text-xs text-themed-muted",children:t.subtitle})]}),e.jsx(Re,{className:"w-4 h-4 text-themed-muted group-hover:text-themed-accent transition-colors"})]},t.key)}):e.jsxs("div",{className:"px-3 py-6 text-center text-themed-muted text-sm",children:['No hidden cards match "',C,'"']})})]})]}),N&&e.jsx("div",{className:"text-center py-4",children:e.jsxs("div",{className:"inline-flex items-center gap-2 text-themed-muted",children:[e.jsx(Me,{className:"animate-spin h-5 w-5"}),e.jsxs("span",{children:["Loading ",g(h).toLowerCase()," data..."]})]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:me.map(t=>e.jsxs("div",{className:"relative group",style:{boxShadow:c===t.key?"0 0 0 2px var(--theme-primary)":"none",cursor:T===t.key?"grabbing":"default"},draggable:!0,onDragStart:s=>W(s,t.key),onDragEnd:Y,onDragOver:oe,onDragEnter:s=>ne(s,t.key),onDragLeave:ce,onDrop:s=>ie(s,t.key),children:[e.jsx("div",{className:"absolute top-2 left-2 opacity-0 group-hover:opacity-100 transition-all p-1 rounded",style:{cursor:"grab",zIndex:10},title:"Drag to reorder",onMouseEnter:s=>{s.currentTarget.style.backgroundColor="var(--theme-bg-hover)"},onMouseLeave:s=>{s.currentTarget.style.backgroundColor="transparent"},children:e.jsx(He,{className:"w-4 h-4 transition-colors",style:{color:"var(--theme-drag-handle)"},onMouseEnter:s=>{s.currentTarget.style.color="var(--theme-drag-handle-hover)"},onMouseLeave:s=>{s.currentTarget.style.color="var(--theme-drag-handle)"}})}),e.jsx(Oe,{title:t.title,value:t.value,subtitle:t.subtitle,icon:t.icon,color:t.color,tooltip:t.tooltip}),e.jsx("button",{onClick:()=>z(t.key),className:"absolute top-2 right-2 p-1.5 rounded-lg opacity-0 group-hover:opacity-100 transition-opacity",style:{backgroundColor:"var(--theme-bg-hover)"},title:"Hide this card",children:e.jsx(Ee,{className:"w-3.5 h-3.5 text-themed-muted"})})]},t.key))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(Pe,{serviceStats:m||[],timeRange:h}),e.jsx(re,{downloads:b||[],timeRange:h})]}),e.jsx(le,{clientStats:y||[],downloads:b||[],timeRange:h})]})};export{Je as default};
//# sourceMappingURL=Dashboard-u2pTNBZP.js.map
