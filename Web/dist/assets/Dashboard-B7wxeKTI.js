import{j as e,r as s,d as xe,e as ve,f as ge,g as pe,I as be,A as ye,U as fe,D as Ce,h as je,Z as Ne,T as we,H as De,i as Se,k as ke,l as Te,m as ee,n as Re,E as Le,b as He,G as Me,o as Ee}from"./react-vendor-DGr9LWon.js";import{u as Ae,S as q}from"./index-B2aET8M8.js";import{f as y,C as Y,a as V,b as te}from"./Card-BNk8Xjj9.js";import{C as Be}from"./charts-B1PwCyAI.js";import{C as Ie}from"./Tooltip-BasvYt1I.js";import"./vendor-BmYUbuLR.js";import"./tanstack-CPlEqbpz.js";const Oe=({title:l,value:u,subtitle:p,icon:b,color:h,tooltip:n})=>{const i=w=>{const x={blue:"var(--theme-icon-blue)",green:"var(--theme-icon-green)",emerald:"var(--theme-icon-emerald)",purple:"var(--theme-icon-purple)",indigo:"var(--theme-icon-indigo)",orange:"var(--theme-icon-orange)",yellow:"var(--theme-icon-yellow)",cyan:"var(--theme-icon-cyan)",red:"var(--theme-icon-red)"};return x[w]||x.blue};return e.jsx("div",{className:"rounded-lg p-4 border transition-all hover:shadow-lg",style:{backgroundColor:"var(--theme-card-bg)",borderColor:"var(--theme-card-border)"},title:n,"data-stat-card":l.toLowerCase().replace(/\s+/g,""),children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium",style:{color:"var(--theme-text-muted)"},children:l}),e.jsx("p",{className:"text-2xl font-bold mt-1",style:{color:"var(--theme-text-primary)"},children:u}),p&&e.jsx("p",{className:"text-xs mt-1",style:{color:"var(--theme-text-secondary)"},children:p})]}),e.jsx("div",{className:"p-3 rounded-lg",style:{backgroundColor:i(h)},children:e.jsx(b,{className:"w-6 h-6",style:{color:"#ffffff"}})})]})})},Pe=({serviceStats:l})=>{var O;const[u,p]=s.useState(0),[b,h]=s.useState(100),n=s.useRef(null),i=s.useRef(null),w=s.useRef(""),x=[{name:"Service Distribution",id:"service"},{name:"Cache Hit Ratio",id:"hit-ratio"},{name:"Bandwidth Saved",id:"bandwidth"}],H=()=>{const a=getComputedStyle(document.documentElement);return[a.getPropertyValue("--theme-chart-1").trim()||"#3b82f6",a.getPropertyValue("--theme-chart-2").trim()||"#10b981",a.getPropertyValue("--theme-chart-3").trim()||"#f59e0b",a.getPropertyValue("--theme-chart-4").trim()||"#ef4444",a.getPropertyValue("--theme-chart-5").trim()||"#8b5cf6",a.getPropertyValue("--theme-chart-6").trim()||"#06b6d4",a.getPropertyValue("--theme-chart-7").trim()||"#f97316",a.getPropertyValue("--theme-chart-8").trim()||"#ec4899"]},k=s.useMemo(()=>{if(!l||l.length===0)return{labels:[],data:[],colors:[]};const a=l.reduce((o,m)=>o+(m.totalBytes||0),0);if(a===0)return{labels:[],data:[],colors:[]};const c=H(),g=l.map(o=>({name:o.service,value:o.totalBytes,percentage:o.totalBytes/a*100})).sort((o,m)=>m.value-o.value);return{labels:g.map(o=>o.name),data:g.map(o=>o.value),colors:g.map((o,m)=>c[m%c.length])}},[l]),L=s.useMemo(()=>{if(!l||l.length===0)return{labels:[],data:[],colors:[]};const a=l.reduce((v,f)=>v+(f.totalCacheHitBytes||0),0),c=l.reduce((v,f)=>v+(f.totalCacheMissBytes||0),0);if(a+c===0)return{labels:[],data:[],colors:[]};const o=getComputedStyle(document.documentElement),m=o.getPropertyValue("--theme-chart-cache-hit").trim()||"#10b981",N=o.getPropertyValue("--theme-chart-cache-miss").trim()||"#f59e0b";return{labels:["Cache Hits","Cache Misses"],data:[a,c],colors:[m,N]}},[l]),I=s.useMemo(()=>{if(!l||l.length===0)return{labels:[],data:[],colors:[]};const a=l.map(o=>({name:o.service,value:o.totalCacheHitBytes||0,percentage:0})).filter(o=>o.value>0).sort((o,m)=>m.value-o.value),c=a.reduce((o,m)=>o+m.value,0);if(c===0)return{labels:[],data:[],colors:[]};a.forEach(o=>{o.percentage=o.value/c*100});const g=H();return{labels:a.map(o=>o.name),data:a.map(o=>o.value),colors:a.map((o,m)=>g[m%g.length])}},[l]),C=s.useMemo(()=>{var a;switch((a=x[u])==null?void 0:a.id){case"service":return k;case"hit-ratio":return L;case"bandwidth":return I;default:return k}},[u,k,L,I]),d=s.useMemo(()=>{var N;const a=(N=x[u])==null?void 0:N.id,c=l.reduce((v,f)=>v+(f.totalBytes||0),0),g=l.reduce((v,f)=>v+(f.totalCacheHitBytes||0),0),o=l.reduce((v,f)=>v+(f.totalCacheMissBytes||0),0),m=c>0?(g/c*100).toFixed(1):"0";switch(a){case"service":return{title:"Total Data by Service",description:"Shows the distribution of all data transferred across different gaming services",stats:[{label:"Total Data",value:y(c)},{label:"Services",value:l.length},{label:"Hit Ratio",value:`${m}%`}]};case"hit-ratio":return{title:"Cache Performance",description:"Ratio of data served from cache (hits) vs downloaded from internet (misses)",stats:[{label:"Cache Hits",value:y(g)},{label:"Cache Misses",value:y(o)},{label:"Efficiency",value:`${m}%`}]};case"bandwidth":return{title:"Internet Bandwidth Saved",description:"Amount of internet bandwidth saved by serving cached content locally",stats:[{label:"Total Saved",value:y(g)},{label:"Downloads Avoided",value:Math.round(g/(50*1024*1024*1024))||"0"},{label:"Cache Efficiency",value:`${m}%`}]};default:return{title:"",description:"",stats:[]}}},[u,l]);s.useEffect(()=>{const a=()=>{i.current&&(i.current.destroy(),i.current=null)};return window.addEventListener("themechange",a),()=>window.removeEventListener("themechange",a)},[]),s.useEffect(()=>{if(!n.current||C.labels.length===0)return;const a=JSON.stringify({labels:C.labels,data:C.data}),c=a!==w.current;w.current=a,i.current&&i.current.destroy();const g=getComputedStyle(document.documentElement),o=g.getPropertyValue("--theme-chart-border").trim()||"#1f2937",m=g.getPropertyValue("--theme-chart-text").trim()||"#9ca3af",N=n.current.getContext("2d");if(N)return i.current=new Be(N,{type:"doughnut",data:{labels:C.labels,datasets:[{data:C.data,backgroundColor:C.colors,borderColor:o,borderWidth:2,borderRadius:0,spacing:0}]},options:{responsive:!0,maintainAspectRatio:!0,aspectRatio:1,layout:{padding:0},animation:{animateRotate:c,animateScale:!1,duration:c?750:0},plugins:{legend:{display:!1},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.8)",titleColor:"#ffffff",bodyColor:m,borderColor:o,borderWidth:1,cornerRadius:6,padding:12,displayColors:!0,callbacks:{label:v=>{var $;const f=v.raw,_=v.dataset.data.reduce((F,z)=>F+z,0),T=(f/_*100).toFixed(1),D=($=x[u])==null?void 0:$.id;return D==="bandwidth"?`${v.label}: ${y(f)} saved (${T}%)`:D==="hit-ratio"?`${v.label}: ${y(f)} (${T}%)`:`${v.label}: ${y(f)} (${T}%)`}}}},cutout:"50%",radius:"90%"}}),()=>{i.current&&i.current.destroy()}},[C,b,u]);const P=200+(b-100)*2;return e.jsxs(Y,{padding:"none",children:[e.jsxs("div",{className:"p-6 pb-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("button",{onClick:()=>p(a=>(a-1+x.length)%x.length),className:"p-1 rounded-lg transition-colors mr-2",style:{color:"var(--theme-text-muted)"},onMouseEnter:a=>a.currentTarget.style.backgroundColor="var(--theme-bg-hover)",onMouseLeave:a=>a.currentTarget.style.backgroundColor="transparent",children:e.jsx(xe,{className:"w-4 h-4"})}),e.jsx("div",{className:"w-48 text-center",children:e.jsx("h3",{className:"text-lg font-semibold text-themed-primary truncate",children:(O=x[u])==null?void 0:O.name})}),e.jsx("button",{onClick:()=>p(a=>(a+1)%x.length),className:"p-1 rounded-lg transition-colors ml-2",style:{color:"var(--theme-text-muted)"},onMouseEnter:a=>a.currentTarget.style.backgroundColor="var(--theme-bg-hover)",onMouseLeave:a=>a.currentTarget.style.backgroundColor="transparent",children:e.jsx(ve,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>h(Math.max(60,b-10)),className:"p-1 rounded-lg transition-colors",style:{color:"var(--theme-text-muted)"},onMouseEnter:a=>a.currentTarget.style.backgroundColor="var(--theme-bg-hover)",onMouseLeave:a=>a.currentTarget.style.backgroundColor="transparent",children:e.jsx(ge,{className:"w-4 h-4"})}),e.jsxs("span",{className:"text-xs text-themed-muted",children:[b,"%"]}),e.jsx("button",{onClick:()=>h(Math.min(140,b+10)),className:"p-1 rounded-lg transition-colors",style:{color:"var(--theme-text-muted)"},onMouseEnter:a=>a.currentTarget.style.backgroundColor="var(--theme-bg-hover)",onMouseLeave:a=>a.currentTarget.style.backgroundColor="transparent",children:e.jsx(pe,{className:"w-4 h-4"})})]})]}),e.jsx("div",{className:"flex space-x-1",children:x.map((a,c)=>e.jsx("button",{onClick:()=>p(c),className:"h-1 flex-1 rounded-full transition-colors",style:{backgroundColor:c===u?"var(--theme-primary)":"var(--theme-bg-hover)"}},c))})]}),e.jsx("div",{className:"px-6 pb-6",children:C.labels.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex justify-center items-center",style:{height:`${P}px`,width:"100%"},children:e.jsx("div",{style:{width:`${Math.min(P,400)}px`,height:`${Math.min(P,400)}px`},children:e.jsx("canvas",{ref:n,style:{maxHeight:"100%",maxWidth:"100%"}})})}),e.jsx("div",{className:"mt-4 flex flex-wrap justify-center gap-3",children:C.labels.map((a,c)=>{const g=C.data[c],o=C.data.reduce((N,v)=>N+v,0),m=(g/o*100).toFixed(1);return e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("div",{className:"w-3 h-3 rounded",style:{backgroundColor:C.colors[c]}}),e.jsxs("span",{className:"text-xs text-themed-muted",children:[a,":"]}),e.jsxs("span",{className:"text-xs text-themed-primary font-medium",children:[m,"%"]})]},a)})}),e.jsxs("div",{className:"mt-6 pt-4 border-t",style:{borderColor:"var(--theme-border-primary)"},children:[e.jsxs("div",{className:"flex items-start gap-2 mb-3",children:[e.jsx(be,{className:"w-4 h-4 text-themed-muted mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-sm font-medium text-themed-secondary mb-1",children:d.title}),e.jsx("p",{className:"text-xs text-themed-muted leading-relaxed",children:d.description})]})]}),d.stats.length>0&&e.jsx("div",{className:"grid grid-cols-3 gap-4 mt-4",children:d.stats.map((a,c)=>e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xs text-themed-muted mb-0.5",children:a.label}),e.jsx("div",{className:"text-sm font-semibold text-themed-secondary",children:a.value})]},c))})]})]}):e.jsx("div",{className:"flex items-center justify-center h-48",children:e.jsx("p",{className:"text-themed-muted",children:"No data available"})})})]})},ae=s.memo(({downloads:l=[],timeRange:u="24h"})=>{const p=s.useMemo(()=>({"15m":"Last 15 Minutes","30m":"Last 30 Minutes","1h":"Last Hour","6h":"Last 6 Hours","12h":"Last 12 Hours","24h":"Last 24 Hours","7d":"Last 7 Days","30d":"Last 30 Days","90d":"Last 90 Days",all:"All Time"})[u]||"Recent",[u]),b=8,h=s.useMemo(()=>[...l].sort((i,w)=>new Date(w.startTime).getTime()-new Date(i.startTime).getTime()).slice(0,b),[l]),n=s.useMemo(()=>{const i=l.length,w=l.reduce((k,L)=>k+(L.totalBytes||0),0),x=l.reduce((k,L)=>k+(L.cacheHitBytes||0),0),H=w>0?x/w*100:0;return{totalDownloads:i,totalBytes:w,totalCacheHits:x,overallHitRate:H}},[l]);return e.jsxs(Y,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-themed-primary",children:"Recent Downloads"}),e.jsxs("div",{className:"flex items-center gap-3",children:[l.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"text-xs text-themed-muted",children:[n.totalDownloads," total"]}),e.jsxs("span",{className:`text-xs px-2 py-0.5 rounded ${n.overallHitRate>50?"hit-rate-high":"hit-rate-warning"}`,children:[V(n.overallHitRate)," hit"]})]}),e.jsx("span",{className:"text-xs text-themed-muted",children:p})]})]}),e.jsx("div",{className:"space-y-3 max-h-[400px] overflow-y-auto",children:h.length>0?h.map((i,w)=>e.jsxs("div",{className:"rounded-lg p-3 border transition-all duration-200 themed-card hover:shadow-lg",style:{backgroundColor:"var(--theme-bg-primary)",borderColor:"var(--theme-border-primary)"},onMouseEnter:x=>x.currentTarget.style.borderColor="var(--theme-border-secondary)",onMouseLeave:x=>x.currentTarget.style.borderColor="var(--theme-border-primary)",children:[e.jsxs("div",{className:"flex justify-between items-start mb-1",children:[e.jsx("span",{className:"font-medium text-sm text-themed-accent",children:i.service}),e.jsx("span",{className:"text-xs text-themed-muted",children:te(i.startTime)})]}),e.jsx("div",{className:"text-xs text-themed-muted",children:i.clientIp}),i.gameName&&e.jsx("div",{className:"text-xs text-themed-muted mt-1 truncate",children:i.gameName}),e.jsxs("div",{className:"flex justify-between items-center mt-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-themed-primary text-sm",children:y(i.totalBytes)}),e.jsxs("div",{className:"flex gap-2 text-xs",children:[e.jsxs("span",{className:"cache-hit",children:["↓ ",y(i.cacheHitBytes)]}),e.jsxs("span",{className:"cache-miss",children:["↑ ",y(i.cacheMissBytes)]})]})]}),e.jsxs("span",{className:`text-xs px-2 py-1 rounded hit-rate-badge ${i.cacheHitPercent>75?"high":i.cacheHitPercent>50?"medium":i.cacheHitPercent>25?"low":"warning"}`,children:[V(i.cacheHitPercent)," Hit"]})]})]},i.id||w)):e.jsxs("div",{className:"flex items-center justify-center h-32 text-themed-muted",children:["No downloads in the ",p.toLowerCase()]})}),l.length>b&&e.jsx("div",{className:"mt-3 pt-3 border-t text-center",style:{borderColor:"var(--theme-border-primary)"},children:e.jsxs("span",{className:"text-xs text-themed-muted",children:["Showing ",b," of ",l.length," downloads"]})})]})});ae.displayName="RecentDownloadsPanel";const se=s.memo(({clientStats:l=[],timeRange:u="24h"})=>{const p=s.useMemo(()=>({"15m":"Last 15 Minutes","30m":"Last 30 Minutes","1h":"Last Hour","6h":"Last 6 Hours","12h":"Last 12 Hours","24h":"Last 24 Hours","7d":"Last 7 Days","30d":"Last 30 Days","90d":"Last 90 Days",all:"All Time"})[u]||"Last 24 Hours",[u]),b=s.useMemo(()=>l.slice(0,10),[l]);return e.jsxs(Y,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-themed-primary flex items-center gap-2",children:["Top Clients",e.jsx(Ie,{})]}),e.jsx("span",{className:"text-xs text-themed-muted",children:p})]}),b.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-xs text-themed-muted uppercase tracking-wider",children:[e.jsx("th",{className:"pb-3",children:"Client IP"}),e.jsx("th",{className:"pb-3",children:"Total Downloaded"}),e.jsx("th",{className:"pb-3",children:"Cache Hits"}),e.jsx("th",{className:"pb-3",children:"Cache Misses"}),e.jsx("th",{className:"pb-3",children:"Hit Rate"}),e.jsx("th",{className:"pb-3",children:"Last Seen"})]})}),e.jsx("tbody",{className:"text-sm",children:b.map((h,n)=>e.jsxs("tr",{className:"hover:bg-themed-hover transition-colors",children:[e.jsx("td",{className:"py-3 text-themed-primary",children:h.clientIp}),e.jsx("td",{className:"py-3 text-themed-secondary",children:y(h.totalBytes)}),e.jsx("td",{className:"py-3 cache-hit",children:y(h.totalCacheHitBytes)}),e.jsx("td",{className:"py-3 cache-miss",children:y(h.totalCacheMissBytes)}),e.jsx("td",{className:"py-3",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs hit-rate-badge ${h.cacheHitPercent>50?"high":"warning"}`,children:V(h.cacheHitPercent)})}),e.jsx("td",{className:"py-3 text-themed-muted",children:te(h.lastSeen)})]},`${h.clientIp}-${n}`))})]})}):e.jsx("div",{className:"flex items-center justify-center h-32 text-themed-muted",children:"No client data available for selected time range"})]})});se.displayName="TopClientsTable";const J={totalCache:!0,usedSpace:!0,bandwidthSaved:!0,addedToCache:!0,totalServed:!0,activeDownloads:!0,activeClients:!0,cacheHitRatio:!0},W=["totalCache","usedSpace","bandwidthSaved","addedToCache","totalServed","activeDownloads","activeClients","cacheHitRatio"],G={bandwidthSaved:"Amount of internet bandwidth saved by serving files from local cache instead of downloading them again",addedToCache:"New content downloaded and stored in cache for future use",totalServed:"Total amount of data delivered to clients (cache hits + new downloads)",cacheHitRatio:"Percentage of requests served from cache vs downloaded from internet. Higher is better!"},Je=()=>{const{cacheInfo:l,activeDownloads:u,latestDownloads:p,clientStats:b,serviceStats:h}=Ae(),[n,i]=s.useState(null),[w]=s.useState(!1),[x,H]=s.useState(!1),[k,L]=s.useState(""),[I,C]=s.useState(!1),[d,P]=s.useState("24h"),O=s.useRef(null),a=s.useRef(null),[c,g]=s.useState(null),[o,m]=s.useState(null),N=s.useRef(0),[v,f]=s.useState(()=>{const t=localStorage.getItem(q.DASHBOARD_CARD_ORDER);if(t)try{const r=JSON.parse(t);if(W.every(S=>r.includes(S)))return r}catch(r){console.error("Failed to parse card order:",r)}return W});s.useEffect(()=>{localStorage.setItem(q.DASHBOARD_CARD_ORDER,JSON.stringify(v))},[v]);const _=[{label:"Last 15 minutes",value:"15m"},{label:"Last 30 minutes",value:"30m"},{label:"Last 1 hour",value:"1h"},{label:"Last 6 hours",value:"6h"},{label:"Last 12 hours",value:"12h"},{label:"Last 24 hours",value:"24h"},{label:"Last 7 days",value:"7d"},{label:"Last 30 days",value:"30d"},{label:"Last 90 days",value:"90d"},{label:"All time",value:"all"}],T=s.useCallback(t=>{const r=_.find(j=>j.value===t);return r?r.label:"Last 24 hours"},[]),[D,$]=s.useState(()=>{const t=localStorage.getItem(q.DASHBOARD_CARD_VISIBILITY);if(t)try{return{...J,...JSON.parse(t)}}catch(r){return console.error("Failed to parse card visibility settings:",r),J}return J});s.useEffect(()=>{localStorage.setItem(q.DASHBOARD_CARD_VISIBILITY,JSON.stringify(D))},[D]),s.useEffect(()=>{const t=r=>{O.current&&!O.current.contains(r.target)&&(H(!1),L("")),a.current&&!a.current.contains(r.target)&&C(!1)};return document.addEventListener("mousedown",t),()=>document.removeEventListener("mousedown",t)},[]);const F=s.useCallback((t,r)=>{var A;const j=r.reduce((E,B)=>E+(B.totalCacheHitBytes||0),0),S=r.reduce((E,B)=>E+(B.totalCacheMissBytes||0),0),R=j+S;return{totalBandwidthSaved:j,totalAddedToCache:S,totalServed:R,cacheHitRatio:R>0?j/R:0,activeDownloads:u.length,uniqueClients:[...new Set(t.map(E=>E.clientIp))].length,topService:((A=r[0])==null?void 0:A.service)||"steam",period:{duration:d,bandwidthSaved:j,addedToCache:S,totalServed:R,hitRatio:R>0?j/R:0,downloads:t.length}}},[d,u]);s.useEffect(()=>{if(p&&h){const t=F(p,h);i(t)}},[p,h,F]);const z=s.useCallback(t=>{$(r=>({...r,[t]:!r[t]}))},[]),re=s.useCallback((t,r)=>{g(r),t.dataTransfer.effectAllowed="move"},[]),le=s.useCallback(()=>{g(null),m(null),N.current=0},[]),oe=s.useCallback(t=>{t.preventDefault(),t.dataTransfer.dropEffect="move"},[]),ne=s.useCallback((t,r)=>{t.preventDefault(),N.current++,r&&r!==c&&m(r)},[c]),ce=s.useCallback(()=>{N.current--,N.current===0&&m(null)},[]),ie=s.useCallback((t,r)=>{t.preventDefault(),t.stopPropagation(),c&&r&&c!==r&&f(j=>{const S=[...j],R=S.indexOf(c),A=S.indexOf(r);return S.splice(R,1),S.splice(A,0,c),S}),m(null),N.current=0},[c]),de=s.useCallback(()=>{f(W)},[]),M=s.useMemo(()=>{var S,R,A,E;const t=[...new Set(u.map(B=>B.clientIp))].length,r=u.length,j=h.reduce((B,ue)=>B+(ue.totalDownloads||0),0);return{activeClients:t,totalActiveDownloads:r,totalDownloads:j,bandwidthSaved:((S=n==null?void 0:n.period)==null?void 0:S.bandwidthSaved)||0,addedToCache:((R=n==null?void 0:n.period)==null?void 0:R.addedToCache)||0,totalServed:((A=n==null?void 0:n.period)==null?void 0:A.totalServed)||0,cacheHitRatio:((E=n==null?void 0:n.period)==null?void 0:E.hitRatio)||0,uniqueClients:(n==null?void 0:n.uniqueClients)||b.length}},[u,h,n,b]),Q=s.useMemo(()=>{var t;return{totalCache:{key:"totalCache",title:"Total Cache",value:l?y(l.totalCacheSize):"0 B",subtitle:"Drive capacity",icon:Se,color:"blue",visible:D.totalCache},usedSpace:{key:"usedSpace",title:"Used Space",value:l?y(l.usedCacheSize):"0 B",subtitle:l?V(l.usagePercent):"0%",icon:De,color:"green",visible:D.usedSpace},bandwidthSaved:{key:"bandwidthSaved",title:"Bandwidth Saved",value:y(M.bandwidthSaved),subtitle:d==="all"?"All-time saved":T(d).toLowerCase(),icon:we,color:"emerald",visible:D.bandwidthSaved,tooltip:G.bandwidthSaved},addedToCache:{key:"addedToCache",title:"Added to Cache",value:y(M.addedToCache),subtitle:d==="all"?"All-time cached":T(d).toLowerCase(),icon:Ne,color:"purple",visible:D.addedToCache,tooltip:G.addedToCache},totalServed:{key:"totalServed",title:"Total Served",value:y(M.totalServed),subtitle:d==="all"?"All-time served":T(d).toLowerCase(),icon:je,color:"indigo",visible:D.totalServed,tooltip:G.totalServed},activeDownloads:{key:"activeDownloads",title:"Active Downloads",value:M.totalActiveDownloads,subtitle:`${((t=n==null?void 0:n.period)==null?void 0:t.downloads)||p.length} in period`,icon:Ce,color:"orange",visible:D.activeDownloads},activeClients:{key:"activeClients",title:"Active Clients",value:M.uniqueClients,subtitle:`${M.totalDownloads} downloads`,icon:fe,color:"yellow",visible:D.activeClients},cacheHitRatio:{key:"cacheHitRatio",title:"Cache Hit Ratio",value:V(M.cacheHitRatio*100),subtitle:d==="all"?"Overall":T(d).toLowerCase(),icon:ye,color:"cyan",visible:D.cacheHitRatio,tooltip:G.cacheHitRatio}}},[l,D,M,d,T,n,p]),Z=s.useMemo(()=>v.map(t=>Q[t]).filter(t=>t!==void 0),[v,Q]),me=Z.filter(t=>t.visible),X=Z.filter(t=>!t.visible),U=X.length,K=X.filter(t=>t.title.toLowerCase().includes(k.toLowerCase())||t.subtitle&&t.subtitle.toLowerCase().includes(k.toLowerCase())),he=t=>({blue:"from-blue-500 to-blue-600",green:"from-green-500 to-green-600",emerald:"from-emerald-500 to-emerald-600",purple:"from-purple-500 to-purple-600",indigo:"from-indigo-500 to-indigo-600",orange:"from-orange-500 to-orange-600",yellow:"from-yellow-500 to-yellow-600",cyan:"from-cyan-500 to-cyan-600"})[t]||"from-gray-500 to-gray-600";return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-themed-primary tracking-tight",children:"Dashboard"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:de,className:"p-2 transition-colors rounded-lg",style:{color:"var(--theme-text-muted)",backgroundColor:"transparent"},onMouseEnter:t=>t.currentTarget.style.backgroundColor="var(--theme-bg-hover)",onMouseLeave:t=>t.currentTarget.style.backgroundColor="transparent",title:"Reset card layout to default",children:e.jsx(ke,{className:"w-4 h-4"})}),e.jsxs("div",{className:"relative",ref:a,children:[e.jsxs("button",{onClick:()=>C(!I),className:"flex items-center gap-2 px-4 py-2 rounded-lg border transition-colors",style:{backgroundColor:"var(--theme-bg-secondary)",borderColor:"var(--theme-border-primary)"},onMouseEnter:t=>t.currentTarget.style.backgroundColor="var(--theme-bg-hover)",onMouseLeave:t=>t.currentTarget.style.backgroundColor="var(--theme-bg-secondary)",children:[e.jsx(Te,{className:"w-4 h-4",style:{color:"var(--theme-text-muted)"}}),e.jsx("span",{className:"text-sm text-themed-secondary",children:T(d)}),e.jsx(ee,{className:`w-4 h-4 transition-transform ${I?"rotate-180":""}`,style:{color:"var(--theme-text-muted)"}})]}),I&&e.jsx("div",{className:"absolute right-0 mt-2 w-56 rounded-lg border shadow-xl z-50",style:{backgroundColor:"var(--theme-bg-secondary)",borderColor:"var(--theme-border-primary)"},children:e.jsxs("div",{className:"p-2",children:[e.jsx("div",{className:"text-xs font-semibold px-2 py-1.5 text-themed-muted",children:"Time Range"}),_.map(t=>e.jsx("button",{onClick:()=>{P(t.value),C(!1)},className:`w-full text-left px-3 py-2 rounded text-sm transition-colors ${d===t.value?"text-themed-accent":"text-themed-secondary"}`,style:{backgroundColor:d===t.value?"var(--theme-bg-hover)":"transparent"},onMouseEnter:r=>{d!==t.value&&(r.currentTarget.style.backgroundColor="var(--theme-bg-hover)")},onMouseLeave:r=>{d!==t.value&&(r.currentTarget.style.backgroundColor="transparent")},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:t.label}),d===t.value&&e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})]})},t.value))]})})]})]})]}),U>0&&e.jsxs("div",{className:"relative",ref:O,children:[e.jsxs("div",{className:"rounded-lg px-4 py-2 border flex items-center justify-between",style:{backgroundColor:"var(--theme-bg-secondary)",borderColor:"var(--theme-border-primary)"},children:[e.jsxs("span",{className:"text-sm text-themed-muted",children:[U," stat card",U!==1?"s":""," hidden"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>H(!x),className:"flex items-center gap-1 text-xs text-themed-accent transition-colors px-2 py-1 rounded-lg",onMouseEnter:t=>t.currentTarget.style.backgroundColor="var(--theme-bg-hover)",onMouseLeave:t=>t.currentTarget.style.backgroundColor="transparent",children:["Add cards",e.jsx(ee,{className:`w-3 h-3 transition-transform ${x?"rotate-180":""}`})]}),e.jsx("button",{onClick:()=>$(J),className:"text-xs text-themed-accent transition-colors px-2 py-1 rounded-lg",onMouseEnter:t=>t.currentTarget.style.backgroundColor="var(--theme-bg-hover)",onMouseLeave:t=>t.currentTarget.style.backgroundColor="transparent",children:"Show all"})]})]}),x&&e.jsxs("div",{className:"absolute right-0 mt-2 w-80 rounded-lg border shadow-xl z-50",style:{backgroundColor:"var(--theme-bg-secondary)",borderColor:"var(--theme-border-primary)"},children:[e.jsx("div",{className:"p-3 border-b",style:{borderColor:"var(--theme-border-primary)"},children:e.jsxs("div",{className:"relative",children:[e.jsx(Re,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-themed-muted"}),e.jsx("input",{type:"text",value:k,onChange:t=>L(t.target.value),placeholder:"Search hidden cards...",className:"w-full pl-10 pr-3 py-2 rounded-lg focus:outline-none text-sm themed-input",style:{backgroundColor:"var(--theme-bg-hover)",color:"var(--theme-text-primary)",border:"2px solid var(--theme-primary)"},autoFocus:!0})]})}),e.jsx("div",{className:"max-h-96 overflow-y-auto p-2",children:K.length>0?K.map(t=>{const r=t.icon;return e.jsxs("button",{onClick:()=>{z(t.key),U===1&&(H(!1),L(""))},className:"w-full p-3 rounded-lg transition-colors flex items-center gap-3 group",onMouseEnter:j=>j.currentTarget.style.backgroundColor="var(--theme-bg-hover)",onMouseLeave:j=>j.currentTarget.style.backgroundColor="transparent",children:[e.jsx("div",{className:`p-2 rounded-lg bg-gradient-to-br ${he(t.color)} group-hover:scale-110 transition-transform`,children:e.jsx(r,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("div",{className:"text-sm text-themed-secondary font-medium",children:t.title}),e.jsx("div",{className:"text-xs text-themed-muted",children:t.subtitle})]}),e.jsx(Le,{className:"w-4 h-4 text-themed-muted group-hover:text-themed-accent transition-colors"})]},t.key)}):e.jsxs("div",{className:"px-3 py-6 text-center text-themed-muted text-sm",children:['No hidden cards match "',k,'"']})})]})]}),w&&e.jsx("div",{className:"text-center py-4",children:e.jsxs("div",{className:"inline-flex items-center gap-2 text-themed-muted",children:[e.jsx(He,{className:"animate-spin h-5 w-5"}),e.jsxs("span",{children:["Loading ",T(d).toLowerCase()," data..."]})]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:me.map(t=>e.jsxs("div",{className:"relative group",style:{boxShadow:o===t.key?"0 0 0 2px var(--theme-primary)":"none"},draggable:!0,onDragStart:r=>re(r,t.key),onDragEnd:le,onDragOver:oe,onDragEnter:r=>ne(r,t.key),onDragLeave:ce,onDrop:r=>ie(r,t.key),children:[e.jsx("div",{className:"absolute top-2 left-2 opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none",children:e.jsx(Me,{className:"w-4 h-4 text-themed-muted"})}),e.jsx(Oe,{title:t.title,value:t.value,subtitle:t.subtitle,icon:t.icon,color:t.color,tooltip:t.tooltip}),e.jsx("button",{onClick:()=>z(t.key),className:"absolute top-2 right-2 p-1.5 rounded-lg opacity-0 group-hover:opacity-100 transition-opacity",style:{backgroundColor:"var(--theme-bg-hover)"},title:"Hide this card",children:e.jsx(Ee,{className:"w-3.5 h-3.5 text-themed-muted"})})]},t.key))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(Pe,{serviceStats:h||[],timeRange:d}),e.jsx(ae,{downloads:p||[],timeRange:d})]}),e.jsx(se,{clientStats:b||[],downloads:p||[],timeRange:d})]})};export{Je as default};
//# sourceMappingURL=Dashboard-B7wxeKTI.js.map
