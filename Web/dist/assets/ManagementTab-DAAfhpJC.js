import{r as h,j as e,R as At,X as Pe,C as le,K as Ge,x as st,y as ce,H as Pt,z as rt,B as ne,b as re,F as ot,J as ct,N as nt,O as $t,P as Ue,Q as Mt,V as We,Y as qe,_ as Ye,D as oe,o as It,E as lt,v as Se,$ as Ht,a0 as _t,I as Ke,p as Be,a1 as pe,a2 as Lt,U as Rt,h as Ft,S as Dt,a3 as Ot,n as Ve,m as Je,e as Qe,a4 as Ze,a5 as ge,k as Xe,a6 as et,a7 as Et,a8 as zt,a9 as Gt,A as $e,q as Ut,aa as Wt,ab as qt,i as be,T as Yt,l as Kt,ac as Vt,ad as Jt}from"./react-vendor-SuPjavJP.js";import{a as Q,A as O,t as q,b as tt,u as Qt}from"./index-CiZutpDs.js";import{f as fe,C as Z}from"./Card-BjP9eu4R.js";import{A as U}from"./Alert-BssmeJ8f.js";import{H as Zt}from"./signalr-C7Jyn4vH.js";import"./vendor-BmYUbuLR.js";import"./tanstack-CPlEqbpz.js";async function Xt(c){try{const y=await fetch(c,{signal:AbortSignal.timeout(5e3)});return y.ok?{ok:!0,data:await y.json()}:{ok:!1,error:`HTTP ${y.status}`}}catch(y){return{ok:!1,error:y.message}}}const Ae={},ea=()=>{if(!(typeof import.meta<"u"&&(Ae!=null&&Ae.VITE_API_URL)))return""},ee=ea();class ta{async getState(y){const s=await Xt(`${ee}/api/operationstate/${y}`);return s.ok?s.data:null}async saveState(y,s,d,p=30){try{const r=await fetch(`${ee}/api/operationstate`,{method:"POST",headers:{"Content-Type":"application/json",...Q.getAuthHeaders()},body:JSON.stringify({key:y,type:s,data:d,expirationMinutes:p})});if(!r.ok){const l=await r.text();throw new Error(`Failed to save state: ${l}`)}return await r.json()}catch(r){throw console.error("Error saving state:",r),r}}async updateState(y,s){try{const d=`${ee}/api/operationstate/${encodeURIComponent(y)}`,p=await fetch(d,{method:"PATCH",headers:{"Content-Type":"application/json",...Q.getAuthHeaders()},body:JSON.stringify({updates:s||{}})});if(!p.ok){const r=await p.text();throw console.error("Update state response:",p.status,r),new Error(`Failed to update state: ${p.status} - ${r}`)}return await p.json()}catch(d){return console.error("Error updating state:",d),null}}async removeState(y){try{const s=await fetch(`${ee}/api/operationstate/${encodeURIComponent(y)}`,{method:"DELETE",headers:Q.getAuthHeaders()});if(!s.ok)throw new Error("Failed to remove state");return await s.json()}catch(s){throw console.error("Error removing state:",s),s}}async getAllStates(y=null){try{const s=y?`${ee}/api/operationstate?type=${y}`:`${ee}/api/operationstate`,d=await fetch(s,{headers:Q.getAuthHeaders()});if(!d.ok)throw new Error("Failed to get states");return await d.json()}catch(s){return console.error("Error getting all states:",s),[]}}async migrateFromLocalStorage(){const y=["activeCacheClearOperation","activeLogProcessing","activeServiceRemoval"];let s=0;for(const d of y)try{const p=localStorage.getItem(d);if(p){const r=JSON.parse(p);let l="general";d.includes("CacheClear")?l="cacheClearing":d.includes("LogProcessing")?l="logProcessing":d.includes("ServiceRemoval")&&(l="serviceRemoval"),await this.saveState(d,l,r,120),localStorage.removeItem(d),s++}}catch(p){console.error(`Failed to migrate ${d}:`,p)}return s}}const se=new ta,Me=(c,y="general",s=30)=>{const[d,p]=h.useState(null),[r,l]=h.useState(!1),[j,g]=h.useState(null),P=h.useCallback(async x=>{l(!0),g(null);try{await se.saveState(c,y,x,s);const m={key:c,type:y,data:x,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};return p(m),m}catch(m){throw console.error(`Failed to save ${c}:`,m),g(m.message),m}finally{l(!1)}},[c,y,s]),b=h.useCallback(async()=>{l(!0),g(null);try{const x=await se.getState(c);if(x){const m=x,B={key:m.key||c,type:m.type||y,data:m.data||{},createdAt:m.createdAt||new Date().toISOString(),updatedAt:m.updatedAt||m.createdAt||new Date().toISOString()};return p(B),B}return null}catch(x){return console.error(`Failed to load ${c}:`,x),g(x.message),null}finally{l(!1)}},[c,y]),T=h.useCallback(async()=>{l(!0),g(null);try{await se.removeState(c),p(null)}catch(x){throw console.error(`Failed to clear ${c}:`,x),g(x.message),x}finally{l(!1)}},[c]),A=h.useCallback(async x=>{l(!0),g(null);try{await se.updateState(c,x),p(m=>m?{...m,data:{...m.data,...x},updatedAt:new Date().toISOString()}:null)}catch(m){throw console.error(`Failed to update ${c}:`,m),g(m.message),m}finally{l(!1)}},[c]);return h.useEffect(()=>{c&&b()},[c]),{operation:d,save:P,load:b,clear:T,update:A,loading:r,error:j}},F=({children:c,variant:y="default",color:s="blue",size:d="md",loading:p=!1,leftSection:r,rightSection:l,fullWidth:j=!1,className:g="",disabled:P,...b})=>{const T=()=>y==="filled"?{blue:"themed-button-primary",green:"action-process",red:"action-delete",yellow:"action-reset",purple:"themed-button-primary",gray:"bg-themed-hover hover:bg-themed-tertiary text-themed-primary",orange:"action-reset"}[s]:y==="subtle"?"bg-transparent hover:bg-themed-hover text-themed-secondary":y==="outline"?"border border-themed-secondary hover:bg-themed-hover text-themed-primary":"bg-themed-tertiary hover:bg-themed-hover text-themed-primary",A={xs:"px-2 py-1 text-xs",sm:"px-3 py-1.5 text-sm",md:"px-4 py-2",lg:"px-6 py-3 text-lg"};return e.jsxs("button",{className:`
        ${T()}
        ${A[d]}
        ${j?"w-full":""}
        rounded-lg font-medium
        smooth-transition
        disabled:opacity-50 disabled:cursor-not-allowed
        flex items-center justify-center gap-2
        button-press
        ${g}
      `,disabled:P||p,...b,children:[p&&e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-current"}),r,c,l]})},xe=({opened:c,onClose:y,title:s,children:d,size:p="md"})=>{const r={sm:"max-w-md",md:"max-w-lg",lg:"max-w-2xl",xl:"max-w-4xl"};return At.useEffect(()=>(c?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[c]),c?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:`themed-card rounded-lg ${r[p]} w-full mx-4 max-h-[90vh] overflow-y-auto custom-scrollbar`,children:[s&&e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-themed-secondary",children:[e.jsx("div",{className:"text-lg font-semibold text-themed-primary",children:s}),e.jsx("button",{onClick:y,className:"p-1 hover:bg-themed-hover rounded-lg smooth-transition",children:e.jsx(Pe,{className:"w-5 h-5 text-themed-muted"})})]}),e.jsx("div",{className:"p-6",children:d})]})}):null},aa=({onAuthChange:c,onError:y,onSuccess:s})=>{const[d,p]=h.useState(!1),[r,l]=h.useState(!0),[j,g]=h.useState(!1),[P,b]=h.useState(""),[T,A]=h.useState(""),[x,m]=h.useState(!1);h.useEffect(()=>{B()},[]);const B=async()=>{l(!0);try{const I=await Q.checkAuth();p(I.isAuthenticated),c==null||c(I.isAuthenticated),!I.isAuthenticated&&Q.isRegistered()&&Q.clearAuth()}catch(I){console.error("Auth check failed:",I),p(!1),c==null||c(!1)}finally{l(!1)}},M=async()=>{if(!P.trim()){A("Please enter an API key");return}m(!0),A("");try{const I=await Q.register(P);I.success?(p(!0),c==null||c(!0),g(!1),b(""),s==null||s("Authentication successful! You can now use management features.")):A(I.message||"Authentication failed")}catch(I){console.error("Authentication error:",I),A(I.message||"Authentication failed")}finally{m(!1)}},K=async()=>{if(window.confirm(`WARNING: This will:

1. Generate a NEW API key on the server
2. Revoke ALL existing device registrations
3. Require ALL users to re-authenticate
4. You must check the container logs for the new key

This cannot be undone. Continue?`)){m(!0);try{const v=await Q.regenerateApiKey();v.success?(p(!1),c==null||c(!1),g(!1),y==null||y("API KEY REGENERATED - Check container logs for new key!"),s==null||s(v.message),setTimeout(()=>{g(!0)},3e3)):y==null||y(v.message||"Failed to regenerate API key")}catch(v){console.error("Error regenerating key:",v),y==null||y("Failed to regenerate API key: "+v.message)}finally{m(!1)}}};return r?null:e.jsxs(e.Fragment,{children:[e.jsx(U,{color:d?"green":"yellow",icon:d?e.jsx(st,{className:"w-5 h-5"}):e.jsx(ce,{className:"w-5 h-5"}),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:d?"Authenticated":"Not Authenticated"}),e.jsx("p",{className:"text-xs mt-1 opacity-75",children:d?"Management features enabled":"Management features require API key"})]}),d?e.jsx(F,{variant:"filled",color:"red",size:"sm",leftSection:e.jsx(le,{className:"w-3 h-3"}),onClick:K,loading:x,children:"Regenerate Key"}):e.jsx(F,{variant:"filled",color:"yellow",leftSection:e.jsx(Ge,{className:"w-4 h-4"}),onClick:()=>g(!0),children:"Authenticate"})]})}),e.jsx(xe,{opened:j,onClose:()=>{g(!1),b(""),A("")},title:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Ge,{className:"w-6 h-6 text-themed-warning"}),e.jsx("span",{children:"Authentication Required"})]}),children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-themed-secondary",children:"Management operations require authentication. Please enter your API key to continue."}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-themed-secondary mb-2",children:"API Key"}),e.jsx("input",{type:"password",value:P,onChange:I=>b(I.target.value),onKeyPress:I=>I.key==="Enter"&&M(),placeholder:"lm_xxxxxxxxxxxxxxxxxxxxx",className:"w-full px-3 py-2 themed-input text-themed-primary placeholder-themed-muted focus:outline-none",disabled:x})]}),T&&e.jsx(U,{color:"red",children:T}),e.jsx(U,{color:"blue",children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium mb-2",children:"To find your API key:"}),e.jsxs("ol",{className:"list-decimal list-inside text-xs space-y-1",children:[e.jsx("li",{children:"SSH into your server"}),e.jsxs("li",{children:["Check the file:"," ",e.jsx("code",{className:"bg-themed-tertiary px-1 rounded",children:"/data/api_key.txt"})]}),e.jsx("li",{children:"Or check the API container logs on startup"})]})]})}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-themed-secondary",children:[e.jsx(F,{variant:"default",onClick:()=>{g(!1),b(""),A("")},disabled:x,children:"Cancel"}),e.jsx(F,{variant:"filled",color:"blue",leftSection:e.jsx(ce,{className:"w-4 h-4"}),onClick:M,loading:x,disabled:!P.trim(),children:"Authenticate"})]})]})})]})},sa=({isAuthenticated:c,mockMode:y,onError:s,onSuccess:d,onBackgroundOperation:p})=>{var G;const[r,l]=h.useState(null),[j,g]=h.useState(!1),[P,b]=h.useState(!1),[T,A]=h.useState({cachePath:"/cache",logPath:"/logs/access.log",services:[]}),x=Me("activeCacheClearOperation","cacheClearing",30);h.useEffect(()=>{var i;((i=x.operation)==null?void 0:i.data)&&!j&&r&&["Running","Preparing"].includes(r.status)&&p?p({bytesDeleted:r.bytesDeleted,progress:r.percentComplete||r.progress||0,showModal:()=>g(!0)}):p&&p(null)},[x.operation,j,r,p]),h.useEffect(()=>{m(),B()},[]);const m=async()=>{try{const N=await O.getConfig();A(N)}catch(N){console.error("Failed to load config:",N)}},B=async()=>{var i;const N=await x.load();if((i=N==null?void 0:N.data)!=null&&i.operationId)try{const n=await O.getCacheClearStatus(N.data.operationId);n&&["Running","Preparing"].includes(n.status)?(l(n),M(N.data.operationId)):await x.clear()}catch{await x.clear()}},M=N=>{const i=setInterval(async()=>{try{const n=await O.getCacheClearStatus(N);l(n),["Running","Preparing"].includes(n.status)?await x.update({lastProgress:n.percentComplete||n.progress||0}):(K(n),clearInterval(i))}catch(n){console.error("Error polling cache clear status:",n),clearInterval(i)}},1e3)},K=async N=>{await x.clear(),N.status==="Completed"?(d==null||d(`Cache cleared successfully! ${fe(N.bytesDeleted||0)} freed.`),setTimeout(()=>{g(!1),l(null)},2e3)):N.status==="Failed"?(s==null||s(`Cache clearing failed: ${N.error||N.message||"Unknown error"}`),setTimeout(()=>{g(!1),l(null)},5e3)):N.status==="Cancelled"&&(d==null||d("Cache clearing cancelled"),g(!1),l(null))},I=async()=>{if(!c){s==null||s("Authentication required");return}if(window.confirm("This will clear ALL cached game files. Continue?")){b(!0);try{const N=await O.clearAllCache();N.operationId&&(await x.save({operationId:N.operationId}),l({operationId:N.operationId,status:"Preparing",statusMessage:"Starting cache clear...",percentComplete:0,bytesDeleted:0,totalBytesToDelete:0}),g(!0),M(N.operationId))}catch(N){s==null||s("Failed to start cache clearing: "+N.message)}finally{b(!1)}}},v=async()=>{var i;const N=x.operation;if((i=N==null?void 0:N.data)!=null&&i.operationId)try{l(n=>n?{...n,status:"Cancelling",statusMessage:"Cancelling operation..."}:null),await O.cancelCacheClear(N.data.operationId),await x.clear(),setTimeout(()=>{g(!1),l(null),d==null||d("Cache clearing operation cancelled")},1500)}catch(n){console.error("Failed to cancel cache clear:",n),g(!1),l(null),await x.clear()}},L=((G=x.operation)==null?void 0:G.data)&&!j&&r&&["Running","Preparing"].includes(r.status),z=(r==null?void 0:r.percentComplete)||(r==null?void 0:r.progress)||0;return e.jsxs(e.Fragment,{children:[e.jsxs(Z,{children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(Pt,{className:"w-5 h-5 text-themed-primary"}),e.jsx("h3",{className:"text-lg font-semibold text-themed-primary",children:"Disk Cache Management"})]}),e.jsxs("p",{className:"text-themed-muted text-sm mb-4",children:["Manage cached game files in"," ",e.jsx("code",{className:"bg-themed-tertiary px-2 py-1 rounded",children:T.cachePath})]}),e.jsx(F,{fullWidth:!0,variant:"filled",color:"red",leftSection:e.jsx(rt,{className:"w-4 h-4"}),onClick:I,disabled:P||y||L||x.loading||!c,loading:P||x.loading,children:L?"Cache Clearing in Progress...":"Clear All Cached Files"}),e.jsx("p",{className:"text-xs text-themed-muted mt-2",children:"⚠️ This deletes ALL cached game files from disk"})]}),e.jsx(xe,{opened:j&&r!==null,onClose:()=>{["Running","Preparing"].includes((r==null?void 0:r.status)||"")||(g(!1),l(null))},title:"Clearing Cache",size:"lg",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[(r==null?void 0:r.status)==="Completed"?e.jsx(ne,{className:"w-5 h-5 cache-hit"}):(r==null?void 0:r.status)==="Failed"?e.jsx(le,{className:"w-5 h-5 text-themed-error"}):e.jsx(re,{className:"w-5 h-5 text-themed-primary animate-spin"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-themed-primary font-medium",children:r==null?void 0:r.status}),((r==null?void 0:r.statusMessage)||(r==null?void 0:r.message))&&e.jsx("p",{className:"text-sm text-themed-muted",children:(r==null?void 0:r.statusMessage)||(r==null?void 0:r.message)})]})]}),r&&["Running","Preparing"].includes(r.status)&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"w-full progress-track rounded-full h-4 relative overflow-hidden",children:[e.jsx("div",{className:"progress-bar-medium h-4 rounded-full smooth-transition",style:{width:`${Math.min(100,z)}%`}}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("span",{className:"text-xs text-themed-primary font-medium",children:[z.toFixed(0),"%"]})})]}),r.bytesDeleted!==void 0&&r.totalBytesToDelete&&r.totalBytesToDelete>0&&e.jsxs("div",{className:"text-sm text-themed-muted text-center",children:[e.jsx("span",{className:"cache-hit font-semibold",children:fe(r.bytesDeleted||0)})," / ",e.jsx("span",{className:"text-themed-primary",children:fe(r.totalBytesToDelete)})," cleared"]})]}),(r==null?void 0:r.error)&&e.jsx(U,{color:"red",children:r.error}),e.jsx("div",{className:"flex justify-end space-x-3 pt-4 border-t border-themed-secondary",children:r&&["Running","Preparing"].includes(r.status)?e.jsxs(e.Fragment,{children:[e.jsx(F,{variant:"filled",color:"red",leftSection:e.jsx(ot,{className:"w-4 h-4"}),onClick:v,children:"Cancel"}),e.jsx(F,{variant:"default",onClick:()=>g(!1),children:"Run in Background"})]}):e.jsx(F,{variant:"default",onClick:()=>{g(!1),l(null)},children:"Close"})})]})}),x.error&&e.jsxs(U,{color:"orange",children:["Backend storage error: ",x.error]})]})},ra=({isAuthenticated:c,mockMode:y,onError:s,onSuccess:d,onDataRefresh:p,onBackgroundOperation:r})=>{const[l,j]=h.useState(!1),[g,P]=h.useState(null),[b,T]=h.useState(!1),[A,x]=h.useState(!1),m=Me("activeLogProcessing","logProcessing",120),B=h.useRef(null),M=h.useRef(null),K=h.useRef(null);h.useEffect(()=>{l&&g&&r?r({message:g.message,detailMessage:g.detailMessage,progress:g.progress,estimatedTime:g.estimatedTime,status:g.status,onCancel:N}):r&&r(null)},[l,g,r]),h.useEffect(()=>(I(),v(),()=>{M.current&&clearInterval(M.current),K.current&&clearTimeout(K.current),B.current&&B.current.stop()}),[]);const I=async()=>{var n,C;const i=await m.load();if(i!=null&&i.data){const f=await O.getProcessingStatus().catch(()=>null);f!=null&&f.isProcessing?(j(!0),P({message:`Processing: ${((n=f.mbProcessed)==null?void 0:n.toFixed(1))||0} MB of ${((C=f.mbTotal)==null?void 0:C.toFixed(1))||0} MB`,detailMessage:f.processingRate?`Speed: ${f.processingRate.toFixed(1)} MB/s`:"",progress:f.percentComplete||f.progress||0,estimatedTime:f.estimatedTime,status:f.status||"processing"}),L()):await m.clear()}},v=async()=>{try{const i=new Zt().withUrl("/hubs/downloads").withAutomaticReconnect([0,2e3,5e3,1e4,3e4]).build();i.on("ProcessingProgress",async n=>{P(C=>{var f,D;return(C==null?void 0:C.status)==="complete"?C:{message:`Processing: ${((f=n.mbProcessed)==null?void 0:f.toFixed(1))||0} MB of ${((D=n.mbTotal)==null?void 0:D.toFixed(1))||0} MB`,detailMessage:`${n.entriesProcessed||0} entries from ${n.linesProcessed||0} lines`,progress:n.percentComplete||n.progress||0,status:"processing"}}),j(!0),await m.update({lastProgress:n.percentComplete||n.progress||0,mbProcessed:n.mbProcessed,mbTotal:n.mbTotal,entriesProcessed:n.entriesProcessed,linesProcessed:n.linesProcessed})}),i.on("BulkProcessingComplete",async n=>{var C,f,D;M.current&&clearInterval(M.current),P({message:"Processing Complete!",detailMessage:`Successfully processed ${(C=n.entriesProcessed)==null?void 0:C.toLocaleString()} entries from ${(f=n.linesProcessed)==null?void 0:f.toLocaleString()} lines in ${(D=n.elapsed)==null?void 0:D.toFixed(1)} minutes`,progress:100,status:"complete"}),j(!0),await m.clear(),setTimeout(async()=>{j(!1),P(null),p==null||p()},1e4)}),i.onreconnecting(()=>{x(!1)}),i.onreconnected(()=>{x(!0)}),i.onclose(n=>{console.error("SignalR disconnected:",n),x(!1),l&&L(),K.current=setTimeout(()=>{v()},5e3)}),await i.start(),B.current=i,x(!0)}catch(i){console.error("SignalR connection failed, falling back to polling:",i),x(!1),l&&L()}},L=()=>{M.current&&clearInterval(M.current);const i=async()=>{var n,C,f;try{const D=g;if((D==null?void 0:D.status)==="complete")return;const S=await O.getProcessingStatus();S!=null&&S.isProcessing?(j(!0),P({message:`Processing: ${((n=S.mbProcessed)==null?void 0:n.toFixed(1))||0} MB of ${((C=S.mbTotal)==null?void 0:C.toFixed(1))||0} MB`,detailMessage:S.processingRate?`Speed: ${S.processingRate.toFixed(1)} MB/s`:"",progress:S.percentComplete||S.progress||0,estimatedTime:S.estimatedTime,status:S.status||"processing"}),await m.update({lastProgress:S.percentComplete||S.progress||0,mbProcessed:S.mbProcessed,mbTotal:S.mbTotal})):((S==null?void 0:S.percentComplete)||(S==null?void 0:S.progress)||0)>=100?(M.current&&clearInterval(M.current),P({message:"Processing Complete!",detailMessage:`Processed ${((f=S.mbTotal)==null?void 0:f.toFixed(1))||0} MB`,progress:100,status:"complete"}),j(!0),await m.clear(),setTimeout(()=>{j(!1),P(null),p==null||p()},1e4)):(j(!1),await m.clear(),M.current&&clearInterval(M.current))}catch(D){console.error("Error checking processing status:",D)}};i(),M.current=setInterval(i,3e3)},z=async()=>{if(!c){s==null||s("Authentication required");return}T(!0);try{const i=await O.resetLogPosition();i&&(d==null||d(i.message||"Log position reset successfully"),setTimeout(()=>p==null?void 0:p(),2e3))}catch(i){s==null||s(i.message||"Failed to reset log position")}finally{T(!1)}},G=async()=>{var i;if(!c){s==null||s("Authentication required");return}if(window.confirm("Process entire log file?")){T(!0);try{const n=await O.processAllLogs();if(n){if(n.status==="empty_file"||n.status==="no_log_file"||n.status==="insufficient_data"){s==null||s(n.message),T(!1);return}n.logSizeMB>0?(await m.save({type:"processAll"}),j(!0),P({message:"Preparing to process logs...",detailMessage:`${((i=n.logSizeMB)==null?void 0:i.toFixed(1))||0} MB to process`,progress:0,estimatedTime:`Estimated: ${n.estimatedTimeMinutes} minutes`,status:"starting"}),A||setTimeout(()=>L(),5e3)):(s==null||s("Log file appears to be empty or invalid"),await m.clear())}else await m.clear()}catch(n){await m.clear(),s==null||s(n.message||"Failed to process logs")}finally{T(!1)}}},N=async()=>{if(!c){s==null||s("Authentication required");return}if(window.confirm("Cancel log processing?")){T(!0);try{await O.cancelProcessing(),j(!1),await m.clear(),M.current&&clearInterval(M.current),d==null||d("Processing cancelled"),setTimeout(()=>{P(null),p==null||p()},5e3)}catch{s==null||s("Failed to cancel processing")}finally{T(!1)}}};return e.jsxs(Z,{children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(ct,{className:"w-5 h-5 cache-hit"}),e.jsx("h3",{className:"text-lg font-semibold text-themed-primary",children:"Log Processing"})]}),e.jsx("p",{className:"text-themed-muted text-sm mb-4",children:"Control how access.log is processed for statistics"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(F,{variant:"filled",color:"yellow",leftSection:e.jsx(nt,{className:"w-4 h-4"}),onClick:z,disabled:b||l||y||m.loading||!c,fullWidth:!0,children:"Reset Log Position"}),e.jsx(F,{variant:"filled",color:"green",leftSection:e.jsx($t,{className:"w-4 h-4"}),onClick:G,disabled:b||l||y||m.loading||!c,loading:m.loading,fullWidth:!0,children:"Process All Logs"})]}),e.jsx("div",{className:"mt-4 p-3 bg-themed-tertiary rounded-lg",children:e.jsxs("p",{className:"text-xs text-themed-muted",children:[e.jsx("strong",{children:"Reset:"})," Start from current end of log",e.jsx("br",{}),e.jsx("strong",{children:"Process All:"})," Import entire log history"]})}),m.error&&e.jsxs(U,{color:"orange",children:["Backend storage error: ",m.error]})]})},oa=({isAuthenticated:c})=>{const[y,s]=h.useState([]),[d,p]=h.useState("dark-default"),[r,l]=h.useState(!1),[j,g]=h.useState(!1),[P,b]=h.useState(null),[T,A]=h.useState(null),[x,m]=h.useState(null),[B,M]=h.useState(!1),[K,I]=h.useState(!1),[v,L]=h.useState(null),[z,G]=h.useState(["core","backgrounds","text"]),[N,i]=h.useState(null),[n,C]=h.useState({}),[f,D]=h.useState(""),[S,R]=h.useState(""),[Y,W]=h.useState("category"),[ye,it]=h.useState("all"),[ie,Ie]=h.useState("category"),[ve,dt]=h.useState("all"),[_,V]=h.useState({}),[H,J]=h.useState({name:"",description:"",author:"",version:"1.0.0",isDark:!0,customCSS:""}),He=h.useRef(null),mt=(t,a=1)=>{const u=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);if(!u)return t;const o=parseInt(u[1],16),k=parseInt(u[2],16),w=parseInt(u[3],16);return`rgba(${o}, ${k}, ${w}, ${a})`},de=t=>{const a=t.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*([\d.]+))?\)/);if(a){const u=parseInt(a[1]),o=parseInt(a[2]),k=parseInt(a[3]),w=a[4]?parseFloat(a[4]):1;return{hex:"#"+[u,o,k].map(E=>E.toString(16).padStart(2,"0")).join(""),alpha:w}}return{hex:t,alpha:1}},me=(t,a,u,o=!1)=>{const k=u<1?mt(a,u):a;o?J(w=>({...w,[t]:k})):V(w=>({...w,[t]:k}))},ht=(t,a)=>{if(!a.trim())return t;const u=a.toLowerCase();return t.map(o=>{const k=o.colors.filter(w=>w.label.toLowerCase().includes(u)||w.description.toLowerCase().includes(u)||w.affects.some($=>$.toLowerCase().includes(u))||w.key.toLowerCase().includes(u));return o.name.toLowerCase().includes(u)||o.description.toLowerCase().includes(u)?o:{...o,colors:k}}).filter(o=>o.colors.length>0)},ut=(t,a)=>a==="all"?t:t.map(u=>{const o=u.colors.filter(k=>{var w;return(w=k.pages)==null?void 0:w.includes(a)});return{...u,colors:o}}).filter(u=>u.colors.length>0),_e=(t,a,u=!1)=>{let o=t;return(u?ie:Y)==="page"&&(o=ut(o,u?ve:ye)),a.trim()&&(o=ht(o,a)),o},Le=[{name:"all",label:"All Pages",icon:Be,description:"Colors used across all pages"},{name:"dashboard",label:"Dashboard",icon:Lt,description:"Main dashboard and overview page"},{name:"downloads",label:"Downloads",icon:oe,description:"Downloads and active transfers"},{name:"clients",label:"Clients",icon:Rt,description:"Client connections and statistics"},{name:"services",label:"Services",icon:Ft,description:"Service status and statistics"},{name:"management",label:"Management",icon:Dt,description:"Cache and theme management"},{name:"charts",label:"Charts & Graphs",icon:Ot,description:"Data visualizations and charts"}],Re=[{name:"foundation",icon:Ue,description:"Core brand colors that define your theme's identity",colors:[{key:"primaryColor",label:"Primary Brand Color",description:"Main brand color used throughout",affects:["Primary buttons","Links","Active states","Focus rings"],supportsAlpha:!0,pages:["dashboard","downloads","clients","services","management"]},{key:"secondaryColor",label:"Secondary Brand Color",description:"Complementary brand accent",affects:["Secondary buttons","Highlights","Accents"],supportsAlpha:!0,pages:["dashboard","downloads","management"]},{key:"accentColor",label:"Accent Color",description:"Tertiary accent for special elements",affects:["Special badges","Tooltips","Info elements"],supportsAlpha:!0,pages:["dashboard","downloads","clients","services","management"]}]},{name:"content",icon:Et,description:"Text colors for content hierarchy and readability",colors:[{key:"textPrimary",label:"Primary Text",description:"Main content text color",affects:["Headings","Body text","Labels"],supportsAlpha:!0,pages:["dashboard","downloads","clients","services","management"]},{key:"textSecondary",label:"Secondary Text",description:"Supporting content text",affects:["Descriptions","Subtitles","Help text"],supportsAlpha:!0,pages:["dashboard","downloads","clients","services","management"]},{key:"textMuted",label:"Muted Text",description:"De-emphasized text",affects:["Disabled text","Timestamps","Minor labels"],supportsAlpha:!0,pages:["dashboard","downloads","clients","services","management"]},{key:"textAccent",label:"Accent Text",description:"Highlighted or linked text",affects:["Links","Highlighted values","Active menu items"],supportsAlpha:!0,pages:["dashboard","downloads","clients","services","management"]},{key:"textPlaceholder",label:"Placeholder Text",description:"Input placeholder text color",affects:["Form placeholders","Search hints","Empty states"],supportsAlpha:!0,pages:["downloads","management"]}]},{name:"layout",icon:pe,description:"Background colors for UI surfaces and layers",colors:[{key:"bgPrimary",label:"Base Background",description:"Main application background",affects:["Body","Main container","Base layer"],supportsAlpha:!0,pages:["dashboard","downloads","clients","services","management"]},{key:"bgSecondary",label:"Surface Background",description:"Elevated surface backgrounds",affects:["Cards","Panels","Modals","Dialogs"],supportsAlpha:!0,pages:["dashboard","downloads","clients","services","management"]},{key:"bgTertiary",label:"Recessed Background",description:"Sunken or nested elements",affects:["Input fields","Wells","Code blocks"],supportsAlpha:!0,pages:["downloads","management"]},{key:"bgHover",label:"Hover State",description:"Interactive hover backgrounds",affects:["Button hovers","List hovers","Menu hovers"],supportsAlpha:!0,pages:["dashboard","downloads","clients","services","management"]},{key:"cardBg",label:"Card Background",description:"Card component background",affects:["Stat cards","Content cards","Widget backgrounds"],supportsAlpha:!0,pages:["dashboard","downloads","clients","services"]},{key:"cardBorder",label:"Card Border",description:"Card component borders",affects:["Card outlines","Panel borders"],supportsAlpha:!0,pages:["dashboard","downloads","clients","services"]}]},{name:"interactive",icon:zt,description:"Interactive elements like buttons, inputs, and forms",colors:[{key:"buttonBg",label:"Button Background",description:"Primary button fill color",affects:["Primary buttons","Submit buttons","CTAs"],supportsAlpha:!0,pages:["management","downloads"]},{key:"buttonHover",label:"Button Hover",description:"Button hover state color",affects:["Button hover effects","Active button states"],supportsAlpha:!0},{key:"buttonText",label:"Button Text",description:"Button label color",affects:["Button labels","Button icons"],supportsAlpha:!0},{key:"inputBg",label:"Input Background",description:"Form input background",affects:["Text inputs","Textareas","Select boxes"],supportsAlpha:!0,pages:["management","downloads"]},{key:"inputBorder",label:"Input Border",description:"Form input border",affects:["Input outlines","Field borders"],supportsAlpha:!0},{key:"inputFocus",label:"Input Focus",description:"Focused input indicator",affects:["Active input borders","Focus rings"],supportsAlpha:!0},{key:"checkboxAccent",label:"Checkbox Accent",description:"Checkbox checked state color",affects:["Checkbox checkmarks","Checkbox backgrounds"],supportsAlpha:!1,pages:["downloads","management"]},{key:"checkboxBorder",label:"Checkbox Border",description:"Checkbox border color when unchecked",affects:["Checkbox borders","Unchecked state"],supportsAlpha:!0},{key:"sliderAccent",label:"Slider Accent",description:"Range slider accent color",affects:["Slider thumbs","Slider filled tracks"],supportsAlpha:!1,pages:["management"]},{key:"sliderThumb",label:"Slider Thumb",description:"Range slider thumb/handle",affects:["Slider drag handles"],supportsAlpha:!0},{key:"sliderTrack",label:"Slider Track",description:"Range slider track background",affects:["Slider backgrounds","Progress tracks"],supportsAlpha:!0},{key:"dragHandleColor",label:"Drag Handle",description:"Drag and reorder controls",affects:["Drag grips","Reorder handles","Move indicators"],supportsAlpha:!0},{key:"dragHandleHover",label:"Drag Handle Hover",description:"Active drag handle state",affects:["Drag grip hover","Active dragging"],supportsAlpha:!0}]},{name:"borders",icon:Gt,description:"Border colors for separators and outlines",colors:[{key:"borderPrimary",label:"Primary Border",description:"Main divider and border color",affects:["Card borders","Dividers","Separators"],supportsAlpha:!0},{key:"borderSecondary",label:"Secondary Border",description:"Subtle borders and dividers",affects:["Input borders","Section dividers","Subtle lines"],supportsAlpha:!0},{key:"borderFocus",label:"Focus Border",description:"Active focus indicators",affects:["Focus rings","Active borders","Selected outlines"],supportsAlpha:!0}]},{name:"feedback",icon:le,description:"Status indicators, alerts, notifications, banners, and feedback colors",colors:[{key:"success",label:"Success Primary",description:"Success state primary color (border for alerts)",affects:["Success icons","Success buttons","Positive actions","Alert borders","Success notifications"],supportsAlpha:!0},{key:"successBg",label:"Success Background",description:"Success state background (alert background)",affects:["Success alerts","Success badges","Success cards","Alert backgrounds","Success banners"],supportsAlpha:!0},{key:"successText",label:"Success Text",description:"Success state text color (alert text)",affects:["Success messages","Positive values","Alert text","Success notifications"],supportsAlpha:!0},{key:"warning",label:"Warning Primary",description:"Warning state primary color (border for alerts)",affects:["Warning icons","Caution buttons","Alert borders","Warning notifications"],supportsAlpha:!0},{key:"warningBg",label:"Warning Background",description:"Warning state background (alert background)",affects:["Warning alerts","Warning badges","Alert backgrounds","Caution banners"],supportsAlpha:!0},{key:"warningText",label:"Warning Text",description:"Warning state text color (alert text)",affects:["Warning messages","Caution text","Alert text","Warning notifications"],supportsAlpha:!0},{key:"error",label:"Error Primary",description:"Error state primary color (border for alerts)",affects:["Error icons","Delete buttons","Critical actions","Alert borders","Error notifications"],supportsAlpha:!0},{key:"errorBg",label:"Error Background",description:"Error state background (alert background)",affects:["Error alerts","Error badges","Alert backgrounds","Error banners","Danger zones"],supportsAlpha:!0},{key:"errorText",label:"Error Text",description:"Error state text color (alert text)",affects:["Error messages","Validation errors","Alert text","Error notifications"],supportsAlpha:!0},{key:"info",label:"Info Primary",description:"Information state primary color (border for alerts)",affects:["Info icons","Info buttons","Alert borders","Info notifications"],supportsAlpha:!0},{key:"infoBg",label:"Info Background",description:"Information state background (alert background)",affects:["Info alerts","Info cards","Alert backgrounds","Notification panels","Info banners"],supportsAlpha:!0},{key:"infoText",label:"Info Text",description:"Information state text color (alert text)",affects:["Info messages","Help content","Alert text","Notification text"],supportsAlpha:!0}]},{name:"navigation",icon:pe,description:"Navigation bar and menu styling",colors:[{key:"navBg",label:"Navigation Background",description:"Navigation bar background (header background)",affects:["Header","Nav bar","Menu background","Top bar","App header"],supportsAlpha:!0},{key:"navBorder",label:"Navigation Border",description:"Navigation separators (header border)",affects:["Nav borders","Menu dividers","Header separator","Top bar border"],supportsAlpha:!0},{key:"navTabActive",label:"Active Tab",description:"Active navigation item",affects:["Current page","Active tab"],supportsAlpha:!0},{key:"navTabInactive",label:"Inactive Tab",description:"Inactive navigation items",affects:["Unselected tabs","Inactive menu items"],supportsAlpha:!0},{key:"navTabHover",label:"Tab Hover",description:"Navigation hover state",affects:["Tab hovers","Menu hovers"],supportsAlpha:!0},{key:"navTabActiveBorder",label:"Active Tab Indicator",description:"Active tab underline/border",affects:["Tab indicators","Active borders"],supportsAlpha:!0},{key:"navMobileMenuBg",label:"Mobile Menu Background",description:"Mobile navigation background",affects:["Mobile menu","Dropdown menus"],supportsAlpha:!0},{key:"navMobileItemHover",label:"Mobile Menu Hover",description:"Mobile menu item hover",affects:["Mobile hovers","Dropdown hovers"],supportsAlpha:!0}]},{name:"dataDisplay",icon:$e,description:"Data visualization and display elements",colors:[{key:"badgeBg",label:"Badge Background",description:"Badge and pill backgrounds",affects:["Status badges","Tags","Labels"],supportsAlpha:!0},{key:"badgeText",label:"Badge Text",description:"Badge text color",affects:["Badge labels","Tag text"],supportsAlpha:!0},{key:"progressBar",label:"Progress Bar Fill",description:"Progress indicator color",affects:["Progress bars","Loading bars","Completion indicators"],supportsAlpha:!0},{key:"progressBg",label:"Progress Track",description:"Progress bar background",affects:["Progress tracks","Empty progress state"],supportsAlpha:!0},{key:"chartColor1",label:"Chart Primary",description:"Primary chart color",affects:["First data series","Main chart color"],supportsAlpha:!0},{key:"chartColor2",label:"Chart Secondary",description:"Secondary chart color",affects:["Second data series"],supportsAlpha:!0},{key:"chartColor3",label:"Chart Tertiary",description:"Third chart color",affects:["Third data series"],supportsAlpha:!0},{key:"chartColor4",label:"Chart Quaternary",description:"Fourth chart color",affects:["Fourth data series"],supportsAlpha:!0},{key:"chartCacheHitColor",label:"Cache Hit Color",description:"Cache hit visualization",affects:["Hit rate charts","Success indicators"],supportsAlpha:!0},{key:"chartCacheMissColor",label:"Cache Miss Color",description:"Cache miss visualization",affects:["Miss rate charts","Warning indicators"],supportsAlpha:!0},{key:"chartGridColor",label:"Chart Grid",description:"Chart grid lines",affects:["Grid lines","Axes"],supportsAlpha:!0},{key:"chartTextColor",label:"Chart Text",description:"Chart labels and legends",affects:["Axis labels","Legends"],supportsAlpha:!0}]},{name:"accessControl",icon:ce,description:"Security and access control indicators",colors:[{key:"publicAccessBg",label:"Public Access Background",description:"Public/open access indicator",affects:["Public badges","Open access indicators"],supportsAlpha:!0},{key:"publicAccessText",label:"Public Access Text",description:"Public access text color",affects:["Public labels","Open text"],supportsAlpha:!0},{key:"publicAccessBorder",label:"Public Access Border",description:"Public access border",affects:["Public badge borders"],supportsAlpha:!0},{key:"securedAccessBg",label:"Secured Access Background",description:"Secured/locked access indicator",affects:["Security badges","Locked indicators"],supportsAlpha:!0},{key:"securedAccessText",label:"Secured Access Text",description:"Secured access text color",affects:["Security labels","Locked text"],supportsAlpha:!0},{key:"securedAccessBorder",label:"Secured Access Border",description:"Secured access border",affects:["Security badge borders"],supportsAlpha:!0}]},{name:"platforms",icon:Ut,description:"Gaming platform and service colors",colors:[{key:"steamColor",label:"Steam",description:"Steam platform color",affects:["Steam badges","Steam charts"],supportsAlpha:!0,pages:["dashboard","downloads","clients","services","charts"]},{key:"epicColor",label:"Epic Games",description:"Epic Games platform color",affects:["Epic badges","Epic charts"],supportsAlpha:!0,pages:["dashboard","downloads","clients","services","charts"]},{key:"originColor",label:"Origin/EA",description:"EA/Origin platform color",affects:["Origin badges","EA charts"],pages:["dashboard","downloads","clients","services","charts"],supportsAlpha:!0},{key:"blizzardColor",label:"Blizzard",description:"Blizzard platform color",affects:["Blizzard badges","Battle.net charts"],supportsAlpha:!0,pages:["dashboard","downloads","clients","services","charts"]},{key:"wsusColor",label:"Windows Update",description:"Windows Update service color",affects:["WSUS badges","Update charts"],supportsAlpha:!0,pages:["dashboard","downloads","clients","services","charts"]},{key:"riotColor",label:"Riot Games",description:"Riot Games platform color",affects:["Riot badges","Riot charts"],supportsAlpha:!0,pages:["dashboard","downloads","clients","services","charts"]},{key:"riotColor",label:"Riot Games",description:"Riot Games platform color",affects:["Riot badges","LoL charts"],supportsAlpha:!0}]},{name:"performance",icon:$e,description:"Performance indicators and cache hit rate colors",colors:[{key:"hitRateHighBg",label:"High Hit Rate Background",description:"Background for high cache hit rates",affects:["90%+ hit rate badges","Success indicators"],supportsAlpha:!0,pages:["dashboard","downloads","clients","services"]},{key:"hitRateHighText",label:"High Hit Rate Text",description:"Text color for high hit rates",affects:["High hit rate labels"],supportsAlpha:!0,pages:["dashboard","downloads","clients","services"]},{key:"hitRateMediumBg",label:"Medium Hit Rate Background",description:"Background for medium cache hit rates",affects:["50-89% hit rate badges"],supportsAlpha:!0,pages:["dashboard","downloads","clients","services"]},{key:"hitRateMediumText",label:"Medium Hit Rate Text",description:"Text color for medium hit rates",affects:["Medium hit rate labels"],supportsAlpha:!0,pages:["dashboard","downloads","clients","services"]},{key:"hitRateLowBg",label:"Low Hit Rate Background",description:"Background for low cache hit rates",affects:["0-49% hit rate badges"],supportsAlpha:!0,pages:["dashboard","downloads","clients","services"]},{key:"hitRateLowText",label:"Low Hit Rate Text",description:"Text color for low hit rates",affects:["Low hit rate labels"],supportsAlpha:!0,pages:["dashboard","downloads","clients","services"]},{key:"hitRateWarningBg",label:"Warning Hit Rate Background",description:"Background for warning hit rates",affects:["Critical performance warnings"],supportsAlpha:!0,pages:["dashboard","downloads"]},{key:"hitRateWarningText",label:"Warning Hit Rate Text",description:"Text color for warning hit rates",affects:["Warning labels"],supportsAlpha:!0,pages:["dashboard","downloads"]}]},{name:"actions",icon:We,description:"Action button colors for operations",colors:[{key:"actionResetBg",label:"Reset Button Background",description:"Reset action button background",affects:["Reset buttons","Clear actions"],supportsAlpha:!0,pages:["management"]},{key:"actionResetHover",label:"Reset Button Hover",description:"Reset button hover state",affects:["Reset button hover"],supportsAlpha:!0,pages:["management"]},{key:"actionProcessBg",label:"Process Button Background",description:"Process action button background",affects:["Process buttons","Start actions"],supportsAlpha:!0,pages:["management"]},{key:"actionProcessHover",label:"Process Button Hover",description:"Process button hover state",affects:["Process button hover"],supportsAlpha:!0,pages:["management"]},{key:"actionDeleteBg",label:"Delete Button Background",description:"Delete action button background",affects:["Delete buttons","Remove actions"],supportsAlpha:!0,pages:["management"]},{key:"actionDeleteHover",label:"Delete Button Hover",description:"Delete button hover state",affects:["Delete button hover"],supportsAlpha:!0,pages:["management"]}]},{name:"utilities",icon:Wt,description:"Utility colors for specialized UI elements",colors:[{key:"scrollbarTrack",label:"Scrollbar Track",description:"Scrollbar background track",affects:["Scrollbar tracks","Scroll gutters"],supportsAlpha:!0},{key:"scrollbarThumb",label:"Scrollbar Thumb",description:"Scrollbar draggable element",affects:["Scrollbar handles"],supportsAlpha:!0},{key:"scrollbarHover",label:"Scrollbar Hover",description:"Scrollbar hover state",affects:["Scrollbar hover effects"],supportsAlpha:!0},{key:"iconBgBlue",label:"Blue Icon Background",description:"Blue icon container",affects:["Database icons","Info icons"],supportsAlpha:!0},{key:"iconBgGreen",label:"Green Icon Background",description:"Green icon container",affects:["Success icons","Online status"],supportsAlpha:!0},{key:"iconBgEmerald",label:"Emerald Icon Background",description:"Emerald icon container",affects:["Trending icons","Growth indicators"],supportsAlpha:!0},{key:"iconBgPurple",label:"Purple Icon Background",description:"Purple icon container",affects:["Special features","Premium indicators"],supportsAlpha:!0},{key:"iconBgIndigo",label:"Indigo Icon Background",description:"Indigo icon container",affects:["Server icons","System indicators"],supportsAlpha:!0},{key:"iconBgOrange",label:"Orange Icon Background",description:"Orange icon container",affects:["Download icons","Activity indicators"],supportsAlpha:!0},{key:"iconBgYellow",label:"Yellow Icon Background",description:"Yellow icon container",affects:["Warning icons","Client indicators"],supportsAlpha:!0},{key:"iconBgCyan",label:"Cyan Icon Background",description:"Cyan icon container",affects:["Activity icons","Performance indicators"],supportsAlpha:!0},{key:"iconBgRed",label:"Red Icon Background",description:"Red icon container",affects:["Error icons","Critical indicators"],supportsAlpha:!0}]}];h.useEffect(()=>{he();const t=q.getCurrentThemeId();p(t)},[]),h.useEffect(()=>{if(B){const t=getComputedStyle(document.documentElement),a=(u,o)=>t.getPropertyValue(u).trim()||o;J(u=>({...u,primaryColor:a("--theme-primary","#3b82f6"),secondaryColor:a("--theme-secondary","#8b5cf6"),accentColor:a("--theme-accent","#06b6d4"),bgPrimary:a("--theme-bg-primary","#111827"),bgSecondary:a("--theme-bg-secondary","#1f2937"),bgTertiary:a("--theme-bg-tertiary","#374151"),bgHover:a("--theme-bg-hover","#4b5563"),textPrimary:a("--theme-text-primary","#ffffff"),textSecondary:a("--theme-text-secondary","#d1d5db"),textMuted:a("--theme-text-muted","#9ca3af"),textAccent:a("--theme-text-accent","#60a5fa"),textPlaceholder:a("--theme-text-placeholder","#6b7280"),dragHandleColor:a("--theme-drag-handle-color","#6b7280"),dragHandleHover:a("--theme-drag-handle-hover","#60a5fa"),borderPrimary:a("--theme-border-primary","#374151"),borderSecondary:a("--theme-border-secondary","#4b5563"),borderFocus:a("--theme-border-focus","#3b82f6"),navBg:a("--theme-nav-bg","#1f2937"),navBorder:a("--theme-nav-border","#374151"),navTabActive:a("--theme-nav-tab-active","#3b82f6"),navTabInactive:a("--theme-nav-tab-inactive","#9ca3af"),navTabHover:a("--theme-nav-tab-hover","#ffffff"),navTabActiveBorder:a("--theme-nav-tab-active-border","#3b82f6"),navMobileMenuBg:a("--theme-nav-mobile-menu-bg","#1f2937"),navMobileItemHover:a("--theme-nav-mobile-item-hover","#374151"),success:a("--theme-success","#10b981"),successBg:a("--theme-success-bg","#064e3b"),successText:a("--theme-success-text","#34d399"),warning:a("--theme-warning","#f59e0b"),warningBg:a("--theme-warning-bg","#78350f"),warningText:a("--theme-warning-text","#fbbf24"),error:a("--theme-error","#ef4444"),errorBg:a("--theme-error-bg","#7f1d1d"),errorText:a("--theme-error-text","#fca5a5"),info:a("--theme-info","#3b82f6"),infoBg:a("--theme-info-bg","#1e3a8a"),infoText:a("--theme-info-text","#93c5fd"),steamColor:a("--theme-steam-color","#1e40af"),epicColor:a("--theme-epic-color","#7c3aed"),originColor:a("--theme-origin-color","#ea580c"),blizzardColor:a("--theme-blizzard-color","#0891b2"),wsusColor:a("--theme-wsus-color","#16a34a"),riotColor:a("--theme-riot-color","#dc2626"),cardBg:a("--theme-card-bg","#1f2937"),cardBorder:a("--theme-card-border","#374151"),buttonBg:a("--theme-button-bg","#3b82f6"),buttonHover:a("--theme-button-hover","#2563eb"),buttonText:a("--theme-button-text",a("--theme-text-primary","#ffffff")),inputBg:a("--theme-input-bg","#374151"),inputBorder:a("--theme-input-border","#4b5563"),inputFocus:a("--theme-input-focus","#3b82f6"),checkboxAccent:a("--theme-checkbox-accent",a("--theme-primary","#3b82f6")),checkboxBorder:a("--theme-checkbox-border",a("--theme-border-secondary","#4b5563")),sliderAccent:a("--theme-slider-accent",a("--theme-primary","#3b82f6")),sliderThumb:a("--theme-slider-thumb",a("--theme-primary","#3b82f6")),sliderTrack:a("--theme-slider-track",a("--theme-bg-tertiary","#374151")),badgeBg:a("--theme-badge-bg","#3b82f6"),badgeText:a("--theme-badge-text",a("--theme-text-primary","#ffffff")),progressBar:a("--theme-progress-bar","#3b82f6"),progressBg:a("--theme-progress-bg","#374151"),iconBgBlue:a("--theme-icon-bg-blue","#3b82f6"),iconBgGreen:a("--theme-icon-bg-green","#10b981"),iconBgEmerald:a("--theme-icon-bg-emerald","#10b981"),iconBgPurple:a("--theme-icon-bg-purple","#8b5cf6"),iconBgIndigo:a("--theme-icon-bg-indigo","#6366f1"),iconBgOrange:a("--theme-icon-bg-orange","#f97316"),iconBgYellow:a("--theme-icon-bg-yellow","#eab308"),iconBgCyan:a("--theme-icon-bg-cyan","#06b6d4"),iconBgRed:a("--theme-icon-bg-red","#ef4444"),chartColor1:a("--theme-chart-color-1","#3b82f6"),chartColor2:a("--theme-chart-color-2","#10b981"),chartColor3:a("--theme-chart-color-3","#f59e0b"),chartColor4:a("--theme-chart-color-4","#ef4444"),chartColor5:a("--theme-chart-color-5","#8b5cf6"),chartColor6:a("--theme-chart-color-6","#06b6d4"),chartColor7:a("--theme-chart-color-7","#f97316"),chartColor8:a("--theme-chart-color-8","#ec4899"),chartBorderColor:a("--theme-chart-border-color","#1f2937"),chartGridColor:a("--theme-chart-grid-color","#374151"),chartTextColor:a("--theme-chart-text-color","#9ca3af"),chartCacheHitColor:a("--theme-chart-cache-hit-color","#10b981"),chartCacheMissColor:a("--theme-chart-cache-miss-color","#f59e0b"),scrollbarThumb:a("--theme-scrollbar-thumb","#4b5563"),scrollbarTrack:a("--theme-scrollbar-track","#1f2937"),scrollbarThumbHover:a("--theme-scrollbar-thumb-hover","#6b7280"),scrollbarHover:a("--theme-scrollbar-hover","#9CA3AF"),hitRateHighBg:a("--theme-hit-rate-high-bg","#064e3b"),hitRateHighText:a("--theme-hit-rate-high-text","#34d399"),hitRateMediumBg:a("--theme-hit-rate-medium-bg","#1e3a8a"),hitRateMediumText:a("--theme-hit-rate-medium-text","#93c5fd"),hitRateLowBg:a("--theme-hit-rate-low-bg","#44403c"),hitRateLowText:a("--theme-hit-rate-low-text","#fbbf24"),hitRateWarningBg:a("--theme-hit-rate-warning-bg","#44403c"),hitRateWarningText:a("--theme-hit-rate-warning-text","#fcd34d"),actionResetBg:a("--theme-action-reset-bg","#f59e0b"),actionResetHover:a("--theme-action-reset-hover","#d97706"),actionProcessBg:a("--theme-action-process-bg","#10b981"),actionProcessHover:a("--theme-action-process-hover","#059669"),actionDeleteBg:a("--theme-action-delete-bg","#ef4444"),actionDeleteHover:a("--theme-action-delete-hover","#dc2626"),publicAccessBg:a("--theme-public-access-bg","rgba(16, 185, 129, 0.2)"),publicAccessText:a("--theme-public-access-text","#34d399"),publicAccessBorder:a("--theme-public-access-border","rgba(16, 185, 129, 0.3)"),securedAccessBg:a("--theme-secured-access-bg","rgba(245, 158, 11, 0.2)"),securedAccessText:a("--theme-secured-access-text","#fbbf24"),securedAccessBorder:a("--theme-secured-access-border","rgba(245, 158, 11, 0.3)")}))}},[B]);const he=async()=>{l(!0);try{const t=await q.loadThemes();s(t)}catch(t){console.error("Failed to load themes:",t),b("Failed to load themes")}finally{l(!1)}},X=async t=>{try{if(!t){q.clearTheme(),p(""),m(null);return}const a=await q.getTheme(t);a&&(q.applyTheme(a),p(t),m(null))}catch(a){console.error("Failed to apply theme:",a),b("Failed to apply theme")}},pt=async t=>{if(x===t)X(d),m(null);else try{const a=await q.getTheme(t);a&&(q.applyTheme(a),m(t))}catch(a){console.error("Failed to preview theme:",a)}},Fe=t=>{G(a=>a.includes(t)?a.filter(u=>u!==t):[...a,t])},[ft,je]=h.useState({}),Ce=t=>{if(!ft[t]){const a=H[t];a&&localStorage.setItem(`color_history_create_${t}`,a),je(u=>({...u,[t]:!0}))}},gt=(t,a)=>{J(u=>({...u,[t]:a}))},bt=t=>{const a=localStorage.getItem(`color_history_create_${t}`);if(a){const u=H[t];J(o=>({...o,[t]:a})),localStorage.setItem(`color_history_create_${t}`,u)}},De=t=>localStorage.getItem(`color_history_create_${t}`),we=t=>{if(!n[t]){const a=_[t];if(a&&a.match(/^#[0-9a-fA-F]{6}$/)){const u=`color_history_${v==null?void 0:v.meta.id}_${t}`;localStorage.setItem(u,a)}C(u=>({...u,[t]:!0}))}},xt=(t,a)=>{V(u=>({...u,[t]:a}))},yt=t=>{const a=`color_history_${v==null?void 0:v.meta.id}_${t}`,u=localStorage.getItem(a);if(u){const o=_[t];V(k=>({...k,[t]:u})),localStorage.setItem(a,o||"")}},vt=t=>{const a=`color_history_${v==null?void 0:v.meta.id}_${t}`;return localStorage.getItem(a)},Oe=async t=>{try{if(navigator.clipboard&&navigator.clipboard.writeText)await navigator.clipboard.writeText(t);else{const a=document.createElement("textarea");a.value=t,a.style.position="fixed",a.style.left="-999999px",a.style.top="-999999px",document.body.appendChild(a),a.focus(),a.select(),document.execCommand("copy"),document.body.removeChild(a)}i(t),setTimeout(()=>i(null),2e3)}catch(a){console.error("Failed to copy color:",a)}},ke=t=>{t.preventDefault(),t.stopPropagation(),t.type==="dragenter"||t.type==="dragover"?g(!0):t.type==="dragleave"&&g(!1)},jt=async t=>{t.preventDefault(),t.stopPropagation(),g(!1),t.dataTransfer.files&&t.dataTransfer.files[0]&&await Ee(t.dataTransfer.files[0])},Ee=async t=>{if(b(null),A(null),!t.name.endsWith(".toml")){b("Only TOML theme files are supported");return}if(t.size>1024*1024){b("Theme file too large (max 1MB)");return}l(!0);try{const a=await q.uploadTheme(t);await new Promise(o=>setTimeout(o,100));const u=await q.loadThemes();s(u),A(`Theme "${a.meta.name}" uploaded successfully`),setTimeout(()=>A(null),5e3)}catch(a){b(a.message)}finally{l(!1)}},Ct=async(t,a)=>{var o;if(["dark-default","light-default"].includes(t)){b("System themes cannot be deleted"),setTimeout(()=>b(null),5e3);return}if(!c){b("Authentication required to delete custom themes"),setTimeout(()=>b(null),5e3);return}if(window.confirm(`Delete theme "${a}"? This cannot be undone.`)){l(!0);try{const k=await fetch(`${tt}/theme/${t}`,{method:"DELETE",headers:Q.getAuthHeaders()}),w=await k.json();if(k.ok&&w.success){await he(),d===t&&X("dark-default");const $=((o=w.filesDeleted)==null?void 0:o.join(", "))||"theme files";A(`Theme "${a}" deleted successfully (removed: ${$})`),setTimeout(()=>A(null),5e3)}else if(k.status===404)b(`Theme "${a}" not found on server. ${w.details||""}`),s($=>$.filter(E=>E.meta.id!==t)),d===t&&X("dark-default"),w.availableThemes,setTimeout(()=>b(null),1e4);else{const $=w.error||w.message||"Failed to delete theme",E=w.details?` Details: ${w.details}`:"";b(`${$}${E}`),setTimeout(()=>b(null),7e3)}}catch(k){console.error("Delete request failed:",k),b(`Failed to delete theme: ${k.message||"Network error"}`),setTimeout(()=>b(null),7e3)}finally{l(!1)}}},wt=async()=>{if(!c){b("Authentication required to clean up themes"),setTimeout(()=>b(null),5e3);return}if(window.confirm("This will DELETE all custom themes (keeping only system themes). This cannot be undone. Continue?")){l(!0);try{const t=await fetch(`${tt}/theme/cleanup`,{method:"POST",headers:{"Content-Type":"application/json",...Q.getAuthHeaders()}});if(!t.ok)throw new Error("Failed to cleanup themes");const a=await t.json();await he(),y.map(o=>o.meta.id).includes(d)||X("dark-default"),A(a.message||"All custom themes have been deleted"),setTimeout(()=>A(null),5e3)}catch(t){b("Failed to cleanup themes: "+t.message),setTimeout(()=>b(null),5e3)}finally{l(!1)}}},kt=t=>{var o;if(!c){b("Authentication required to edit themes"),setTimeout(()=>b(null),5e3);return}if(te(t.meta.id)){b("System themes cannot be edited"),setTimeout(()=>b(null),5e3);return}const a=y.find(k=>k.meta.id===t.meta.id)||t;C({}),L(a);const u={name:a.meta.name,description:a.meta.description||"",author:a.meta.author||"",version:a.meta.version||"1.0.0",isDark:a.meta.isDark!==!1,...a.colors,customCSS:((o=a.css)==null?void 0:o.content)||""};a.colors.dragHandleColor||(u.dragHandleColor=a.meta.isDark?"#6b7280":"#9ca3af"),a.colors.dragHandleHover||(u.dragHandleHover=a.meta.isDark?"#60a5fa":"#2563eb"),V(u),I(!0)},Nt=async()=>{if(!c||!v)return;if(!_.name.trim()){b("Theme name is required"),setTimeout(()=>b(null),5e3);return}const t={};Object.entries(_).forEach(([w,$])=>{["name","description","author","version","isDark","customCSS"].includes(w)||(t[w]=$)});const a={meta:{id:v.meta.id,name:_.name,description:_.description,author:_.author,version:_.version,isDark:_.isDark},colors:t,css:_.customCSS?{content:_.customCSS}:void 0},u=q.exportTheme(a),o=new Blob([u],{type:"text/plain"}),k=new File([o],`${a.meta.id}.toml`,{type:"text/plain"});l(!0);try{await q.uploadTheme(k),await new Promise(E=>setTimeout(E,100));const w=await q.loadThemes();s(w);const $=w.find(E=>E.meta.id===a.meta.id);if($)d===v.meta.id&&q.applyTheme($),A(`Theme "${$.meta.name}" updated successfully`);else throw new Error("Theme was uploaded but not found on server");Object.keys(_).forEach(E=>{const ue=`color_history_${v.meta.id}_${E}`;localStorage.removeItem(ue)}),C({}),I(!1),L(null),V({}),setTimeout(()=>A(null),5e3)}catch(w){b(w.message||"Failed to update theme"),l(!1);return}l(!1)},Tt=async()=>{if(!c){b("Authentication required to create themes");return}if(!H.name.trim()){b("Theme name is required"),setTimeout(()=>b(null),5e3);return}const t={meta:{id:H.name.toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,""),name:H.name,description:H.description,author:H.author,version:H.version,isDark:H.isDark},colors:{...H},css:H.customCSS?{content:H.customCSS}:void 0};delete t.colors.name,delete t.colors.description,delete t.colors.author,delete t.colors.version,delete t.colors.isDark,delete t.colors.customCSS;const a=q.exportTheme(t),u=new Blob([a],{type:"text/plain"}),o=new File([u],`${t.meta.id}.toml`,{type:"text/plain"});l(!0);try{await q.uploadTheme(o),await new Promise($=>setTimeout($,100));const k=await q.loadThemes();s(k);const w=k.find($=>$.meta.id===t.meta.id);w&&(q.applyTheme(w),p(w.meta.id)),M(!1),Object.keys(H).forEach($=>{localStorage.removeItem(`color_history_create_${$}`)}),je({}),J({name:"",description:"",author:"",version:"1.0.0",isDark:!0,primaryColor:"#3b82f6",secondaryColor:"#8b5cf6",accentColor:"#06b6d4",bgPrimary:"#111827",bgSecondary:"#1f2937",bgTertiary:"#374151",bgHover:"#4b5563",textPrimary:"#ffffff",textSecondary:"#d1d5db",textMuted:"#9ca3af",textAccent:"#60a5fa",dragHandleColor:"#6b7280",dragHandleHover:"#60a5fa",borderPrimary:"#374151",borderSecondary:"#4b5563",borderFocus:"#3b82f6",navBg:"#1f2937",navBorder:"#374151",navTabActive:"#3b82f6",navTabInactive:"#9ca3af",navTabHover:"#ffffff",navTabActiveBorder:"#3b82f6",navMobileMenuBg:"#1f2937",navMobileItemHover:"#374151",success:"#10b981",successBg:"#064e3b",successText:"#34d399",warning:"#f59e0b",warningBg:"#78350f",warningText:"#fbbf24",error:"#ef4444",errorBg:"#7f1d1d",errorText:"#fca5a5",info:"#3b82f6",infoBg:"#1e3a8a",infoText:"#93c5fd",steamColor:"#1e40af",epicColor:"#7c3aed",originColor:"#ea580c",blizzardColor:"#0891b2",wsusColor:"#16a34a",riotColor:"#dc2626",cardBg:"#1f2937",cardBorder:"#374151",buttonBg:"#3b82f6",buttonHover:"#2563eb",buttonText:"#ffffff",inputBg:"#374151",inputBorder:"#4b5563",inputFocus:"#3b82f6",badgeBg:"#3b82f6",badgeText:"#ffffff",progressBar:"#3b82f6",progressBg:"#374151",iconBgBlue:"#3b82f6",iconBgGreen:"#10b981",iconBgEmerald:"#10b981",iconBgPurple:"#8b5cf6",iconBgIndigo:"#6366f1",iconBgOrange:"#f97316",iconBgYellow:"#eab308",iconBgCyan:"#06b6d4",iconBgRed:"#ef4444",chartColor1:"#3b82f6",chartColor2:"#10b981",chartColor3:"#f59e0b",chartColor4:"#ef4444",chartColor5:"#8b5cf6",chartColor6:"#06b6d4",chartColor7:"#f97316",chartColor8:"#ec4899",chartBorderColor:"#1f2937",chartGridColor:"#374151",chartTextColor:"#9ca3af",chartCacheHitColor:"#10b981",chartCacheMissColor:"#f59e0b",scrollbarTrack:"#374151",scrollbarThumb:"#6B7280",scrollbarHover:"#9CA3AF",publicAccessBg:"rgba(16, 185, 129, 0.2)",publicAccessText:"#34d399",publicAccessBorder:"rgba(16, 185, 129, 0.3)",securedAccessBg:"rgba(245, 158, 11, 0.2)",securedAccessText:"#fbbf24",securedAccessBorder:"rgba(245, 158, 11, 0.3)",customCSS:""}),A(`Theme "${t.meta.name}" created successfully`),setTimeout(()=>A(null),5e3)}catch(k){b(k.message||"Failed to create theme")}finally{l(!1)}},ze=t=>{J(t==="dark"?a=>({...a,isDark:!0,bgPrimary:"#111827",bgSecondary:"#1f2937",bgTertiary:"#374151",bgHover:"#4b5563",textPrimary:"#ffffff",textSecondary:"#d1d5db",textMuted:"#9ca3af",dragHandleColor:"#6b7280",dragHandleHover:"#00ff00",borderPrimary:"#374151",borderSecondary:"#4b5563",navBg:"#1f2937",navBorder:"#374151",navTabActive:"#3b82f6",navTabInactive:"#9ca3af",navTabHover:"#ffffff",navTabActiveBorder:"#3b82f6",navMobileMenuBg:"#1f2937",navMobileItemHover:"#374151",cardBg:"#1f2937",cardBorder:"#374151",inputBg:"#374151",inputBorder:"#4b5563",progressBg:"#374151",successBg:"#064e3b",successText:"#34d399",warningBg:"#78350f",warningText:"#fbbf24",errorBg:"#7f1d1d",errorText:"#fca5a5",infoBg:"#1e3a8a",infoText:"#93c5fd",chartBorderColor:"#1f2937",chartGridColor:"#374151",chartTextColor:"#9ca3af",scrollbarTrack:"#374151",scrollbarThumb:"#6B7280",scrollbarHover:"#9CA3AF"}):a=>({...a,isDark:!1,bgPrimary:"#ffffff",bgSecondary:"#f9fafb",bgTertiary:"#f3f4f6",bgHover:"#e5e7eb",textPrimary:"#111827",textSecondary:"#374151",textMuted:"#6b7280",dragHandleColor:"#9ca3af",dragHandleHover:"#2563eb",borderPrimary:"#e5e7eb",borderSecondary:"#d1d5db",navBg:"#f9fafb",navBorder:"#e5e7eb",navTabActive:"#3b82f6",navTabInactive:"#6b7280",navTabHover:"#111827",navTabActiveBorder:"#3b82f6",navMobileMenuBg:"#f9fafb",navMobileItemHover:"#e5e7eb",cardBg:"#ffffff",cardBorder:"#e5e7eb",buttonBg:"#3b82f6",buttonHover:"#2563eb",buttonText:"#ffffff",inputBg:"#ffffff",inputBorder:"#d1d5db",inputFocus:"#3b82f6",checkboxAccent:"#3b82f6",checkboxBorder:"#d1d5db",sliderAccent:"#3b82f6",sliderThumb:"#3b82f6",sliderTrack:"#e5e7eb",badgeBg:"#3b82f6",badgeText:"#ffffff",progressBar:"#3b82f6",progressBg:"#e5e7eb",successBg:"#d1fae5",successText:"#065f46",warningBg:"#fef3c7",warningText:"#92400e",errorBg:"#fee2e2",errorText:"#991b1b",infoBg:"#dbeafe",infoText:"#1e40af",chartBorderColor:"#e5e7eb",chartGridColor:"#d1d5db",chartTextColor:"#6b7280",scrollbarTrack:"#f3f4f6",scrollbarThumb:"#9ca3af",scrollbarHover:"#6b7280"}))},St=t=>{const a=q.exportTheme(t),u=new Blob([a],{type:"text/plain"}),o=URL.createObjectURL(u),k=document.createElement("a");k.href=o,k.download=`${t.meta.id}.toml`,k.click(),URL.revokeObjectURL(o)},Bt=()=>{const t=`# Sample Theme for LANCache Manager
[meta]
name = "My Custom Theme"
id = "my-custom-theme"
description = "A beautiful custom theme"
author = "Your Name"
version = "1.0.0"
isDark = true

[colors]
# Core colors
primaryColor = "#3b82f6"
secondaryColor = "#8b5cf6"
accentColor = "#06b6d4"

# Backgrounds
bgPrimary = "#111827"
bgSecondary = "#1f2937"
bgTertiary = "#374151"
bgHover = "#4b5563"

# Text
textPrimary = "#ffffff"
textSecondary = "#d1d5db"
textMuted = "#9ca3af"
textAccent = "#60a5fa"
dragHandleColor = "#6b7280"
dragHandleHover = "#60a5fa"

# Borders
borderPrimary = "#374151"
borderSecondary = "#4b5563"
borderFocus = "#3b82f6"

# Navigation colors
navBg = "#1f2937"
navBorder = "#374151"
navTabActive = "#3b82f6"
navTabInactive = "#9ca3af"
navTabHover = "#ffffff"
navTabActiveBorder = "#3b82f6"
navMobileMenuBg = "#1f2937"
navMobileItemHover = "#374151"

# Hit Rate & Status Badge colors
hitRateHighBg = "#064e3b"
hitRateHighText = "#34d399"
hitRateMediumBg = "#1e3a8a"
hitRateMediumText = "#93c5fd"
hitRateLowBg = "#ea580c"
hitRateLowText = "#fb923c"
statusWarningBg = "#78350f"
statusWarningText = "#fbbf24"

# Action Button colors
actionResetBg = "#f59e0b"
actionResetHover = "#d97706"
actionProcessBg = "#10b981"
actionProcessHover = "#059669"
actionDeleteBg = "#ef4444"
actionDeleteHover = "#dc2626"

# Status colors
success = "#10b981"
successBg = "#064e3b"
successText = "#34d399"
warning = "#f59e0b"
warningBg = "#78350f"
warningText = "#fbbf24"
error = "#ef4444"
errorBg = "#7f1d1d"
errorText = "#fca5a5"
info = "#3b82f6"
infoBg = "#1e3a8a"
infoText = "#93c5fd"

# Service colors
steamColor = "#1e40af"
epicColor = "#7c3aed"
originColor = "#ea580c"
blizzardColor = "#0891b2"
wsusColor = "#16a34a"
riotColor = "#dc2626"

# Components
cardBg = "#1f2937"
cardBorder = "#374151"
buttonBg = "#3b82f6"
buttonHover = "#2563eb"
buttonText = "#ffffff"
inputBg = "#374151"
inputBorder = "#4b5563"
inputFocus = "#3b82f6"
badgeBg = "#3b82f6"
badgeText = "#ffffff"
progressBar = "#3b82f6"
progressBg = "#374151"

# Icon backgrounds (solid colors, no gradients)
iconBgBlue = "#3b82f6"
iconBgGreen = "#10b981"
iconBgEmerald = "#10b981"
iconBgPurple = "#8b5cf6"
iconBgIndigo = "#6366f1"
iconBgOrange = "#f97316"
iconBgYellow = "#eab308"
iconBgCyan = "#06b6d4"
iconBgRed = "#ef4444"

# Chart colors
chartColor1 = "#3b82f6"
chartColor2 = "#10b981"
chartColor3 = "#f59e0b"
chartColor4 = "#ef4444"
chartColor5 = "#8b5cf6"
chartColor6 = "#06b6d4"
chartColor7 = "#f97316"
chartColor8 = "#ec4899"
chartBorderColor = "#1f2937"
chartGridColor = "#374151"
chartTextColor = "#9ca3af"
chartCacheHitColor = "#10b981"
chartCacheMissColor = "#f59e0b"

[css]
content = """
/* Add any custom CSS here */
"""`,a=new Blob([t],{type:"text/plain"}),u=URL.createObjectURL(a),o=document.createElement("a");o.href=u,o.download="sample-theme.toml",o.click(),URL.revokeObjectURL(u)},te=t=>["dark-default","light-default"].includes(t);return e.jsxs(e.Fragment,{children:[e.jsxs(Z,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ue,{className:"w-5 h-5 text-themed-accent"}),e.jsx("h3",{className:"text-lg font-semibold text-themed-primary",children:"Theme Management"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[c?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>M(!0),className:"p-2 rounded-lg transition-colors",style:{color:"var(--theme-text-muted)",backgroundColor:"transparent"},onMouseEnter:t=>t.currentTarget.style.backgroundColor="var(--theme-bg-hover)",onMouseLeave:t=>t.currentTarget.style.backgroundColor="transparent",title:"Create new theme",children:e.jsx(Mt,{className:"w-4 h-4"})}),e.jsx("button",{onClick:wt,disabled:r,className:"p-2 rounded-lg transition-colors",style:{color:"var(--theme-text-muted)",backgroundColor:"transparent"},onMouseEnter:t=>t.currentTarget.style.backgroundColor="var(--theme-bg-hover)",onMouseLeave:t=>t.currentTarget.style.backgroundColor="transparent",title:"Delete all custom themes",children:e.jsx(We,{className:"w-4 h-4"})})]}):e.jsx("button",{disabled:!0,className:"p-2 rounded-lg transition-colors opacity-50 cursor-not-allowed",style:{color:"var(--theme-text-muted)",backgroundColor:"transparent"},title:"Authentication required to create themes",children:e.jsx(ce,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>he(),disabled:r,className:"p-2 rounded-lg transition-colors",style:{color:"var(--theme-text-muted)",backgroundColor:"transparent"},onMouseEnter:t=>t.currentTarget.style.backgroundColor="var(--theme-bg-hover)",onMouseLeave:t=>t.currentTarget.style.backgroundColor="transparent",title:"Refresh themes",children:e.jsx(nt,{className:`w-4 h-4 ${r?"animate-spin":""}`})})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium mb-2 text-themed-secondary",children:"Active Theme"}),e.jsx("select",{value:x||d,onChange:t=>X(t.target.value),className:"w-full px-3 py-2 focus:outline-none themed-input",disabled:r,children:y.map(t=>e.jsxs("option",{value:t.meta.id,children:[t.meta.name," ",t.meta.author&&t.meta.author!=="System"&&`by ${t.meta.author}`,te(t.meta.id)&&" (System)",x===t.meta.id&&" (Preview)"]},t.meta.id))}),x&&e.jsx("p",{className:"text-xs mt-2 text-themed-warning",children:"Preview mode active. Select a theme to apply it permanently."})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("h4",{className:"text-sm font-medium mb-3 text-themed-secondary",children:["Installed Themes (",y.length,")"]}),e.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:y.map(t=>e.jsxs("div",{className:"rounded p-3 flex items-center justify-between border-2 transition-colors themed-card",style:{borderColor:d===t.meta.id&&!x?"var(--theme-primary)":x===t.meta.id?"var(--theme-warning)":"transparent"},children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-themed-primary",children:t.meta.name}),t.meta.isDark?e.jsx(qe,{className:"w-3 h-3 text-themed-muted"}):e.jsx(Ye,{className:"w-3 h-3 text-themed-warning"}),d===t.meta.id&&!x&&e.jsx("span",{className:"px-2 py-0.5 text-xs rounded themed-button-primary",children:"Active"}),x===t.meta.id&&e.jsx("span",{className:"px-2 py-0.5 text-xs rounded bg-themed-warning text-themed-primary",children:"Preview"}),te(t.meta.id)&&e.jsx("span",{className:"px-2 py-0.5 text-xs rounded bg-themed-hover text-themed-muted",children:"System"})]}),t.meta.description&&e.jsx("p",{className:"text-xs mt-1 text-themed-muted",children:t.meta.description}),e.jsxs("div",{className:"flex items-center gap-3 mt-1",children:[t.meta.author&&e.jsxs("p",{className:"text-xs text-themed-muted",children:["by ",t.meta.author]}),t.meta.version&&e.jsxs("p",{className:"text-xs text-themed-muted",children:["v",t.meta.version]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>St(t),className:"p-2 transition-colors text-themed-muted",title:"Export theme",children:e.jsx(oe,{className:"w-4 h-4"})}),d!==t.meta.id&&e.jsx("button",{onClick:()=>pt(t.meta.id),className:"p-2 transition-colors",style:{color:x===t.meta.id?"var(--theme-warning)":"var(--theme-text-muted)"},title:x===t.meta.id?"Stop preview":"Preview theme",children:x===t.meta.id?e.jsx(It,{className:"w-4 h-4"}):e.jsx(lt,{className:"w-4 h-4"})}),d!==t.meta.id&&e.jsx("button",{onClick:()=>X(t.meta.id),className:"p-2 transition-colors text-themed-accent",title:"Apply theme",children:e.jsx(Se,{className:"w-4 h-4"})}),!te(t.meta.id)&&c&&e.jsx("button",{onClick:()=>kt(t),disabled:r,className:"p-2 transition-colors text-themed-secondary",title:"Edit theme",children:e.jsx(Ht,{className:"w-4 h-4"})}),!te(t.meta.id)&&c&&e.jsx("button",{onClick:()=>Ct(t.meta.id,t.meta.name),disabled:r,className:"p-2 transition-colors disabled:opacity-50 text-themed-error",title:"Delete theme",children:e.jsx(rt,{className:"w-4 h-4"})})]})]},t.meta.id))})]}),c&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"text-sm font-medium mb-3 text-themed-secondary",children:"Upload Custom Theme"}),e.jsxs("div",{className:`border-2 border-dashed rounded-lg p-8 text-center transition-colors ${j?"border-purple-500 bg-purple-900 bg-opacity-20":""}`,style:{borderColor:j?"var(--theme-secondary)":"var(--theme-border-secondary)"},onDragEnter:ke,onDragLeave:ke,onDragOver:ke,onDrop:jt,children:[e.jsx(_t,{className:"w-12 h-12 mx-auto mb-3 text-themed-muted"}),e.jsx("p",{className:"mb-2 text-themed-secondary",children:"Drag and drop a theme file here, or click to browse"}),e.jsx("p",{className:"text-xs mb-3 text-themed-muted",children:"TOML format, max 1MB"}),e.jsx("input",{ref:He,type:"file",accept:".toml",onChange:t=>{var a;return((a=t.target.files)==null?void 0:a[0])&&Ee(t.target.files[0])},className:"hidden"}),e.jsx(F,{variant:"filled",color:"purple",onClick:()=>{var t;return(t=He.current)==null?void 0:t.click()},disabled:r,loading:r,children:"Browse Files"})]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx(F,{variant:"subtle",leftSection:e.jsx(oe,{className:"w-4 h-4"}),onClick:Bt,children:"Download Sample TOML Theme"})})]}),!c&&e.jsx(U,{color:"yellow",children:"Authentication required to create, upload, or delete custom themes"}),P&&e.jsx(U,{color:"red",withCloseButton:!0,onClose:()=>b(null),children:P}),T&&e.jsx(U,{color:"green",withCloseButton:!0,onClose:()=>A(null),children:T})]}),e.jsx(xe,{opened:B,onClose:()=>{M(!1),je({})},title:"Create Custom Theme",size:"xl",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h4",{className:"text-sm font-semibold flex items-center gap-2 text-themed-primary",children:[e.jsx(Ke,{className:"w-4 h-4"}),"Theme Information"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1 text-themed-secondary",children:"Theme Name *"}),e.jsx("input",{type:"text",value:H.name,onChange:t=>J({...H,name:t.target.value}),placeholder:"My Custom Theme",className:"w-full px-3 py-2 focus:outline-none themed-input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1 text-themed-secondary",children:"Author"}),e.jsx("input",{type:"text",value:H.author,onChange:t=>J({...H,author:t.target.value}),placeholder:"Your Name",className:"w-full px-3 py-2 focus:outline-none themed-input"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1 text-themed-secondary",children:"Description"}),e.jsx("input",{type:"text",value:H.description,onChange:t=>J({...H,description:t.target.value}),placeholder:"A beautiful custom theme",className:"w-full px-3 py-2 rounded focus:outline-none themed-input"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:H.isDark,onChange:t=>J({...H,isDark:t.target.checked}),className:"rounded"}),e.jsx("span",{className:"text-sm text-themed-secondary",children:"Dark Theme"})]}),e.jsxs("button",{onClick:()=>ze("dark"),className:"px-3 py-1 text-xs rounded-lg flex items-center gap-1 bg-themed-tertiary text-themed-secondary",children:[e.jsx(qe,{className:"w-3 h-3"}),"Load Dark Preset"]}),e.jsxs("button",{onClick:()=>ze("light"),className:"px-3 py-1 text-xs rounded-lg flex items-center gap-1 bg-themed-tertiary text-themed-secondary",children:[e.jsx(Ye,{className:"w-3 h-3"}),"Load Light Preset"]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>W("category"),className:`flex-1 px-3 py-2 rounded-lg text-sm font-medium transition-all duration-200 ${Y==="category"?"bg-primary text-themed-button":"bg-themed-tertiary text-themed-secondary hover:bg-themed-hover"}`,children:[e.jsx(Be,{className:"w-4 h-4 inline-block mr-2"}),"By Category"]}),e.jsxs("button",{onClick:()=>W("page"),className:`flex-1 px-3 py-2 rounded-lg text-sm font-medium transition-all duration-200 ${Y==="page"?"bg-primary text-themed-button":"bg-themed-tertiary text-themed-secondary hover:bg-themed-hover"}`,children:[e.jsx(pe,{className:"w-4 h-4 inline-block mr-2"}),"By Page"]})]}),e.jsxs("div",{className:`transition-all duration-300 overflow-hidden ${Y==="page"?"max-h-40 opacity-100 mt-4":"max-h-0 opacity-0"}`,children:[e.jsx("label",{className:"block text-sm font-medium text-themed-primary mb-2",children:"Select Page"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:Le.map(t=>{const a=t.icon;return e.jsxs("button",{onClick:()=>it(t.name),className:`px-3 py-2 rounded-lg text-sm font-medium transition-all duration-200 flex items-center gap-2 ${ye===t.name?"bg-primary":"bg-themed-tertiary text-themed-secondary hover:bg-themed-hover"}`,style:{color:ye===t.name?"var(--theme-button-text)":void 0},title:t.description,children:[e.jsx(a,{className:"w-4 h-4"}),t.label]},t.name)})})]}),e.jsxs("div",{className:"relative mt-4",children:[e.jsx(Ve,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-themed-muted"}),e.jsx("input",{type:"text",value:f,onChange:t=>D(t.target.value),placeholder:"Search colors... (e.g., 'alert', 'header', 'button', 'background')",className:"w-full pl-10 pr-10 py-2 themed-input"}),f&&e.jsx("button",{onClick:()=>D(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-themed-muted hover:text-themed-primary",children:e.jsx(Pe,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"space-y-4 max-h-96 overflow-y-auto",children:_e(Re,f).map(t=>{const a=t.icon,u=z.includes(t.name)||f.trim()!=="";return e.jsxs("div",{className:"border themed-card rounded-lg",children:[e.jsxs("button",{onClick:()=>Fe(t.name),className:"w-full px-4 py-3 flex items-center justify-between hover:bg-opacity-50",style:{backgroundColor:u?"var(--theme-bg-tertiary)":"transparent"},children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(a,{className:"w-4 h-4 text-themed-accent"}),e.jsxs("div",{className:"text-left",children:[e.jsx("h5",{className:"text-sm font-semibold capitalize text-themed-primary",children:t.name.replace(/([A-Z])/g," $1").trim()}),e.jsx("p",{className:"text-xs text-themed-muted",children:t.description})]})]}),u?e.jsx(Je,{className:"w-4 h-4"}):e.jsx(Qe,{className:"w-4 h-4"})]}),u&&e.jsx("div",{className:"p-4 border-t themed-card space-y-4",children:t.colors.map(o=>e.jsx("div",{className:"space-y-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-themed-primary",children:o.label}),e.jsx("p",{className:"text-xs text-themed-muted",children:o.description}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:o.affects.map((k,w)=>e.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded",style:{backgroundColor:"var(--theme-bg-hover)",color:"var(--theme-text-secondary)"},children:k},w))})]}),e.jsx("div",{className:"flex items-center gap-2",children:(()=>{const k=getComputedStyle(document.documentElement),$={primaryColor:"--theme-primary",secondaryColor:"--theme-secondary",accentColor:"--theme-accent",bgPrimary:"--theme-bg-primary",bgSecondary:"--theme-bg-secondary",bgTertiary:"--theme-bg-tertiary",bgHover:"--theme-bg-hover",textPrimary:"--theme-text-primary",textSecondary:"--theme-text-secondary",textMuted:"--theme-text-muted",textAccent:"--theme-text-accent",borderPrimary:"--theme-border-primary",borderSecondary:"--theme-border-secondary",borderFocus:"--theme-border-focus",success:"--theme-success",warning:"--theme-warning",error:"--theme-error",info:"--theme-info",buttonBg:"--theme-button-bg",buttonHover:"--theme-button-hover",inputBg:"--theme-input-bg",inputBorder:"--theme-input-border",inputFocus:"--theme-input-focus",checkboxAccent:"--theme-checkbox-accent",checkboxBorder:"--theme-checkbox-border",sliderAccent:"--theme-slider-accent",sliderThumb:"--theme-slider-thumb",sliderTrack:"--theme-slider-track",cardBg:"--theme-card-bg",cardBorder:"--theme-card-border",badgeBg:"--theme-badge-bg",progressBar:"--theme-progress-bar",iconBgBlue:"--theme-icon-bg-blue",iconBgGreen:"--theme-icon-bg-green",iconBgPurple:"--theme-icon-bg-purple",chartColor1:"--theme-chart-color-1",chartColor2:"--theme-chart-color-2",chartColor3:"--theme-chart-color-3",chartColor4:"--theme-chart-color-4",chartColor5:"--theme-chart-color-5",chartColor6:"--theme-chart-color-6"}[o.key]||`--theme-${o.key.replace(/([A-Z])/g,"-$1").toLowerCase()}`,E=k.getPropertyValue($).trim()||"#3b82f6",{hex:ue,alpha:Ne}=de(H[o.key]||E);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"relative",children:e.jsx("input",{type:"color",value:ue,onMouseDown:()=>Ce(o.key),onFocus:()=>Ce(o.key),onChange:ae=>{const Te=de(H[o.key]||E).alpha;me(o.key,ae.target.value,Te,!0)},className:"w-12 h-8 rounded cursor-pointer",style:{backgroundColor:H[o.key]||E}})}),o.supportsAlpha&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ze,{className:"w-3 h-3 text-themed-muted"}),e.jsx("input",{type:"range",min:"0",max:"100",value:Math.round(Ne*100),onChange:ae=>{const Te=parseInt(ae.target.value)/100;me(o.key,ue,Te,!0)},className:"w-16",title:`Opacity: ${Math.round(Ne*100)}%`}),e.jsxs("span",{className:"text-xs text-themed-muted w-8",children:[Math.round(Ne*100),"%"]})]}),e.jsx("input",{type:"text",value:H[o.key]||E,onFocus:()=>Ce(o.key),onChange:ae=>gt(o.key,ae.target.value),className:"w-24 px-2 py-1 text-xs rounded font-mono themed-input"}),e.jsx("button",{onClick:()=>Oe(H[o.key]||E),className:"p-1 rounded-lg hover:bg-opacity-50 bg-themed-hover",title:"Copy color",children:N===(H[o.key]||E)?e.jsx(Se,{className:"w-3 h-3",style:{color:"var(--theme-success)"}}):e.jsx(ge,{className:"w-3 h-3 text-themed-muted"})}),De(o.key)&&e.jsx("button",{onClick:()=>bt(o.key),className:"p-1 rounded-lg hover:bg-opacity-50 bg-themed-hover",title:`Restore previous color: ${De(o.key)}`,children:e.jsx(Xe,{className:"w-3 h-3 text-themed-muted"})})]})})()})]})},o.key))})]},t.name)})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1 text-themed-secondary",children:"Custom CSS (Optional)"}),e.jsx("textarea",{value:H.customCSS,onChange:t=>J({...H,customCSS:t.target.value}),placeholder:"/* Add any custom CSS here */",rows:4,className:"w-full px-3 py-2 rounded font-mono text-xs focus:outline-none themed-input"})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t",style:{borderColor:"var(--theme-border-primary)"},children:[e.jsx(F,{variant:"default",onClick:()=>M(!1),children:"Cancel"}),e.jsx(F,{variant:"filled",leftSection:e.jsx(et,{className:"w-4 h-4"}),onClick:Tt,disabled:!H.name||!c,className:"themed-button-primary",children:"Create Theme"})]})]})}),e.jsx(xe,{opened:K,onClose:()=>{I(!1),L(null),V({}),C({})},title:`Edit Theme: ${(v==null?void 0:v.meta.name)||""}`,size:"xl",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h4",{className:"text-sm font-semibold flex items-center gap-2 text-themed-primary",children:[e.jsx(Ke,{className:"w-4 h-4"}),"Theme Information"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1 text-themed-secondary",children:"Theme Name *"}),e.jsx("input",{type:"text",value:_.name||"",onChange:t=>V({..._,name:t.target.value}),placeholder:"My Custom Theme",className:"w-full px-3 py-2 focus:outline-none themed-input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1 text-themed-secondary",children:"Author"}),e.jsx("input",{type:"text",value:_.author||"",onChange:t=>V({..._,author:t.target.value}),placeholder:"Your Name",className:"w-full px-3 py-2 focus:outline-none themed-input"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1 text-themed-secondary",children:"Description"}),e.jsx("input",{type:"text",value:_.description||"",onChange:t=>V({..._,description:t.target.value}),placeholder:"A beautiful custom theme",className:"w-full px-3 py-2 rounded focus:outline-none themed-input"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:_.isDark||!1,onChange:t=>V({..._,isDark:t.target.checked}),className:"rounded"}),e.jsx("span",{className:"text-sm text-themed-secondary",children:"Dark Theme"})]}),e.jsxs("span",{className:"text-xs text-themed-muted",children:["Theme ID: ",v==null?void 0:v.meta.id]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>Ie("category"),className:`flex-1 px-3 py-2 rounded-lg text-sm font-medium transition-all duration-200 ${ie==="category"?"bg-primary text-themed-button":"bg-themed-tertiary text-themed-secondary hover:bg-themed-hover"}`,children:[e.jsx(Be,{className:"w-4 h-4 inline-block mr-2"}),"By Category"]}),e.jsxs("button",{onClick:()=>Ie("page"),className:`flex-1 px-3 py-2 rounded-lg text-sm font-medium transition-all duration-200 ${ie==="page"?"bg-primary text-themed-button":"bg-themed-tertiary text-themed-secondary hover:bg-themed-hover"}`,children:[e.jsx(pe,{className:"w-4 h-4 inline-block mr-2"}),"By Page"]})]}),e.jsxs("div",{className:`transition-all duration-300 overflow-hidden ${ie==="page"?"max-h-40 opacity-100 mt-4":"max-h-0 opacity-0"}`,children:[e.jsx("label",{className:"block text-sm font-medium text-themed-primary mb-2",children:"Select Page"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:Le.map(t=>{const a=t.icon;return e.jsxs("button",{onClick:()=>dt(t.name),className:`px-3 py-2 rounded-lg text-sm font-medium transition-all duration-200 flex items-center gap-2 ${ve===t.name?"bg-primary":"bg-themed-tertiary text-themed-secondary hover:bg-themed-hover"}`,style:{color:ve===t.name?"var(--theme-button-text)":void 0},title:t.description,children:[e.jsx(a,{className:"w-4 h-4"}),t.label]},t.name)})})]}),e.jsxs("div",{className:"relative mt-4",children:[e.jsx(Ve,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-themed-muted"}),e.jsx("input",{type:"text",value:S,onChange:t=>R(t.target.value),placeholder:"Search colors... (e.g., 'alert', 'header', 'button', 'background')",className:"w-full pl-10 pr-10 py-2 themed-input"}),S&&e.jsx("button",{onClick:()=>R(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-themed-muted hover:text-themed-primary",children:e.jsx(Pe,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"space-y-4 max-h-96 overflow-y-auto",children:_e(Re,S,!0).map(t=>{const a=t.icon,u=z.includes(t.name)||S.trim()!=="";return e.jsxs("div",{className:"border themed-card rounded-lg",children:[e.jsxs("button",{onClick:()=>Fe(t.name),className:"w-full px-4 py-3 flex items-center justify-between hover:bg-opacity-50",style:{backgroundColor:u?"var(--theme-bg-tertiary)":"transparent"},children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(a,{className:"w-4 h-4 text-themed-accent"}),e.jsxs("div",{className:"text-left",children:[e.jsx("h5",{className:"text-sm font-semibold capitalize text-themed-primary",children:t.name.replace(/([A-Z])/g," $1").trim()}),e.jsx("p",{className:"text-xs text-themed-muted",children:t.description})]})]}),u?e.jsx(Je,{className:"w-4 h-4"}):e.jsx(Qe,{className:"w-4 h-4"})]}),u&&e.jsx("div",{className:"p-4 border-t themed-card space-y-4",children:t.colors.map(o=>e.jsx("div",{className:"space-y-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-themed-primary",children:o.label}),e.jsx("p",{className:"text-xs text-themed-muted",children:o.description}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:o.affects.map((k,w)=>e.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded",style:{backgroundColor:"var(--theme-bg-hover)",color:"var(--theme-text-secondary)"},children:k},w))})]}),e.jsx("div",{className:"flex items-center gap-2",children:(()=>{const{hex:k,alpha:w}=de(_[o.key]||"#000000");return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"relative",children:e.jsx("input",{type:"color",value:k,onMouseDown:()=>we(o.key),onFocus:()=>we(o.key),onChange:$=>{const E=de(_[o.key]||"#000000").alpha;me(o.key,$.target.value,E,!1)},className:"w-12 h-8 rounded cursor-pointer",style:{backgroundColor:_[o.key]||"#000000"}})}),o.supportsAlpha&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ze,{className:"w-3 h-3 text-themed-muted"}),e.jsx("input",{type:"range",min:"0",max:"100",value:Math.round(w*100),onChange:$=>{const E=parseInt($.target.value)/100;me(o.key,k,E,!1)},className:"w-16",title:`Opacity: ${Math.round(w*100)}%`}),e.jsxs("span",{className:"text-xs text-themed-muted w-8",children:[Math.round(w*100),"%"]})]}),e.jsx("input",{type:"text",value:_[o.key]||"",onFocus:()=>we(o.key),onChange:$=>xt(o.key,$.target.value),className:"w-24 px-2 py-1 text-xs rounded font-mono themed-input",placeholder:o.key}),e.jsx("button",{onClick:()=>Oe(_[o.key]||""),className:"p-1 rounded-lg hover:bg-opacity-50 bg-themed-hover",title:"Copy color",children:N===_[o.key]?e.jsx(Se,{className:"w-3 h-3",style:{color:"var(--theme-success)"}}):e.jsx(ge,{className:"w-3 h-3 text-themed-muted"})}),(()=>{const $=vt(o.key);return $?e.jsx("button",{onClick:()=>yt(o.key),className:"p-1 rounded-lg hover:bg-opacity-50 bg-themed-hover",title:`Restore previous color: ${$}`,children:e.jsx(Xe,{className:"w-3 h-3 text-themed-muted"})}):null})()]})})()})]})},o.key))})]},t.name)})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1 text-themed-secondary",children:"Custom CSS (Optional)"}),e.jsx("textarea",{value:_.customCSS||"",onChange:t=>V({..._,customCSS:t.target.value}),placeholder:"/* Add any custom CSS here */",rows:4,className:"w-full px-3 py-2 rounded font-mono text-xs focus:outline-none themed-input"})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t",style:{borderColor:"var(--theme-border-primary)"},children:[e.jsx(F,{variant:"default",onClick:()=>{I(!1),L(null),V({})},children:"Cancel"}),e.jsx(F,{variant:"filled",leftSection:e.jsx(et,{className:"w-4 h-4"}),onClick:Nt,disabled:!_.name||!c||r,className:"themed-button-primary",children:"Save Changes"})]})]})})]})},ca=({alerts:c,onClearError:y,onClearSuccess:s})=>{var d,p;return!c||!((d=c.errors)!=null&&d.length)&&!c.success?null:e.jsxs("div",{className:"space-y-4",children:[(p=c.errors)==null?void 0:p.map(r=>e.jsx(U,{color:"red",icon:e.jsx(le,{className:"w-5 h-5"}),withCloseButton:!0,onClose:()=>y(r.id),children:r.message},r.id)),c.success&&e.jsx(U,{color:"green",icon:e.jsx(ne,{className:"w-5 h-5"}),withCloseButton:!!s,onClose:s,children:c.success})]})},at=[{type:"clients",label:"Client Statistics",description:"Export client usage data including bandwidth and cache hits",formats:["json","csv","prometheus"],icon:be},{type:"services",label:"Service Statistics",description:"Export service-level metrics (Steam, Epic, etc.)",formats:["json","csv","prometheus","influxdb"],icon:$e},{type:"cache",label:"Cache Information",description:"Export current cache usage and storage metrics",formats:["json","prometheus"],icon:be},{type:"dashboard",label:"Dashboard Statistics",description:"Export aggregated dashboard metrics",formats:["json","prometheus","influxdb"],icon:Yt},{type:"downloads",label:"Download History",description:"Export recent download history (last 1000 entries)",formats:["json","csv"],icon:Kt}],na=({isAuthenticated:c,mockMode:y,onError:s,onSuccess:d})=>{var N;const[p,r]=h.useState(!1),[l,j]=h.useState(null),[g,P]=h.useState("json"),[b,T]=h.useState({}),[A,x]=h.useState(null),[m,B]=h.useState(null);h.useEffect(()=>{fetch("/api/metrics/status").then(i=>i.json()).then(i=>B(i.requiresAuthentication)).catch(()=>B(!1))},[]);const M=i=>{if(!i||i.length===0)return"";const n=Object.keys(i[0]),C=n.join(","),f=i.map(D=>n.map(S=>{const R=D[S];return R==null?"":typeof R=="string"&&R.includes(",")?`"${R.replace(/"/g,'""')}"`:R}).join(","));return[C,...f].join(`
`)},K=(i,n)=>{const C=Date.now();let f=[];switch(n){case"clients":i.forEach(W=>{f.push("# HELP lancache_client_cache_hit_bytes Total cache hit bytes for client"),f.push("# TYPE lancache_client_cache_hit_bytes counter"),f.push(`lancache_client_cache_hit_bytes{client="${W.clientIp}"} ${W.totalCacheHitBytes} ${C}`),f.push(`lancache_client_cache_miss_bytes{client="${W.clientIp}"} ${W.totalCacheMissBytes} ${C}`),f.push(`lancache_client_download_count{client="${W.clientIp}"} ${W.totalDownloads} ${C}`)});break;case"services":i.forEach(W=>{f.push("# HELP lancache_service_cache_hit_bytes Total cache hit bytes for service"),f.push("# TYPE lancache_service_cache_hit_bytes counter"),f.push(`lancache_service_cache_hit_bytes{service="${W.service}"} ${W.totalCacheHitBytes} ${C}`),f.push(`lancache_service_cache_miss_bytes{service="${W.service}"} ${W.totalCacheMissBytes} ${C}`),f.push(`lancache_service_download_count{service="${W.service}"} ${W.totalDownloads} ${C}`),f.push(`lancache_service_hit_ratio{service="${W.service}"} ${W.cacheHitPercent/100} ${C}`)});break;case"cache":const R=i;f.push("# HELP lancache_cache_total_bytes Total cache size in bytes"),f.push("# TYPE lancache_cache_total_bytes gauge"),f.push(`lancache_cache_total_bytes ${R.totalCacheSize} ${C}`),f.push(`lancache_cache_used_bytes ${R.usedCacheSize} ${C}`),f.push(`lancache_cache_free_bytes ${R.freeCacheSize} ${C}`),f.push(`lancache_cache_usage_percent ${R.usagePercent/100} ${C}`),f.push(`lancache_cache_file_count ${R.totalFiles} ${C}`);break;case"dashboard":const Y=i;f.push("# HELP lancache_bandwidth_saved_bytes Total bandwidth saved"),f.push("# TYPE lancache_bandwidth_saved_bytes counter"),f.push(`lancache_bandwidth_saved_bytes ${Y.totalBandwidthSaved} ${C}`),f.push(`lancache_cache_added_bytes ${Y.totalAddedToCache} ${C}`),f.push(`lancache_served_bytes ${Y.totalServed} ${C}`),f.push(`lancache_hit_ratio ${Y.cacheHitRatio/100} ${C}`),f.push(`lancache_active_downloads ${Y.activeDownloads} ${C}`),f.push(`lancache_unique_clients ${Y.uniqueClients} ${C}`);break}return f.join(`
`)},I=(i,n)=>{const C=Date.now()*1e6;let f=[];switch(n){case"services":i.forEach(R=>{f.push(`lancache,service=${R.service} cache_hit_bytes=${R.totalCacheHitBytes}i,cache_miss_bytes=${R.totalCacheMissBytes}i,total_downloads=${R.totalDownloads}i,hit_ratio=${R.cacheHitPercent/100} ${C}`)});break;case"dashboard":const S=i;f.push(`lancache_stats bandwidth_saved=${S.totalBandwidthSaved}i,cache_added=${S.totalAddedToCache}i,total_served=${S.totalServed}i,hit_ratio=${S.cacheHitRatio/100},active_downloads=${S.activeDownloads}i,unique_clients=${S.uniqueClients}i ${C}`);break}return f.join(`
`)},v=i=>{let n=0;const C=setInterval(()=>{n+=Math.random()*30,n>=95&&(n=95,clearInterval(C)),T(f=>({...f,[i]:n}))},200);return C},L=async()=>{if(!l){s==null||s("Please select data to export");return}r(!0),T({[l]:0});const i=v(l);try{let n,C,f,D;switch(l){case"clients":n=await O.getClientStats();break;case"services":n=await O.getServiceStats();break;case"cache":n=await O.getCacheInfo();break;case"dashboard":n=await O.getDashboardStats();break;case"downloads":n=await O.getLatestDownloads(void 0,1e3);break}switch(g){case"csv":D=M(Array.isArray(n)?n:[n]),f="text/csv",C=`lancache_${l}_${new Date().toISOString().split("T")[0]}.csv`;break;case"prometheus":D=K(n,l),f="text/plain",C=`lancache_${l}_metrics.txt`;break;case"influxdb":D=I(n,l),f="text/plain",C=`lancache_${l}_influx.txt`;break;case"json":default:D=JSON.stringify(n,null,2),f="application/json",C=`lancache_${l}_${new Date().toISOString().split("T")[0]}.json`;break}const S=new Blob([D],{type:f}),R=URL.createObjectURL(S),Y=document.createElement("a");Y.href=R,Y.download=C,document.body.appendChild(Y),Y.click(),document.body.removeChild(Y),URL.revokeObjectURL(R),clearInterval(i),T({[l]:100}),setTimeout(()=>T({}),500),d==null||d(`Exported ${l} data as ${g.toUpperCase()}`)}catch(n){clearInterval(i),T({}),s==null||s(n.message||"Failed to export data")}finally{r(!1)}},z=(i,n)=>{navigator.clipboard.writeText(i),x(n),setTimeout(()=>x(null),2e3)},G=window.location.origin;return e.jsxs("div",{className:"space-y-4",children:[e.jsxs(Z,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(qt,{className:"w-5 h-5 text-themed-accent"}),e.jsx("h3",{className:"text-lg font-semibold text-themed-primary",children:"Live API Endpoints for Grafana"})]}),m!==null&&e.jsx("div",{className:`flex items-center space-x-1 px-3 py-1 rounded-full text-xs font-medium border ${m?"access-indicator-secured":"access-indicator-public"}`,children:m?e.jsxs(e.Fragment,{children:[e.jsx(ce,{className:"w-3 h-3"}),e.jsx("span",{children:"API Key Required"})]}):e.jsxs(e.Fragment,{children:[e.jsx(st,{className:"w-3 h-3"}),e.jsx("span",{children:"Public Access"})]})})]}),e.jsx("p",{className:"text-themed-muted text-sm mb-4",children:m?"These endpoints provide real-time metrics with API key authentication. Configure your API key in Grafana or Prometheus.":"These endpoints provide real-time metrics without authentication. Use them directly in Grafana or Prometheus."}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"p-3 rounded-lg border themed-card",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-sm font-medium text-themed-primary",children:"Prometheus Metrics"}),e.jsx(F,{size:"xs",variant:"default",onClick:()=>z(`${G}/api/metrics`,"prometheus"),leftSection:A==="prometheus"?e.jsx(ne,{className:"w-3 h-3"}):e.jsx(ge,{className:"w-3 h-3"}),children:A==="prometheus"?"Copied!":"Copy"})]}),e.jsxs("code",{className:"text-xs text-themed-muted block break-all",children:[G,"/api/metrics"]}),e.jsx("p",{className:"text-xs text-themed-muted mt-1",children:"OpenMetrics format for Prometheus scraping"})]}),e.jsxs("div",{className:"p-3 rounded-lg border themed-card",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-sm font-medium text-themed-primary",children:"JSON Metrics"}),e.jsx(F,{size:"xs",variant:"default",onClick:()=>z(`${G}/api/metrics/json`,"json-api"),leftSection:A==="json-api"?e.jsx(ne,{className:"w-3 h-3"}):e.jsx(ge,{className:"w-3 h-3"}),children:A==="json-api"?"Copied!":"Copy"})]}),e.jsxs("code",{className:"text-xs text-themed-muted block break-all",children:[G,"/api/metrics/json"]}),e.jsx("p",{className:"text-xs text-themed-muted mt-1",children:"JSON format for direct Grafana integration"})]})]}),e.jsx("div",{className:"mt-4",children:e.jsx(U,{color:"blue",children:e.jsxs("p",{className:"text-sm",children:[e.jsx("strong",{children:"Security Options:"})," By default, these endpoints are public. To require API key authentication, set ",e.jsx("code",{children:"RequireAuthForMetrics: true"})," in your config. Then add header ",e.jsx("code",{children:"X-Api-Key: your-key"})," to Grafana/Prometheus."]})})}),e.jsx("div",{className:"mt-2",children:e.jsx(U,{color:"green",children:e.jsxs("p",{className:"text-sm",children:[e.jsx("strong",{children:"Live Updates:"})," Configure Grafana to poll every 10-30 seconds for real-time monitoring. Works with both Prometheus and JSON datasource plugins."]})})})]}),e.jsxs(Z,{children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(oe,{className:"w-5 h-5 text-themed-accent"}),e.jsx("h3",{className:"text-lg font-semibold text-themed-primary",children:"Data Export"})]}),e.jsx("p",{className:"text-themed-muted text-sm mb-4",children:"Export cache statistics in various formats for analysis and monitoring"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-themed-primary mb-2",children:"Select Data Type"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:at.map(i=>{const n=i.icon;return e.jsxs("button",{onClick:()=>{j(i.type),i.formats.includes(g)||P(i.formats[0])},className:`p-3 rounded-lg border-2 transition-all text-left relative overflow-hidden themed-card ${l===i.type?"bg-themed-tertiary":"hover:bg-themed-hover"}`,style:{borderColor:l===i.type?"var(--theme-primary)":"var(--theme-card-border)"},children:[e.jsxs("div",{className:"flex items-start space-x-3 relative z-10",children:[e.jsx(n,{className:"w-5 h-5 text-themed-accent mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-themed-primary",children:i.label}),e.jsx("div",{className:"text-xs text-themed-muted mt-1",children:i.description})]})]}),b[i.type]!==void 0&&e.jsx("div",{className:"absolute bottom-0 left-0 w-full h-1 bg-themed-secondary",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-blue-500 to-blue-400 transition-all duration-300",style:{width:`${b[i.type]}%`}})})]},i.type)})})]}),l&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-themed-primary mb-2",children:"Export Format"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:(N=at.find(i=>i.type===l))==null?void 0:N.formats.map(i=>e.jsx(F,{onClick:()=>P(i),variant:g===i?"filled":"default",color:"blue",size:"sm",children:i.toUpperCase()},i))})]}),l&&g&&e.jsx(U,{color:"blue",children:e.jsxs("div",{className:"text-sm",children:[g==="prometheus"&&e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:"Prometheus Format:"})," Metrics in OpenMetrics text format. Can be scraped by Prometheus or imported into Grafana."]}),g==="influxdb"&&e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:"InfluxDB Format:"})," Line protocol format for direct import into InfluxDB or Telegraf."]}),g==="csv"&&e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:"CSV Format:"})," Comma-separated values for spreadsheet applications or data analysis tools."]}),g==="json"&&e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:"JSON Format:"})," Structured data for programmatic processing or custom visualizations."]})]})}),e.jsx(F,{onClick:L,disabled:!l||p,loading:p,variant:"filled",color:"green",leftSection:e.jsx(oe,{className:"w-4 h-4"}),fullWidth:!0,children:"Export Data"})]})]})]})},la=({mockMode:c,onToggle:y,disabled:s})=>e.jsxs(Z,{children:[e.jsx("h3",{className:"text-lg font-semibold text-themed-primary mb-4",children:"Mock Mode"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-themed-secondary",children:"Enable mock data for demonstration"}),e.jsx("p",{className:"text-sm text-themed-muted mt-1",children:"Simulates realistic cache data and download activity"})]}),e.jsx(F,{onClick:y,disabled:s,variant:"filled",color:"blue",leftSection:c?e.jsx(Vt,{className:"w-5 h-5"}):e.jsx(Jt,{className:"w-5 h-5"}),children:c?"Enabled":"Disabled"})]}),c&&e.jsx("div",{className:"mt-4",children:e.jsx(U,{color:"blue",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(le,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Mock mode active - API actions disabled"})]})})})]}),ia=({isAuthenticated:c,mockMode:y,onError:s,onSuccess:d,onDataRefresh:p})=>{const[r,l]=h.useState(!1),j=async()=>{if(!c){s==null||s("Authentication required");return}if(window.confirm("Delete all download history?")){l(!0);try{const g=await O.resetDatabase();g&&(d==null||d(g.message||"Database reset successfully"),setTimeout(()=>p==null?void 0:p(),2e3))}catch(g){s==null||s(g.message||"Failed to reset database")}finally{l(!1)}}};return e.jsxs(Z,{children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(be,{className:"w-5 h-5 text-themed-accent"}),e.jsx("h3",{className:"text-lg font-semibold text-themed-primary",children:"Database Management"})]}),e.jsx("p",{className:"text-themed-muted text-sm mb-4",children:"Manage download history and statistics"}),e.jsx(F,{onClick:j,disabled:r||y||!c,loading:r,variant:"filled",color:"red",leftSection:e.jsx(be,{className:"w-4 h-4"}),fullWidth:!0,children:"Reset Database"}),e.jsx("p",{className:"text-xs text-themed-muted mt-2",children:"Clears all download history (does not affect cached files)"})]})},da=({isAuthenticated:c,mockMode:y,onError:s,onSuccess:d,onDataRefresh:p,onBackgroundOperation:r})=>{const[l,j]=h.useState({}),[g,P]=h.useState({logPath:"/logs/access.log",services:[]}),[b,T]=h.useState(null),[A,x]=h.useState(!0),m=Me("activeServiceRemoval","serviceRemoval",30);h.useEffect(()=>{B(),M()},[]),h.useEffect(()=>{r==null||r(b)},[b,r]);const B=async()=>{try{const[v,L]=await Promise.all([O.getConfig(),O.getServiceLogCounts()]);P(v),j(L)}catch(v){console.error("Failed to load config:",v),P({logPath:"/logs/access.log",services:["steam","epic","origin","blizzard","wsus","riot"]})}finally{x(!1)}},M=async()=>{var L;const v=await m.load();(L=v==null?void 0:v.data)!=null&&L.service&&(T(v.data.service),d==null||d(`Removing ${v.data.service} entries from logs (operation resumed)...`),setTimeout(async()=>{await m.clear(),T(null);try{const[z,G]=await Promise.all([O.getConfig(),O.getServiceLogCounts()]);P(z),j(G)}catch(z){console.error("Failed to reload config:",z)}p==null||p()},1e4))},K=async v=>{var L;if(!c){s==null||s("Authentication required");return}if(window.confirm(`Remove all ${v} entries?`))try{T(v),await m.save({service:v});const z=await O.removeServiceFromLogs(v);z&&(d==null||d(z.message||`${v} entries removed successfully`)),await m.clear(),setTimeout(async()=>{T(null);try{const[G,N]=await Promise.all([O.getConfig(),O.getServiceLogCounts()]);P(G),j(N)}catch(G){console.error("Failed to reload config:",G)}p==null||p()},2e3)}catch(z){await m.clear(),T(null);const G=(L=z.message)!=null&&L.includes("read-only")?"Logs directory is read-only. Remove :ro from docker-compose volume mount.":z.message||"Action failed";s==null||s(G)}},I=g.services.length>0?g.services:[];return e.jsxs(Z,{children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(ct,{className:"w-5 h-5 text-themed-accent"}),e.jsx("h3",{className:"text-lg font-semibold text-themed-primary",children:"Log File Management"})]}),e.jsxs("p",{className:"text-themed-muted text-sm mb-4",children:["Remove service entries from"," ",e.jsx("code",{className:"bg-themed-tertiary px-2 py-1 rounded",children:g.logPath})]}),A?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(re,{className:"w-6 h-6 animate-spin text-themed-muted"})}):I.length>0?e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3",children:I.map(v=>{const L=b===v;return e.jsx(F,{onClick:()=>K(v),disabled:y||!!b||m.loading||!c,variant:"default",loading:L||m.loading,className:"flex flex-col items-center",fullWidth:!0,children:!L&&!m.loading?e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"capitalize font-medium",children:["Clear ",v]}),l[v]!==void 0&&e.jsxs("span",{className:"text-xs text-themed-muted mt-1",children:["(",l[v].toLocaleString()," entries)"]})]}):e.jsx("span",{className:"capitalize font-medium",children:"Removing..."})},v)})}):e.jsx("div",{className:"text-center py-8 text-themed-muted",children:"No services configured"}),e.jsx("div",{className:"mt-4",children:e.jsx(U,{color:"yellow",children:e.jsxs("p",{className:"text-xs",children:[e.jsx("strong",{children:"Warning:"})," Requires write permissions to logs directory"]})})})]})},xa=()=>{const{mockMode:c,setMockMode:y,fetchData:s}=Qt(),[d,p]=h.useState(!1),[r,l]=h.useState({errors:[],success:null}),[j,g]=h.useState({}),P=h.useRef(!1),b=h.useCallback(m=>{l(B=>({...B,errors:[...B.errors,{id:Date.now(),message:m}]}))},[]),T=h.useCallback(m=>{l(B=>({...B,success:m})),setTimeout(()=>l(B=>({...B,success:null})),1e4)},[]),A=h.useCallback(m=>{l(B=>({...B,errors:B.errors.filter(M=>M.id!==m)}))},[]),x=h.useCallback(()=>{l(m=>({...m,success:null}))},[]);return h.useEffect(()=>{(async()=>{if(!P.current){const B=await se.migrateFromLocalStorage();B>0&&T(`Migrated ${B} operations from local storage to server`),P.current=!0}})()},[T]),e.jsxs("div",{className:"space-y-6",children:[e.jsx(aa,{onAuthChange:p,onError:b,onSuccess:T}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(ca,{alerts:r,onClearError:A,onClearSuccess:x}),j.cacheClearing&&e.jsx(U,{color:"blue",icon:e.jsx(re,{className:"w-5 h-5 animate-spin"}),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium",children:"Cache clearing in progress..."}),j.cacheClearing.bytesDeleted>0&&e.jsxs("p",{className:"text-sm mt-1 opacity-75",children:[fe(j.cacheClearing.bytesDeleted)," cleared"]}),e.jsxs("p",{className:"text-sm mt-1 opacity-75",children:[(j.cacheClearing.progress||0).toFixed(0),"% complete"]})]}),e.jsx(F,{variant:"filled",color:"blue",size:"sm",leftSection:e.jsx(lt,{className:"w-4 h-4"}),onClick:j.cacheClearing.showModal,children:"View Details"})]})}),j.logProcessing&&e.jsx(U,{color:j.logProcessing.status==="complete"?"green":"yellow",icon:j.logProcessing.status==="complete"?e.jsx(ne,{className:"w-5 h-5"}):e.jsx(re,{className:"w-5 h-5 animate-spin"}),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium",children:j.logProcessing.message}),j.logProcessing.detailMessage&&e.jsx("p",{className:"text-sm mt-1 opacity-75",children:j.logProcessing.detailMessage}),j.logProcessing.progress>0&&j.logProcessing.status!=="complete"&&e.jsxs("div",{className:"mt-2",children:[e.jsx("div",{className:"w-full progress-track rounded-full h-2",children:e.jsx("div",{className:"progress-bar-low h-2 rounded-full smooth-transition",style:{width:`${Math.min(j.logProcessing.progress,100)}%`}})}),e.jsxs("p",{className:"text-xs opacity-75 mt-1",children:[j.logProcessing.progress.toFixed(1),"% complete",j.logProcessing.estimatedTime&&` • ${j.logProcessing.estimatedTime} remaining`]})]})]}),j.logProcessing.status!=="complete"&&j.logProcessing.onCancel&&e.jsx(F,{variant:"filled",color:"red",size:"sm",leftSection:e.jsx(ot,{className:"w-4 h-4"}),onClick:j.logProcessing.onCancel,children:"Cancel"})]})}),j.serviceRemoval&&e.jsx(U,{color:"orange",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(re,{className:"w-5 h-5 animate-spin"}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium",children:["Removing ",j.serviceRemoval," entries from logs..."]}),e.jsx("p",{className:"text-sm mt-1",children:"This may take several minutes for large log files"})]})]})})]}),e.jsx(la,{mockMode:c,onToggle:()=>y(!c),disabled:!1}),e.jsx(ia,{isAuthenticated:d,mockMode:c,onError:b,onSuccess:T,onDataRefresh:s}),e.jsx(sa,{isAuthenticated:d,mockMode:c,onError:b,onSuccess:T,onBackgroundOperation:m=>g(B=>({...B,cacheClearing:m}))}),e.jsx(ra,{isAuthenticated:d,mockMode:c,onError:b,onSuccess:T,onDataRefresh:s,onBackgroundOperation:m=>g(B=>({...B,logProcessing:m}))}),e.jsx(da,{isAuthenticated:d,mockMode:c,onError:b,onSuccess:T,onDataRefresh:s,onBackgroundOperation:m=>g(B=>({...B,serviceRemoval:m}))}),e.jsx(na,{isAuthenticated:d,mockMode:c,onError:b,onSuccess:T}),e.jsx(oa,{isAuthenticated:d})]})};export{xa as default};
//# sourceMappingURL=ManagementTab-DAAfhpJC.js.map
