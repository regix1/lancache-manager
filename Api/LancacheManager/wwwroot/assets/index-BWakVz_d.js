const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Dashboard-BLfxoDu_.js","assets/react-vendor-BKkFPE2a.js","assets/vendor-BmYUbuLR.js","assets/Card-DwLTxh2g.js","assets/charts-B1PwCyAI.js","assets/Tooltip-B5wX8oSW.js","assets/DownloadsTab-CY6ro0Vv.js","assets/Alert-z41paNou.js","assets/ClientsTab-CB8NoBrc.js","assets/ServicesTab-ZMUVZn-w.js","assets/ManagementTab-CHYNHKQ0.js","assets/signalr-C7Jyn4vH.js"])))=>i.map(i=>d[i]);
var _e=Object.defineProperty;var Fe=(n,e,a)=>e in n?_e(n,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):n[e]=a;var ue=(n,e,a)=>Fe(n,typeof e!="symbol"?e+"":e,a);import{r as l,j as t,C as Be,X as Re,a as ze,b as je,c as Oe,L as ge,d as Ke,R as Ye,M as Ve,e as Ue,D as Me,U as We,S as Ge,f as qe,g as Pe,h as Je,i as Xe,T as Te,K as Qe,k as De,l as ke,m as Ze,n as et}from"./react-vendor-BKkFPE2a.js";import{t as tt}from"./vendor-BmYUbuLR.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function a(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(r){if(r.ep)return;r.ep=!0;const o=a(r);fetch(r.href,o)}})();const rt="modulepreload",at=function(n){return"/"+n},Ne={},pe=function(e,a,s){let r=Promise.resolve();if(a&&a.length>0){document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),g=(c==null?void 0:c.nonce)||(c==null?void 0:c.getAttribute("nonce"));r=Promise.allSettled(a.map(d=>{if(d=at(d),d in Ne)return;Ne[d]=!0;const b=d.endsWith(".css"),w=b?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${w}`))return;const i=document.createElement("link");if(i.rel=b?"stylesheet":rt,b||(i.as="script"),i.crossOrigin="",i.href=d,g&&i.setAttribute("nonce",g),document.head.appendChild(i),b)return new Promise((m,x)=>{i.addEventListener("load",m),i.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${d}`)))})}))}function o(c){const g=new Event("vite:preloadError",{cancelable:!0});if(g.payload=c,window.dispatchEvent(g),!g.defaultPrevented)throw c}return r.then(c=>{for(const g of c||[])g.status==="rejected"&&o(g.reason);return e().catch(o)})},I="/api",ne=["steam","epic","origin","blizzard","wsus","riot"],Nt=["B","KB","MB","GB","TB","PB"],It={DASHBOARD_CARD_ORDER:"lancache_dashboard_card_order",DASHBOARD_CARD_VISIBILITY:"lancache_dashboard_card_visibility"},ve={},st=()=>{if(!(typeof import.meta<"u"&&(ve!=null&&ve.VITE_API_URL)))return""},ye=st();class ot{constructor(){ue(this,"deviceId");ue(this,"isAuthenticated");ue(this,"authChecked");this.deviceId=this.getOrCreateDeviceId(),this.isAuthenticated=!1,this.authChecked=!1}getOrCreateDeviceId(){let e=localStorage.getItem("lancache_device_id");return e||(e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){const s=Math.random()*16|0;return(a==="x"?s:s&3|8).toString(16)}),localStorage.setItem("lancache_device_id",e)),e}async checkAuth(){try{const e=await fetch(`${ye}/api/auth/check`,{headers:{"X-Device-Id":this.deviceId}});if(e.ok){const a=await e.json();return this.isAuthenticated=a.isAuthenticated,this.authChecked=!0,a.requiresAuth&&!a.isAuthenticated&&a.authenticationType!=="device"&&(localStorage.removeItem("lancache_device_id"),this.deviceId=this.getOrCreateDeviceId()),a}return this.isAuthenticated=!1,this.authChecked=!0,{requiresAuth:!0,isAuthenticated:!1}}catch(e){return console.error("Auth check failed:",e),this.isAuthenticated=!1,this.authChecked=!0,{requiresAuth:!0,isAuthenticated:!1,error:e.message}}}async register(e,a=null){try{const s=await fetch(`${ye}/api/auth/register`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({deviceId:this.deviceId,apiKey:e,deviceName:a||this.getDeviceName()})}),r=await s.json();return s.ok&&r.success?(this.isAuthenticated=!0,localStorage.setItem("lancache_auth_registered","true"),{success:!0,message:r.message}):{success:!1,message:r.message||"Registration failed"}}catch(s){return console.error("Registration failed:",s),{success:!1,message:s.message||"Network error during registration"}}}async regenerateApiKey(){try{const e=await fetch(`${ye}/api/auth/regenerate-key`,{method:"POST",headers:{"Content-Type":"application/json","X-Device-Id":this.deviceId}}),a=await e.json();return e.ok&&a.success?(this.clearAuth(),this.isAuthenticated=!1,{success:!0,message:a.message,warning:a.warning}):{success:!1,message:a.message||"Failed to regenerate API key"}}catch(e){return console.error("Failed to regenerate API key:",e),{success:!1,message:e.message||"Network error while regenerating API key"}}}getDeviceName(){const e=navigator.userAgent;let a="Unknown OS",s="Unknown Browser";return e.indexOf("Win")!==-1?a="Windows":e.indexOf("Mac")!==-1?a="macOS":e.indexOf("Linux")!==-1?a="Linux":e.indexOf("Android")!==-1?a="Android":e.indexOf("iOS")!==-1&&(a="iOS"),e.indexOf("Chrome")!==-1?s="Chrome":e.indexOf("Safari")!==-1?s="Safari":e.indexOf("Firefox")!==-1?s="Firefox":e.indexOf("Edge")!==-1&&(s="Edge"),`${s} on ${a}`}getAuthHeaders(){return{"X-Device-Id":this.deviceId}}handleUnauthorized(){this.isAuthenticated=!1,localStorage.removeItem("lancache_auth_registered")}clearAuth(){this.isAuthenticated=!1,localStorage.removeItem("lancache_auth_registered")}isRegistered(){return localStorage.getItem("lancache_auth_registered")==="true"}}const K=new ot;class H{static async handleResponse(e){if(e.status===401){K.handleUnauthorized();const a=await e.text().catch(()=>"");throw new Error(`Authentication required: ${a||"Please provide API key"}`)}if(!e.ok){const a=await e.text().catch(()=>"");throw new Error(`HTTP ${e.status}: ${a||e.statusText}`)}return e.json()}static getHeaders(e={}){return{...K.getAuthHeaders(),...e}}static async getCacheInfo(e){try{const a=await fetch(`${I}/management/cache`,{signal:e,headers:this.getHeaders()});return await this.handleResponse(a)}catch(a){throw a.name==="AbortError"||console.error("getCacheInfo error:",a),a}}static async getActiveDownloads(e){try{const a=await fetch(`${I}/downloads/active`,{signal:e,headers:this.getHeaders()});return await this.handleResponse(a)}catch(a){throw a.name==="AbortError"||console.error("getActiveDownloads error:",a),a}}static async getLatestDownloads(e,a="unlimited",s,r){try{let c=`${I}/downloads/latest?count=${a==="unlimited"?9999:a}`;s&&(c+=`&startTime=${s}`),r&&(c+=`&endTime=${r}`);const g=await fetch(c,{signal:e,headers:this.getHeaders()});return await this.handleResponse(g)}catch(o){throw o.name==="AbortError"||console.error("getLatestDownloads error:",o),o}}static async getClientStats(e,a,s){try{let r=`${I}/stats/clients`;const o=new URLSearchParams;a&&o.append("startTime",a.toString()),s&&o.append("endTime",s.toString()),o.toString()&&(r+=`?${o}`);const c=await fetch(r,{signal:e,headers:this.getHeaders()});return await this.handleResponse(c)}catch(r){throw r.name==="AbortError"||console.error("getClientStats error:",r),r}}static async getServiceStats(e,a=null,s,r){try{let o=`${I}/stats/services`;const c=new URLSearchParams;a&&c.append("since",a),s&&c.append("startTime",s.toString()),r&&c.append("endTime",r.toString()),c.toString()&&(o+=`?${c}`);const g=await fetch(o,{signal:e,headers:this.getHeaders()});return await this.handleResponse(g)}catch(o){throw o.name==="AbortError"||console.error("getServiceStats error:",o),o}}static async getDashboardStats(e="24h",a){try{const s=await fetch(`${I}/stats/dashboard?period=${e}`,{signal:a,headers:this.getHeaders()});return await this.handleResponse(s)}catch(s){throw s.name==="AbortError"||console.error("getDashboardStats error:",s),s}}static async getCacheEffectiveness(e="24h",a){try{const s=await fetch(`${I}/stats/cache-effectiveness?period=${e}`,{signal:a,headers:this.getHeaders()});return await this.handleResponse(s)}catch(s){throw s.name==="AbortError"||console.error("getCacheEffectiveness error:",s),s}}static async getTimelineStats(e="24h",a="hourly",s){try{const r=await fetch(`${I}/stats/timeline?period=${e}&interval=${a}`,{signal:s,headers:this.getHeaders()});return await this.handleResponse(r)}catch(r){throw r.name==="AbortError"||console.error("getTimelineStats error:",r),r}}static async getBandwidthSaved(e="all",a){try{const s=await fetch(`${I}/stats/bandwidth-saved?period=${e}`,{signal:a,headers:this.getHeaders()});return await this.handleResponse(s)}catch(s){throw s.name==="AbortError"||console.error("getBandwidthSaved error:",s),s}}static async getTopGames(e=10,a="7d",s){try{const r=await fetch(`${I}/stats/top-games?limit=${e}&period=${a}`,{signal:s,headers:this.getHeaders()});return await this.handleResponse(r)}catch(r){throw r.name==="AbortError"||console.error("getTopGames error:",r),r}}static async clearAllCache(){try{const e=await fetch(`${I}/management/cache/clear-all`,{method:"POST",headers:this.getHeaders({"Content-Type":"application/json"}),signal:AbortSignal.timeout(1e4)});return await this.handleResponse(e)}catch(e){throw console.error("clearAllCache error:",e),e}}static async getCacheClearStatus(e){try{const a=await fetch(`${I}/management/cache/clear-status/${e}`,{signal:AbortSignal.timeout(5e3),headers:this.getHeaders()});return await this.handleResponse(a)}catch(a){throw console.error("getCacheClearStatus error:",a),a}}static async cancelCacheClear(e){try{const a=await fetch(`${I}/management/cache/clear-cancel/${e}`,{method:"POST",headers:this.getHeaders({"Content-Type":"application/json"}),signal:AbortSignal.timeout(5e3)});return await this.handleResponse(a)}catch(a){throw console.error("cancelCacheClear error:",a),a}}static async getActiveCacheOperations(){try{const e=await fetch(`${I}/management/cache/active-operations`,{signal:AbortSignal.timeout(5e3),headers:this.getHeaders()});return await this.handleResponse(e)}catch(e){throw console.error("getActiveCacheOperations error:",e),e}}static async clearCache(e=null){return e?await this.removeServiceFromLogs(e):await this.clearAllCache()}static async resetDatabase(){try{const e=await fetch(`${I}/management/database`,{method:"DELETE",headers:this.getHeaders({"Content-Type":"application/json"}),signal:AbortSignal.timeout(6e4)});return await this.handleResponse(e)}catch(e){throw console.error("resetDatabase error:",e),e}}static async resetLogPosition(){try{const e=await fetch(`${I}/management/reset-logs`,{method:"POST",headers:this.getHeaders({"Content-Type":"application/json"}),signal:AbortSignal.timeout(6e4)});return await this.handleResponse(e)}catch(e){throw console.error("resetLogPosition error:",e),e}}static async processAllLogs(){try{const e=await fetch(`${I}/management/process-all-logs`,{method:"POST",headers:this.getHeaders({"Content-Type":"application/json"}),signal:AbortSignal.timeout(12e4)});return await this.handleResponse(e)}catch(e){throw console.error("processAllLogs error:",e),e}}static async cancelProcessing(){try{const e=await fetch(`${I}/management/cancel-processing`,{method:"POST",headers:this.getHeaders({"Content-Type":"application/json"}),signal:AbortSignal.timeout(25e3)});return await this.handleResponse(e)}catch(e){throw console.error("cancelProcessing error:",e),e}}static async getProcessingStatus(){try{const e=await fetch(`${I}/management/processing-status`,{signal:AbortSignal.timeout(5e3),headers:this.getHeaders()});return await this.handleResponse(e)}catch(e){throw console.error("getProcessingStatus error:",e),e}}static async removeServiceFromLogs(e){try{const a=await fetch(`${I}/management/logs/remove-service`,{method:"POST",headers:this.getHeaders({"Content-Type":"application/json"}),body:JSON.stringify({service:e}),signal:AbortSignal.timeout(12e4)});return await this.handleResponse(a)}catch(a){throw console.error("removeServiceFromLogs error:",a),a}}static async getServiceLogCounts(){try{const e=await fetch(`${I}/management/logs/service-counts`,{signal:AbortSignal.timeout(3e4),headers:this.getHeaders()});return await this.handleResponse(e)}catch(e){throw console.error("getServiceLogCounts error:",e),e}}static async getConfig(){try{const e=await fetch(`${I}/management/config`,{signal:AbortSignal.timeout(5e3),headers:this.getHeaders()});return await this.handleResponse(e)}catch(e){return console.error("getConfig error:",e),{cachePath:"/cache",logPath:"/logs/access.log",services:["steam","epic","origin","blizzard","wsus","riot"]}}}static async getPicsStatus(e){try{const a=await fetch(`${I}/gameinfo/pics-status`,{signal:e,headers:this.getHeaders()});return await this.handleResponse(a)}catch(a){throw console.error("getPicsStatus error:",a),a}}static async downloadPrecreatedPicsData(e){try{const a=await fetch(`${I}/gameinfo/download-precreated-data`,{method:"POST",signal:e,headers:this.getHeaders({"Content-Type":"application/json"})});return await this.handleResponse(a)}catch(a){throw console.error("downloadPrecreatedPicsData error:",a),a}}static async triggerSteamKitRebuild(e=!1,a){try{const s=await fetch(`${I}/gameinfo/steamkit/rebuild?incremental=${e}`,{method:"POST",signal:a,headers:this.getHeaders({"Content-Type":"application/json"})});return await this.handleResponse(s)}catch(s){throw console.error("triggerSteamKitRebuild error:",s),s}}}class we{static generateMockData(e="unlimited"){const a=["192.168.1.100","192.168.1.101","192.168.1.102","192.168.1.103","192.168.1.104","192.168.1.105","192.168.1.106","192.168.1.107","192.168.1.108","192.168.1.109","192.168.1.110","192.168.1.111","10.0.0.50","10.0.0.51","10.0.0.52","10.0.0.53","127.0.0.1"],s=[{name:"Counter-Strike 2",size:32212254720},{name:"Dota 2",size:37580963840},{name:"Team Fortress 2",size:26843545600},{name:"Grand Theft Auto V",size:102005473280},{name:"Apex Legends",size:64424509440},{name:"Dead by Daylight",size:48318382080},{name:"Marvel Rivals",size:59055800320},{name:"Path of Exile",size:42949672960},{name:"Warframe",size:53687091200},{name:"Destiny 2",size:112742891520},{name:"Rust",size:37580963840},{name:"Valheim",size:1073741824},{name:"Unknown Steam Game",size:16106127360}],r={totalCacheSize:2e12,usedCacheSize:145e10,freeCacheSize:55e10,usagePercent:72.5,totalFiles:48293+(typeof e=="number"?e:500)*100,serviceSizes:{steam:65e10,epic:32e10,origin:18e10,blizzard:15e10,wsus:1e11,riot:5e10}},o=[],c=new Date,g=e==="unlimited"?500:e,d={};for(let i=0;i<g;i++){const m=ne[Math.floor(Math.random()*ne.length)],x=a[Math.floor(Math.random()*a.length)],C=Math.random()<.3,T=Math.pow(i/g,2)*2160,p=new Date(c.getTime()-T*60*60*1e3-Math.random()*36e5);let N;if(C){const k=new Date(p.getTime()+Math.random()*5e3);N={id:i+1,service:m,clientIp:x,startTime:p.toISOString(),endTime:k.toISOString(),cacheHitBytes:0,cacheMissBytes:0,totalBytes:0,cacheHitPercent:0,isActive:!1,gameName:null}}else{let k=null,E;if(m==="steam"&&Math.random()<.7){const G=s[Math.floor(Math.random()*s.length)];k=G.name,E=Math.floor(G.size*(.8+Math.random()*.2))}else E=Math.floor(Math.random()*50*1024*1024*1024);const $=Math.min(.95,.1+T/2160*.85),A=Math.floor(E*$),_=E-A,X=$>.8?500*1024*1024:50*1024*1024,W=E/X*1e3,Y=new Date(p.getTime()+W);N={id:i+1,service:m,clientIp:x,startTime:p.toISOString(),endTime:Y.toISOString(),cacheHitBytes:A,cacheMissBytes:_,totalBytes:E,cacheHitPercent:A/E*100,isActive:i<3&&T<.5,gameName:k,gameAppId:k&&k!=="Unknown Steam Game"?2e5+Math.floor(Math.random()*2e6):null}}d[x]||(d[x]={totalCacheHitBytes:0,totalCacheMissBytes:0,totalDownloads:0,lastSeen:p}),d[x].totalCacheHitBytes+=N.cacheHitBytes||0,d[x].totalCacheMissBytes+=N.cacheMissBytes||0,d[x].totalDownloads+=1,p>d[x].lastSeen&&(d[x].lastSeen=p),o.push(N)}o.sort((i,m)=>new Date(m.startTime).getTime()-new Date(i.startTime).getTime());const b=a.map(i=>{const m=d[i];if(m){const x=m.totalCacheHitBytes+m.totalCacheMissBytes;return{clientIp:i,totalCacheHitBytes:m.totalCacheHitBytes,totalCacheMissBytes:m.totalCacheMissBytes,totalBytes:x,cacheHitPercent:x>0?m.totalCacheHitBytes/x*100:0,totalDownloads:m.totalDownloads,lastSeen:m.lastSeen.toISOString()}}else return{clientIp:i,totalCacheHitBytes:0,totalCacheMissBytes:0,totalBytes:0,cacheHitPercent:0,totalDownloads:0,lastSeen:null}}).filter(i=>i.totalBytes>0),w=ne.map(i=>{var T;const m=o.filter(p=>p.service===i),x=m.reduce((p,N)=>p+N.cacheHitBytes,0),C=m.reduce((p,N)=>p+N.cacheMissBytes,0);return{service:i,totalCacheHitBytes:x||r.serviceSizes[i]*.8,totalCacheMissBytes:C||r.serviceSizes[i]*.2,totalBytes:x+C||r.serviceSizes[i],cacheHitPercent:x+C>0?x/(x+C)*100:80,totalDownloads:m.length,lastActivity:((T=m[0])==null?void 0:T.startTime)||new Date(c.getTime()-Math.random()*72e5).toISOString()}});return{cacheInfo:r,activeDownloads:o.filter(i=>i.isActive),latestDownloads:o,clientStats:b,serviceStats:w}}static generateRealtimeUpdate(){const e=["192.168.1.100","192.168.1.101","192.168.1.102","192.168.1.103","192.168.1.104","192.168.1.105","192.168.1.106","192.168.1.107"];if(Math.random()<.2)return{id:Date.now(),service:ne[Math.floor(Math.random()*ne.length)],clientIp:e[Math.floor(Math.random()*e.length)],startTime:new Date().toISOString(),endTime:new Date().toISOString(),cacheHitBytes:0,cacheMissBytes:0,totalBytes:0,cacheHitPercent:0,isActive:!1};const s=Math.floor(Math.random()*5e8),r=Math.floor(Math.random()*1e8);return{id:Date.now(),service:ne[Math.floor(Math.random()*ne.length)],clientIp:e[Math.floor(Math.random()*e.length)],startTime:new Date().toISOString(),endTime:null,cacheHitBytes:s,cacheMissBytes:r,totalBytes:s+r,cacheHitPercent:s/(s+r)*100,isActive:!0,gameName:Math.random()<.5?"Counter-Strike 2":null}}}const Ee=l.createContext(void 0),He=()=>{const n=l.useContext(Ee);if(!n)throw new Error("useTimeFilter must be used within a TimeFilterProvider");return n},nt=({children:n})=>{const[e,a]=l.useState(()=>{const i=localStorage.getItem("lancache_time_range"),m=localStorage.getItem("lancache_custom_start_date"),x=localStorage.getItem("lancache_custom_end_date");return i==="custom"&&(!m||!x)?"live":i||"live"}),[s,r]=l.useState(()=>{const i=localStorage.getItem("lancache_custom_start_date");if(i){const m=new Date(i);if(!isNaN(m.getTime()))return m}return null}),[o,c]=l.useState(()=>{const i=localStorage.getItem("lancache_custom_end_date");if(i){const m=new Date(i);if(!isNaN(m.getTime()))return m}return null});l.useEffect(()=>{localStorage.setItem("lancache_time_range",e)},[e]),l.useEffect(()=>{s?localStorage.setItem("lancache_custom_start_date",s.toISOString()):localStorage.removeItem("lancache_custom_start_date")},[s]),l.useEffect(()=>{o?localStorage.setItem("lancache_custom_end_date",o.toISOString()):localStorage.removeItem("lancache_custom_end_date")},[o]);const g=()=>{switch(e){case"1h":return 1;case"6h":return 6;case"12h":return 12;case"24h":return 24;case"7d":return 168;case"30d":return 720;case"live":return 999999;case"custom":if(s&&o){const i=o.getTime()-s.getTime();return Math.ceil(i/(1e3*60*60))}return 24;default:return 24}},d=()=>{if(e==="custom"&&s&&o){const C=Math.floor(s.getTime()/1e3),T=Math.floor(o.getTime()/1e3);return{startTime:C,endTime:T}}if(e==="live")return{};const i=Date.now(),m=g()*60*60*1e3;return{startTime:Math.floor((i-m)/1e3),endTime:Math.floor(i/1e3)}},b=i=>{r(i)},w=i=>{c(i)};return t.jsx(Ee.Provider,{value:{timeRange:e,setTimeRange:a,customStartDate:s,customEndDate:o,setCustomStartDate:b,setCustomEndDate:w,getTimeRangeInHours:g,getTimeRangeParams:d},children:n})},Ce={},Le=l.createContext(void 0),it=()=>{const n=l.useContext(Le);if(!n)throw new Error("useData must be used within DataProvider");return n},ct=({children:n})=>{const{getTimeRangeParams:e,timeRange:a,customStartDate:s,customEndDate:r}=He(),[o,c]=l.useState(!1),[g,d]=l.useState({start:null,end:null}),[b,w]=l.useState("unlimited"),[i,m]=l.useState("unlimited"),[x,C]=l.useState(null),[T,p]=l.useState([]),[N,k]=l.useState([]),[E,$]=l.useState([]),[A,_]=l.useState([]),[X,W]=l.useState(null),[Y,G]=l.useState(!0),[fe,z]=l.useState(null),[Q,te]=l.useState(!1),[ie,re]=l.useState(null),[ae,q]=l.useState("checking"),V=l.useRef(!0),F=l.useRef(!1),Z=l.useRef(!1),B=l.useRef(null),L=l.useRef(null),ce=()=>{if(!(typeof import.meta<"u"&&(Ce!=null&&Ce.VITE_API_URL)))return""},le=async()=>{try{const v=ce();return(await fetch(`${v}/health`,{signal:AbortSignal.timeout(5e3)})).ok?(q("connected"),!0):(q("error"),!1)}catch{return q("disconnected"),!1}},h=async()=>{const{startTime:v,endTime:j}=e();if(!(Z.current&&!V.current)){Z.current=!0,B.current&&B.current.abort(),B.current=new AbortController;try{if(V.current&&G(!0),o){const S=b==="unlimited"?500:Number(b),y=we.generateMockData(S);C(y.cacheInfo),p(y.activeDownloads),k(y.latestDownloads),$(y.clientStats),_(y.serviceStats),z(null),q("connected"),F.current=!0}else if(await le())try{const P=setTimeout(()=>{var O;return(O=B.current)==null?void 0:O.abort()},Q?3e4:1e4);if(V.current){const[O,se]=await Promise.all([H.getCacheInfo(B.current.signal),H.getActiveDownloads(B.current.signal)]);O&&C(O),se&&p(se);const de=await H.getLatestDownloads(B.current.signal,"unlimited",v,j);de&&(k(de),F.current=!0),setTimeout(async()=>{var oe;if(!((oe=B.current)!=null&&oe.signal.aborted))try{const J={"1h":"1h","6h":"6h","12h":"12h","24h":"24h","7d":"7d","30d":"30d",live:"all",custom:"custom"}[a]||"24h",[ee,he,me]=await Promise.all([H.getClientStats(B.current.signal,v,j),H.getServiceStats(B.current.signal,null,v,j),H.getDashboardStats(J,B.current.signal)]);ee&&$(ee),he&&_(he),me&&W(me)}catch{}},100)}else{const O="unlimited",de={"1h":"1h","6h":"6h","12h":"12h","24h":"24h","7d":"7d","30d":"30d",live:"all",custom:"custom"}[a]||"24h",[oe,be,J,ee,he,me]=await Promise.allSettled([H.getCacheInfo(B.current.signal),H.getActiveDownloads(B.current.signal),H.getLatestDownloads(B.current.signal,O,v,j),H.getClientStats(B.current.signal,v,j),H.getServiceStats(B.current.signal,null,v,j),H.getDashboardStats(de,B.current.signal)]);oe.status==="fulfilled"&&oe.value!==void 0&&C(oe.value),be.status==="fulfilled"&&be.value!==void 0&&p(be.value),J.status==="fulfilled"&&J.value!==void 0&&(k(J.value),F.current=!0,console.log("ðŸ“Š Downloads API Response:",{totalDownloads:J.value.length,timeRange:a,downloadsWithTimes:J.value.slice(0,3).map(U=>({id:U.id,startTime:U.startTime,startTimeFormatted:new Date(U.startTime).toLocaleString(),gameName:U.gameName}))}),Q&&J.value.length>0&&re(U=>({...U,message:`Processing logs... Found ${J.value.length} downloads`,downloadCount:J.value.length}))),ee.status==="fulfilled"&&ee.value!==void 0&&($(ee.value),console.log("ðŸ‘¥ Client Stats API Response:",{totalClients:ee.value.length,timeRange:a,clientsWithTimes:ee.value.slice(0,3).map(U=>({clientIp:U.clientIp,lastSeen:U.lastSeen,lastSeenFormatted:new Date(U.lastSeen).toLocaleString(),totalBytes:U.totalBytes}))})),he.status==="fulfilled"&&he.value!==void 0&&_(he.value),me.status==="fulfilled"&&me.value!==void 0&&W(me.value)}clearTimeout(P),z(null)}catch(y){F.current||(y.name==="AbortError"?z("Request timeout - the server may be busy"):z("Failed to fetch data from API"))}else F.current||z("Cannot connect to API server")}catch(S){console.error("Error in fetchData:",S),!F.current&&!o&&z("An unexpected error occurred")}finally{V.current&&(G(!1),V.current=!1),Z.current=!1}}},f=v=>{o&&w(v)},u=v=>{m(v)},D=()=>Q?15e3:3e4;l.useEffect(()=>{if(!o){h();const v=D();return L.current=setInterval(h,v),()=>{L.current&&(clearInterval(L.current),L.current=null),B.current&&B.current.abort()}}},[Q,o,i,a]),l.useEffect(()=>{var v,j;if(a==="custom"&&!o){if(s&&r&&(((v=g.start)==null?void 0:v.getTime())!==s.getTime()||((j=g.end)==null?void 0:j.getTime())!==r.getTime())){const y=setTimeout(()=>{d({start:s,end:r}),h()},500);return()=>clearTimeout(y)}}else a!=="custom"&&d({start:null,end:null})},[s,r,a,o]),l.useEffect(()=>{if(o){L.current&&(clearInterval(L.current),L.current=null),C(null),p([]),k([]),$([]),_([]);const v=b==="unlimited"?500:Number(b),j=we.generateMockData(v);C(j.cacheInfo),p(j.activeDownloads),k(j.latestDownloads),$(j.clientStats),_(j.serviceStats),z(null),q("connected"),F.current=!0;const S=3e4;return L.current=setInterval(()=>{const y=we.generateRealtimeUpdate();k(P=>[y,...P]),p(P=>[y,...P.filter(se=>se.id!==y.id)].slice(0,5))},S),()=>{L.current&&(clearInterval(L.current),L.current=null)}}else C(null),p([]),k([]),$([]),_([]),z(null),F.current=!1,V.current=!0,h()},[o,b]),l.useEffect(()=>()=>{L.current&&clearInterval(L.current),B.current&&B.current.abort()},[]);const M={mockMode:o,setMockMode:c,mockDownloadCount:b,updateMockDataCount:f,apiDownloadCount:i,updateApiDownloadCount:u,cacheInfo:x,activeDownloads:T,latestDownloads:N,clientStats:E,serviceStats:A,dashboardStats:X,loading:Y,error:fe,fetchData:h,clearAllData:()=>{C(null),p([]),k([]),$([]),_([]),F.current=!1},isProcessingLogs:Q,setIsProcessingLogs:te,processingStatus:ie,setProcessingStatus:re,connectionStatus:ae,getCurrentRefreshInterval:D};return t.jsx(Le.Provider,{value:M,children:n})},lt=({startDate:n,endDate:e,onStartDateChange:a,onEndDateChange:s,onClose:r})=>{const[o,c]=l.useState(()=>n?new Date(n.getFullYear(),n.getMonth(),1):new Date),[g,d]=l.useState(!1),[b,w]=l.useState(!1),[i,m]=l.useState(null),[x,C]=l.useState(0),[T,p]=l.useState(null),[N,k]=l.useState(0),E=l.useRef(null);l.useEffect(()=>{const h=f=>{E.current&&!E.current.contains(f.target)&&r()};return document.addEventListener("mousedown",h),()=>document.removeEventListener("mousedown",h)},[r]);const $=()=>{d(!1),w(!1)},A=h=>new Date(h.getFullYear(),h.getMonth()+1,0).getDate(),_=h=>new Date(h.getFullYear(),h.getMonth(),1).getDay(),X=h=>{$();const f=new Date(o.getFullYear(),o.getMonth(),h);f.setHours(0,0,0,0);const u=Date.now(),D=u-x,R=T&&f.getTime()===T.getTime();if(R&&D<500?k(M=>M+1):k(1),C(u),p(f),R&&N>=2){a(null),s(null),k(0);return}!n||n&&e?(a(f),s(null)):f<n?(a(f),s(n)):(f.getTime(),n.getTime(),s(f))},W=h=>{if(n&&!e){const f=new Date(o.getFullYear(),o.getMonth(),h);f.setHours(0,0,0,0),m(f)}else m(null)},Y=()=>{m(null)},G=h=>{$(),c(new Date(o.getFullYear(),o.getMonth()+h,1))},fe=h=>{c(new Date(h,o.getMonth(),1)),d(!1)},z=h=>{c(new Date(o.getFullYear(),h,1)),w(!1)},Q=new Date().getFullYear(),te=1999,ie=Q+2,re=Array.from({length:ie-te+1},(h,f)=>te+f),ae=["January","February","March","April","May","June","July","August","September","October","November","December"],q=h=>{const f=new Date(o.getFullYear(),o.getMonth(),h);if(f.setHours(0,0,0,0),n&&e){const u=new Date(n),D=new Date(e);return u.setHours(0,0,0,0),D.setHours(0,0,0,0),f>=u&&f<=D}if(n&&!e&&i){const u=new Date(n);u.setHours(0,0,0,0);const D=new Date(i);D.setHours(0,0,0,0);const R=u<D?u:D,M=u>D?u:D;return f>=R&&f<=M}return!1},V=h=>{if(!n)return!1;const f=new Date(o.getFullYear(),o.getMonth(),h);f.setHours(0,0,0,0);const u=new Date(n);return u.setHours(0,0,0,0),f.getTime()===u.getTime()},F=h=>{if(!e)return!1;const f=new Date(o.getFullYear(),o.getMonth(),h);f.setHours(0,0,0,0);const u=new Date(e);return u.setHours(0,0,0,0),f.getTime()===u.getTime()},Z=h=>{if(!i)return!1;const f=new Date(o.getFullYear(),o.getMonth(),h);f.setHours(0,0,0,0);const u=new Date(i);return u.setHours(0,0,0,0),f.getTime()===u.getTime()},B=h=>{const f=new Date;return o.getFullYear()===f.getFullYear()&&o.getMonth()===f.getMonth()&&h===f.getDate()},L=A(o),ce=_(o),le=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];return t.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[100000] p-4",children:t.jsxs("div",{ref:E,className:"bg-[var(--theme-bg-secondary)] rounded-lg shadow-xl max-w-md w-full",style:{border:"1px solid var(--theme-border-primary)"},children:[t.jsxs("div",{className:"flex items-center justify-between p-4 border-b",style:{borderColor:"var(--theme-border-primary)"},children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Be,{className:"w-5 h-5 text-[var(--theme-primary)]"}),t.jsx("h3",{className:"text-lg font-semibold text-[var(--theme-text-primary)]",children:"Select Date Range"})]}),t.jsx("button",{onClick:r,className:"p-1 hover:bg-[var(--theme-bg-tertiary)] rounded transition-colors",children:t.jsx(Re,{className:"w-5 h-5 text-[var(--theme-text-secondary)]"})})]}),t.jsxs("div",{className:"p-4",children:[t.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[t.jsx("button",{onClick:()=>G(-1),className:"p-2 hover:bg-[var(--theme-bg-tertiary)] rounded transition-colors",children:t.jsx(ze,{className:"w-5 h-5 text-[var(--theme-text-primary)]"})}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("div",{className:"relative",style:{zIndex:100002},children:[t.jsxs("button",{onClick:()=>{w(!b),d(!1)},className:"flex items-center gap-1 px-3 py-1 text-[var(--theme-text-primary)] font-medium hover:bg-[var(--theme-bg-tertiary)] rounded transition-colors",children:[ae[o.getMonth()],t.jsx(je,{className:"w-4 h-4"})]}),b&&t.jsx("div",{className:"absolute top-full left-0 mt-1 bg-[var(--theme-bg-secondary)] border border-[var(--theme-border-primary)] rounded-lg shadow-lg max-h-48 overflow-y-auto",style:{zIndex:100003},children:ae.map((h,f)=>t.jsx("button",{onClick:()=>z(f),className:`w-full text-left px-3 py-2 text-sm hover:bg-[var(--theme-bg-tertiary)] transition-colors ${f===o.getMonth()?"bg-[var(--theme-primary)] text-white":"text-[var(--theme-text-primary)]"}`,children:h},h))})]}),t.jsxs("div",{className:"relative",style:{zIndex:100002},children:[t.jsxs("button",{onClick:()=>{d(!g),w(!1)},className:"flex items-center gap-1 px-3 py-1 text-[var(--theme-text-primary)] font-medium hover:bg-[var(--theme-bg-tertiary)] rounded transition-colors",children:[o.getFullYear(),t.jsx(je,{className:"w-4 h-4"})]}),g&&t.jsx("div",{className:"absolute top-full right-0 mt-1 bg-[var(--theme-bg-secondary)] border border-[var(--theme-border-primary)] rounded-lg shadow-lg max-h-48 overflow-y-auto",style:{zIndex:100003},children:re.map(h=>t.jsx("button",{onClick:()=>fe(h),className:`w-full text-left px-3 py-2 text-sm hover:bg-[var(--theme-bg-tertiary)] transition-colors ${h===o.getFullYear()?"bg-[var(--theme-primary)] text-white":"text-[var(--theme-text-primary)]"}`,children:h},h))})]})]}),t.jsx("button",{onClick:()=>G(1),className:"p-2 hover:bg-[var(--theme-bg-tertiary)] rounded transition-colors",children:t.jsx(Oe,{className:"w-5 h-5 text-[var(--theme-text-primary)]"})})]}),t.jsx("div",{className:"grid grid-cols-7 gap-1 mb-2",children:le.map(h=>t.jsx("div",{className:"text-center text-xs font-medium text-[var(--theme-text-secondary)] py-2",children:h},h))}),t.jsxs("div",{className:"grid grid-cols-7 gap-1",onMouseLeave:Y,children:[Array.from({length:ce}).map((h,f)=>t.jsx("div",{},`empty-${f}`)),Array.from({length:L}).map((h,f)=>{const u=f+1,D=q(u),R=V(u),M=F(u),v=Z(u),j=B(u);let S="relative p-2 text-sm transition-all ";return R&&M?S+="rounded-lg ":R?S+="rounded-l-lg ":M?S+="rounded-r-lg ":D?S+="":S+="rounded ",R||M?S+="bg-[var(--theme-primary)] text-white font-semibold z-10 ":D?S+="bg-[var(--theme-primary)]/20 text-[var(--theme-text-primary)] ":v&&n&&!e?S+="bg-[var(--theme-bg-tertiary)]/50 text-[var(--theme-text-primary)] ":S+="hover:bg-[var(--theme-bg-tertiary)] text-[var(--theme-text-primary)] ",j&&(S+="ring-2 ring-[var(--theme-primary)]/50 "),t.jsxs("button",{onClick:()=>X(u),onMouseEnter:()=>W(u),className:S,children:[u,j&&t.jsx("div",{className:"absolute bottom-0.5 left-1/2 transform -translate-x-1/2 w-1 h-1 bg-[var(--theme-primary)] rounded-full"})]},u)})]}),t.jsxs("div",{className:"mt-4 pt-4 border-t",style:{borderColor:"var(--theme-border-primary)"},children:[t.jsxs("div",{className:"flex justify-between text-sm",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-[var(--theme-text-secondary)]",children:"Start: "}),t.jsx("span",{className:"text-[var(--theme-text-primary)] font-medium",children:n?n.toLocaleDateString():"Not selected"})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-[var(--theme-text-secondary)]",children:"End: "}),t.jsx("span",{className:"text-[var(--theme-text-primary)] font-medium",children:e?e.toLocaleDateString():"Not selected"})]})]}),t.jsx("div",{className:"mt-2 text-xs text-[var(--theme-text-secondary)] text-center",children:n?e?`${Math.abs(Math.ceil((e.getTime()-n.getTime())/(1e3*60*60*24)))+1} day(s) selected`:"Select end date (triple-click to unselect)":"Select start date (triple-click to unselect)"})]}),t.jsxs("div",{className:"mt-4 pt-4 border-t",style:{borderColor:"var(--theme-border-primary)"},children:[t.jsx("div",{className:"text-xs text-[var(--theme-text-secondary)] mb-2",children:"Quick Select:"}),t.jsxs("div",{className:"grid grid-cols-3 gap-2 mb-3",children:[t.jsx("button",{onClick:()=>{const h=new Date;h.setHours(0,0,0,0),a(h),s(h)},className:"px-2 py-1 text-xs bg-[var(--theme-bg-tertiary)] text-[var(--theme-text-primary)] rounded hover:bg-[var(--theme-bg-primary)] transition-colors",children:"Today"}),t.jsx("button",{onClick:()=>{const h=new Date;h.setHours(0,0,0,0);const f=new Date(h);f.setDate(f.getDate()-6),a(f),s(h)},className:"px-2 py-1 text-xs bg-[var(--theme-bg-tertiary)] text-[var(--theme-text-primary)] rounded hover:bg-[var(--theme-bg-primary)] transition-colors",children:"Last 7 Days"}),t.jsx("button",{onClick:()=>{const h=new Date;h.setHours(0,0,0,0);const f=new Date(h);f.setDate(f.getDate()-29),a(f),s(h)},className:"px-2 py-1 text-xs bg-[var(--theme-bg-tertiary)] text-[var(--theme-text-primary)] rounded hover:bg-[var(--theme-bg-primary)] transition-colors",children:"Last 30 Days"}),t.jsx("button",{onClick:()=>{const h=new Date,f=new Date(h.getFullYear(),h.getMonth(),1);f.setHours(0,0,0,0);const u=new Date(h.getFullYear(),h.getMonth()+1,0);u.setHours(0,0,0,0),a(f),s(u)},className:"px-2 py-1 text-xs bg-[var(--theme-bg-tertiary)] text-[var(--theme-text-primary)] rounded hover:bg-[var(--theme-bg-primary)] transition-colors",children:"This Month"}),t.jsx("button",{onClick:()=>{const h=new Date,f=new Date(h.getFullYear(),h.getMonth()-1,1);f.setHours(0,0,0,0);const u=new Date(h.getFullYear(),h.getMonth(),0);u.setHours(0,0,0,0),a(f),s(u)},className:"px-2 py-1 text-xs bg-[var(--theme-bg-tertiary)] text-[var(--theme-text-primary)] rounded hover:bg-[var(--theme-bg-primary)] transition-colors",children:"Last Month"}),t.jsx("button",{onClick:()=>{const h=new Date,f=new Date(h.getFullYear(),0,1);f.setHours(0,0,0,0);const u=new Date(h.getFullYear(),11,31);u.setHours(0,0,0,0),a(f),s(u)},className:"px-2 py-1 text-xs bg-[var(--theme-bg-tertiary)] text-[var(--theme-text-primary)] rounded hover:bg-[var(--theme-bg-primary)] transition-colors",children:"This Year"})]})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:()=>{a(null),s(null),m(null),k(0),p(null),$(),c(new Date)},className:"flex-1 px-3 py-2 text-sm bg-[var(--theme-bg-tertiary)] text-[var(--theme-text-primary)] rounded hover:bg-[var(--theme-bg-primary)] transition-colors",children:"Clear"}),t.jsx("button",{onClick:r,className:"flex-1 px-3 py-2 text-sm bg-[var(--theme-primary)] text-white rounded hover:bg-[var(--theme-primary)]/90 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:!n||!e,children:"Apply"})]})]})]})})},xe=({content:n,children:e,position:a="bottom",className:s=""})=>{const[r,o]=l.useState(!1),[c,g]=l.useState({top:0,left:0}),d=l.useRef(null),b=l.useRef(null);l.useEffect(()=>{if(r&&d.current&&b.current){const m=b.current.getBoundingClientRect(),x=d.current.getBoundingClientRect();let C=0,T=0;switch(a){case"top":C=m.top-x.height-8,T=m.left+(m.width-x.width)/2;break;case"bottom":C=m.bottom+8,T=m.left+(m.width-x.width)/2;break;case"left":C=m.top+(m.height-x.height)/2,T=m.left-x.width-8;break;case"right":C=m.top+(m.height-x.height)/2,T=m.right+8;break}g({top:C,left:T})}},[r,a]);const w=()=>{o(!0)},i=()=>{o(!1)};return t.jsxs(t.Fragment,{children:[t.jsx("div",{ref:b,onMouseEnter:w,onMouseLeave:i,className:`relative inline-block ${s}`,children:e}),r&&t.jsx("div",{ref:d,className:"fixed z-50 px-2 py-1 text-xs font-medium rounded shadow-lg pointer-events-none transition-opacity duration-200",style:{top:c.top,left:c.left,backgroundColor:"var(--theme-bg-primary)",color:"var(--theme-text-primary)",border:"1px solid var(--theme-border-primary)",maxWidth:"200px"},children:n})]})},dt=()=>{const{timeRange:n,setTimeRange:e,customStartDate:a,customEndDate:s,setCustomStartDate:r,setCustomEndDate:o}=He(),[c,g]=l.useState(!1),[d,b]=l.useState(!1),[w,i]=l.useState(!1),m=l.useRef(null),x=[{value:"1h",label:"Last Hour",shortLabel:"1H"},{value:"6h",label:"Last 6 Hours",shortLabel:"6H"},{value:"12h",label:"Last 12 Hours",shortLabel:"12H"},{value:"24h",label:"Last 24 Hours",shortLabel:"24H"},{value:"7d",label:"Last 7 Days",shortLabel:"7D"},{value:"30d",label:"Last 30 Days",shortLabel:"30D"},{value:"live",label:"Live Data",shortLabel:"Live"},{value:"custom",label:"Custom Range",shortLabel:"Custom"}];l.useEffect(()=>{const p=N=>{m.current&&!m.current.contains(N.target)&&g(!1)};if(c)return document.addEventListener("mousedown",p),()=>document.removeEventListener("mousedown",p)},[c]);const C=p=>{e(p),p==="custom"?(b(!0),g(!1)):(g(!1),i(!0),setTimeout(()=>i(!1),1e3))};l.useEffect(()=>{n==="custom"&&a&&s&&(i(!0),setTimeout(()=>i(!1),1e3))},[a,s,n]);const T=()=>{if(n==="custom"&&a&&s){const N=a.toLocaleDateString("en-US",{month:"short",day:"numeric"}),k=s.toLocaleDateString("en-US",{month:"short",day:"numeric"});return`${N} - ${k}`}const p=x.find(N=>N.value===n);return(p==null?void 0:p.shortLabel)||(p==null?void 0:p.label)||"Last 24H"};return t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"relative",ref:m,children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("button",{onClick:()=>g(!c),className:"flex items-center gap-1.5 px-2 sm:px-3 py-1.5 rounded-lg transition-all",style:{backgroundColor:c?"var(--theme-bg-tertiary)":"var(--theme-bg-secondary)",border:c?"1px solid var(--theme-primary)":"1px solid var(--theme-border-primary)"},children:[w?t.jsx(ge,{className:"w-4 h-4 text-[var(--theme-primary)] animate-spin"}):t.jsx(Ke,{className:"w-4 h-4 text-[var(--theme-primary)]"}),t.jsx("span",{className:"text-xs sm:text-sm font-medium text-[var(--theme-text-primary)]",children:w?"Loading...":T()}),t.jsx(je,{className:`w-3 h-3 text-[var(--theme-text-secondary)] transition-transform ${c?"rotate-180":""}`})]}),n==="live"&&!w&&t.jsx(xe,{content:"Live Mode: Data updates automatically every few seconds",children:t.jsx("div",{className:"flex items-center",children:t.jsx(Ye,{className:"w-3 h-3 animate-pulse",style:{color:"var(--theme-success)"}})})})]}),c&&t.jsx("div",{className:"absolute right-0 mt-2 w-48 rounded-lg shadow-xl z-[99999]",style:{backgroundColor:"var(--theme-bg-secondary)",border:"1px solid var(--theme-border-primary)"},children:t.jsxs("div",{className:"p-1",children:[t.jsx("div",{className:"px-2 py-1.5 text-xs font-semibold text-[var(--theme-text-secondary)]",children:"Time Range"}),x.map(p=>t.jsxs("button",{onClick:()=>C(p.value),className:`
                    w-full flex items-center justify-between px-3 py-2 rounded text-sm transition-colors
                    ${n===p.value?"bg-[var(--theme-primary)]/10 text-[var(--theme-primary)]":"text-[var(--theme-text-primary)] hover:bg-[var(--theme-bg-tertiary)]"}
                  `,children:[t.jsxs("span",{className:"flex items-center gap-1.5",children:[p.value==="custom"&&t.jsx(Be,{className:"w-3.5 h-3.5"}),p.label]}),n===p.value&&t.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:t.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})]},p.value))]})})]}),d&&t.jsx(lt,{startDate:a,endDate:s,onStartDateChange:r,onEndDateChange:o,onClose:()=>b(!1)})]})},ht=({title:n="LANCache Manager",subtitle:e="High-performance cache monitoring & management",connectionStatus:a="connected"})=>t.jsx("header",{className:"border-b",style:{backgroundColor:"var(--theme-nav-bg)",borderColor:"var(--theme-nav-border)"},children:t.jsx("div",{className:"container mx-auto px-4",children:t.jsxs("div",{className:"flex items-center justify-between h-16 min-w-0",children:[t.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-3 min-w-0 flex-1",children:[t.jsx("div",{className:"p-1.5 sm:p-2 rounded-lg flex-shrink-0",style:{backgroundColor:"var(--theme-icon-blue)"},children:t.jsx(Ve,{className:"w-5 h-5 sm:w-6 sm:h-6 text-white"})}),t.jsxs("div",{className:"min-w-0 flex-1",children:[t.jsx("h1",{className:"text-lg sm:text-xl font-bold text-themed-primary truncate",children:n}),t.jsxs("div",{className:"flex items-center gap-2 text-xs sm:text-sm text-themed-muted hidden sm:flex",children:[t.jsx("span",{className:"truncate",children:e}),a==="connected"&&t.jsx(xe,{content:"API Status: Connected - All backend services are responding normally",children:t.jsx("div",{className:"flex items-center",children:t.jsx("div",{className:"w-1.5 h-1.5 rounded-full",style:{backgroundColor:"var(--theme-success)"}})})}),a==="disconnected"&&t.jsx(xe,{content:"API Status: Disconnected - Unable to connect to backend services",children:t.jsxs("div",{className:"flex items-center gap-1",style:{color:"var(--theme-error-text)"},children:[t.jsx("div",{className:"w-1.5 h-1.5 rounded-full",style:{backgroundColor:"var(--theme-error)"}}),t.jsx("span",{className:"text-xs",children:"Disconnected"})]})}),a==="reconnecting"&&t.jsx(xe,{content:"API Status: Reconnecting - Attempting to restore connection to backend services",children:t.jsxs("div",{className:"flex items-center gap-1",style:{color:"var(--theme-warning-text)"},children:[t.jsx("div",{className:"w-1.5 h-1.5 rounded-full animate-pulse",style:{backgroundColor:"var(--theme-warning)"}}),t.jsx("span",{className:"text-xs",children:"Reconnecting"})]})})]})]})]}),t.jsx("div",{className:"flex items-center gap-2 sm:gap-3 flex-shrink-0",children:t.jsx(dt,{})})]})})}),mt=({activeTab:n,setActiveTab:e})=>{var c;const[a,s]=l.useState(!1),r=[{id:"dashboard",label:"Dashboard",icon:Ue},{id:"downloads",label:"Downloads",icon:Me},{id:"clients",label:"Clients",icon:We},{id:"management",label:"Management",icon:Ge}],o=({tab:g,isActive:d,onClick:b,className:w=""})=>{const i=g.icon;return t.jsxs("button",{onClick:b,className:`flex items-center space-x-2 px-3 py-2 rounded-lg font-medium transition-all duration-200 ${w}`,style:{color:d?"var(--theme-nav-tab-active)":"var(--theme-nav-tab-inactive)",backgroundColor:"transparent"},onMouseEnter:m=>{d||(m.currentTarget.style.color="var(--theme-nav-tab-hover)",m.currentTarget.style.backgroundColor="var(--theme-nav-mobile-item-hover)")},onMouseLeave:m=>{d||(m.currentTarget.style.color="var(--theme-nav-tab-inactive)",m.currentTarget.style.backgroundColor="transparent")},children:[t.jsx(i,{className:"w-5 h-5"}),t.jsx("span",{children:g.label}),d&&t.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 rounded-full",style:{backgroundColor:"var(--theme-nav-tab-active-border)"}})]})};return t.jsx("nav",{className:"border-b",style:{backgroundColor:"var(--theme-nav-bg)",borderColor:"var(--theme-nav-border)"},children:t.jsxs("div",{className:"container mx-auto px-4",children:[t.jsx("div",{className:"hidden md:flex space-x-1 h-12 items-center",children:r.map(g=>t.jsx("div",{className:"relative",children:t.jsx(o,{tab:g,isActive:n===g.id,onClick:()=>e(g.id)})},g.id))}),t.jsxs("div",{className:"md:hidden",children:[t.jsxs("div",{className:"flex items-center justify-between h-12",children:[t.jsx("div",{className:"flex items-center space-x-2",children:t.jsx("span",{className:"font-medium text-themed-primary",children:((c=r.find(g=>g.id===n))==null?void 0:c.label)||"Dashboard"})}),t.jsx("button",{onClick:()=>s(!a),className:"p-2 rounded-lg transition-colors",style:{color:"var(--theme-nav-tab-inactive)",backgroundColor:"transparent"},onMouseEnter:g=>{g.currentTarget.style.backgroundColor="var(--theme-nav-mobile-item-hover)"},onMouseLeave:g=>{g.currentTarget.style.backgroundColor="transparent"},children:a?t.jsx(Re,{className:"w-5 h-5"}):t.jsx(qe,{className:"w-5 h-5"})})]}),a&&t.jsx("div",{className:"border-t py-2 space-y-1",style:{backgroundColor:"var(--theme-nav-mobile-menu-bg)",borderColor:"var(--theme-nav-border)"},children:r.map(g=>t.jsx(o,{tab:g,isActive:n===g.id,onClick:()=>{e(g.id),s(!1)},className:"w-full justify-start"},g.id))})]})]})})};class ut extends l.Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,a){console.error("Error caught by boundary:",e,a)}render(){var e;return this.state.hasError?t.jsx("div",{className:"min-h-screen bg-themed-primary flex items-center justify-center p-4",children:t.jsx("div",{className:"alert-error rounded-lg p-6 max-w-md w-full",children:t.jsxs("div",{className:"flex items-start space-x-3",children:[t.jsx(Pe,{className:"w-5 h-5 mt-0.5"}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Something went wrong"}),t.jsx("p",{className:"text-sm text-themed-secondary",children:((e=this.state.error)==null?void 0:e.message)||"An unexpected error occurred"}),t.jsx("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 action-delete rounded-lg text-sm smooth-transition",children:"Reload Page"})]})]})})}):this.props.children}}const Ie=({message:n,size:e="md",fullScreen:a=!1})=>{const s={xs:"w-4 h-4",sm:"w-6 h-6",md:"w-8 h-8",lg:"w-12 h-12",xl:"w-16 h-16"},r=t.jsxs("div",{className:"flex flex-col items-center justify-center space-y-4",children:[t.jsx(ge,{className:`${s[e]} text-themed-primary animate-spin`}),n&&t.jsx("p",{className:"text-sm text-themed-muted",children:n})]});return a?t.jsx("div",{className:"fixed inset-0 bg-themed-primary bg-opacity-50 flex items-center justify-center z-50",children:r}):t.jsx("div",{className:"flex items-center justify-center min-h-[200px]",children:r})},gt=()=>{const[n,e]=l.useState(null),[a,s]=l.useState(!1),[r,o]=l.useState(null);if(l.useEffect(()=>{let d=null;const b=async()=>{try{const w=await fetch("/api/gameinfo/steamkit/progress");if(w.ok){const i=await w.json();if(e(i),r&&(clearTimeout(r),o(null)),i.isRunning||!i.isConnected||!i.isLoggedOn)s(!0);else if(i.isReady&&!i.isRunning&&i.isConnected&&i.isLoggedOn){const x=setTimeout(()=>{s(!1)},3e3);o(x)}}}catch(w){console.error("Failed to fetch PICS progress:",w)}};return b(),d=setInterval(b,2e3),()=>{d&&clearInterval(d),r&&clearTimeout(r)}},[r]),!a||!n)return null;const c=()=>n.isRunning?t.jsx(Je,{className:"w-4 h-4 animate-spin",style:{color:"var(--theme-info-text)"}}):n.status==="Complete"?t.jsx(Xe,{className:"w-4 h-4",style:{color:"var(--theme-success-text)"}}):n.status==="Error occurred"?t.jsx(Pe,{className:"w-4 h-4",style:{color:"var(--theme-error-text)"}}):t.jsx(Me,{className:"w-4 h-4",style:{color:"var(--theme-text-muted)"}}),g=()=>n.isRunning?{backgroundColor:"var(--theme-info)"}:n.status==="Complete"?{backgroundColor:"var(--theme-success)"}:n.status==="Error occurred"?{backgroundColor:"var(--theme-error)"}:{backgroundColor:"var(--theme-text-muted)"};return t.jsx("div",{className:"w-full border-b shadow-sm",style:{backgroundColor:"var(--theme-nav-bg)",borderColor:"var(--theme-nav-border)"},children:t.jsx("div",{className:"container mx-auto px-4 py-2",children:t.jsxs("div",{className:"flex items-center gap-3",children:[c(),t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center justify-between mb-1",children:[t.jsxs("span",{className:"text-sm font-medium text-themed-primary",children:["Steam PICS: ",n.status,!n.isConnected&&" (Disconnected)",n.isConnected&&!n.isLoggedOn&&" (Not logged in)"]}),t.jsxs("span",{className:"text-xs text-themed-muted",children:[n.isRunning&&n.totalBatches>0?`${n.processedBatches}/${n.totalBatches} batches (${Math.round(n.progressPercent)}%)`:`${n.depotMappingsFound.toLocaleString()} depot mappings`,n.isReady&&n.nextCrawlIn.totalHours>0&&` â€¢ Next: ${Math.round(n.nextCrawlIn.totalHours)}h`]})]}),n.isRunning&&n.totalBatches>0&&t.jsx("div",{className:"w-full rounded-full h-2",style:{backgroundColor:"var(--theme-bg-tertiary)"},children:t.jsx("div",{className:"h-2 rounded-full transition-all duration-300",style:{...g(),width:`${Math.max(0,Math.min(100,n.progressPercent))}%`}})}),n.isRunning&&n.totalApps>0&&t.jsxs("div",{className:"text-xs text-themed-muted mt-1",children:["Processing ",n.processedApps.toLocaleString(),"/",n.totalApps.toLocaleString()," apps"]})]})]})})})},Se=({children:n,variant:e="default",color:a="blue",size:s="md",loading:r=!1,leftSection:o,rightSection:c,fullWidth:g=!1,className:d="",disabled:b,...w})=>{const i=()=>e==="filled"?{blue:"themed-button-primary",green:"action-process",red:"action-delete",yellow:"action-reset",purple:"themed-button-primary",gray:"bg-themed-hover hover:bg-themed-tertiary text-themed-primary",orange:"action-reset"}[a]:e==="subtle"?"bg-transparent hover:bg-themed-hover text-themed-secondary":e==="outline"?"border border-themed-secondary hover:bg-themed-hover text-themed-primary":"bg-themed-tertiary hover:bg-themed-hover text-themed-primary",m={xs:"px-2 py-1 text-xs",sm:"px-3 py-1.5 text-sm",md:"px-4 py-2",lg:"px-6 py-3 text-lg"};return t.jsxs("button",{className:`
        ${i()}
        ${m[s]}
        ${g?"w-full":""}
        rounded-lg font-medium
        smooth-transition
        disabled:opacity-50 disabled:cursor-not-allowed
        flex items-center justify-center gap-2
        button-press
        ${d}
      `,disabled:b||r,...w,children:[r&&t.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-current"}),o,n,c]})},Ae=({onInitialized:n,isAuthenticated:e,onAuthChanged:a})=>{var te,ie,re,ae,q,V,F,Z,B,L,ce,le,h,f;const[s,r]=l.useState(!1),[o,c]=l.useState(null),[g,d]=l.useState(null),[b,w]=l.useState(null),[i,m]=l.useState(!0),[x,C]=l.useState(""),[T,p]=l.useState(""),[N,k]=l.useState(!1),[E,$]=l.useState(null),[A,_]=l.useState(null);l.useEffect(()=>{(async()=>{try{if(!(await(await fetch("/api/management/setup-status")).json()).isSetupCompleted){m(!0);return}const v=(await K.checkAuth()).isAuthenticated;if(m(!v),e&&!v&&(a==null||a()),v)try{const j=await Y();_(j)}catch(j){console.warn("Failed to fetch PICS status:",j)}}catch(D){console.error("Failed to check setup/auth status:",D),m(!0)}})()},[]),l.useEffect(()=>()=>{s&&console.warn("Depot initialization was interrupted")},[s]);const X=async()=>{var R,M,v,j,S;let u=0;const D=30;for(;u<D;)try{const y=await fetch("/api/gameinfo/pics-status",{headers:H.getHeaders()});if(y.ok){const P=await y.json(),O=((R=P.steamKit2)==null?void 0:R.isRebuildRunning)===!0,se=((M=P.jsonFile)==null?void 0:M.exists)===!0,de=((v=P.database)==null?void 0:v.totalMappings)>0||((j=P.steamKit2)==null?void 0:j.isReady)&&((S=P.steamKit2)==null?void 0:S.depotCount)>0;if(O||se&&de){d("Initialization verified! Launching application..."),setTimeout(()=>{n()},1e3);return}}await new Promise(P=>setTimeout(P,1e3)),u++,d(`Verification attempt ${u}/${D}...`)}catch(y){console.warn("Verification attempt failed:",y),u++,await new Promise(P=>setTimeout(P,1e3))}throw new Error("Failed to verify depot initialization. Please try again.")},W=async()=>{try{(await fetch("/api/management/mark-setup-completed",{method:"POST",headers:H.getHeaders()})).ok||console.warn("Failed to mark setup as completed")}catch(u){console.warn("Failed to mark setup as completed:",u)}},Y=async()=>{try{const u=await H.getPicsStatus();return _(u),u}catch(u){return console.error("Failed to check PICS data status:",u),null}},G=async()=>{var u,D,R,M;r(!0),w("auto-update"),c(null),d("Checking existing PICS data for updates...");try{const v=await Y();if(!v)throw new Error("Unable to check PICS data status");const j=((u=v.jsonFile)==null?void 0:u.exists)===!0,S=((D=v.database)==null?void 0:D.totalMappings)>0||((R=v.steamKit2)==null?void 0:R.isReady)&&((M=v.steamKit2)==null?void 0:M.depotCount)>0;if(j&&S){d("Existing PICS data found. Running incremental update...");const P=j&&!S;await H.triggerSteamKitRebuild(!P),d("Incremental update completed! Verifying initialization..."),await X(),await W()}else throw j?new Error("No existing PICS data found. Please choose an initialization method."):new Error("Depot file missing. Please choose an initialization method to regenerate it.")}catch(v){c(v.message||"Failed to update PICS data"),r(!1),w(null),d(null)}},fe=async()=>{var u,D,R,M;if(!x.trim()){$("API key is required");return}k(!0),$(null);try{const v=await K.register(x,T.trim()||null);if(v.success)if((await K.checkAuth()).isAuthenticated){m(!1),d("Authentication successful! Checking existing PICS data..."),a==null||a();const S=await Y();if(_(S),S){const y=((u=S.jsonFile)==null?void 0:u.exists)===!0,P=((D=S.database)==null?void 0:D.totalMappings)>0||((R=S.steamKit2)==null?void 0:R.isReady)&&((M=S.steamKit2)==null?void 0:M.depotCount)>0;if(y&&P){d("Existing PICS data found! Running automatic update..."),setTimeout(()=>G(),1e3);return}else!y&&P&&(d("Depot file missing but cached data found. Please choose initialization method to regenerate depot file."),setTimeout(()=>d(null),5e3))}d("Choose your depot initialization method below."),setTimeout(()=>d(null),3e3)}else $("Authentication succeeded but verification failed. Please try again.");else $(v.message)}catch(v){$(v.message||"Authentication failed")}finally{k(!1)}},z=async()=>{var D,R,M,v,j,S;if(!(await K.checkAuth()).isAuthenticated){c("Authentication required. Please authenticate first."),m(!0);return}r(!0),w("cloud"),c(null),d("Checking for existing depot data...");try{const y=await Y();y?((D=y.jsonFile)==null?void 0:D.exists)===!0||((R=y.database)==null?void 0:R.totalMappings)>0||((M=y.steamKit2)==null?void 0:M.isReady)&&((v=y.steamKit2)==null?void 0:v.depotCount)>0?((j=y.jsonFile)==null?void 0:j.totalMappings)>1e5||((S=y.database)==null?void 0:S.totalMappings)>1e5?(d("Complete data found. Running incremental update to get latest changes..."),await H.triggerSteamKitRebuild(!0)):(d("Incomplete data found. Running full generation to complete dataset..."),await H.triggerSteamKitRebuild(!1)):(d("Downloading pre-created depot data from GitHub..."),await H.downloadPrecreatedPicsData()):(d("Downloading pre-created depot data from GitHub..."),await H.downloadPrecreatedPicsData()),d("Import complete! Verifying initialization..."),await X(),await W()}catch(y){c(y.message||"Failed to download pre-created depot data"),r(!1),w(null),d(null)}},Q=async()=>{var D,R,M,v,j,S;if(!(await K.checkAuth()).isAuthenticated){c("Authentication required. Please authenticate first."),m(!0);return}r(!0),w("generate"),c(null),d("Checking for existing Steam PICS data...");try{const y=await Y();let P=!1;y&&(((D=y.jsonFile)==null?void 0:D.exists)===!0&&((R=y.jsonFile)==null?void 0:R.totalMappings)>1e5||((M=y.database)==null?void 0:M.totalMappings)>1e5||((v=y.steamKit2)==null?void 0:v.depotCount)>1e5?(P=!0,d("Found complete PICS data. Running incremental update for recent changes...")):(j=y.jsonFile)!=null&&j.exists||((S=y.database)==null?void 0:S.totalMappings)>0?(d("Found incomplete PICS data. Resuming full generation..."),P=!1):d("Starting fresh Steam PICS depot generation...")),await H.triggerSteamKitRebuild(P),d("Depot generation started! Verifying initialization..."),await X(),await W()}catch(y){c(y.message||"Failed to start depot generation"),r(!1),w(null),d(null)}};return t.jsxs("div",{className:"fixed inset-0 z-[9999] bg-[var(--theme-bg-primary)] flex items-center justify-center",children:[t.jsx("div",{className:"absolute inset-0 opacity-5",style:{backgroundImage:"repeating-linear-gradient(45deg, transparent, transparent 35px, var(--theme-text-primary) 35px, var(--theme-text-primary) 70px)"}}),t.jsxs("div",{className:"relative z-10 max-w-2xl w-full mx-4 p-8 rounded-2xl border-2 shadow-2xl",style:{backgroundColor:"var(--theme-bg-secondary)",borderColor:"var(--theme-primary)"},children:[t.jsxs("div",{className:"text-center mb-8",children:[t.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full mb-4",style:{backgroundColor:"var(--theme-primary)/10"},children:t.jsx(Te,{size:32,style:{color:"var(--theme-primary)"}})}),t.jsx("h1",{className:"text-3xl font-bold text-themed-primary mb-2",children:"Welcome to Lancache Manager"}),t.jsx("p",{className:"text-lg text-themed-secondary",children:"Steam depot initialization required"})]}),t.jsx("div",{className:"mb-8",children:i?t.jsxs(t.Fragment,{children:[t.jsx("p",{className:"text-themed-secondary text-center mb-6",children:"Please enter your API key to authenticate and continue with setup:"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-themed-primary mb-2",children:"API Key"}),t.jsx("input",{type:"text",value:x,onChange:u=>C(u.target.value),placeholder:"Enter your API key here...",className:"w-full p-3 rounded-lg border text-sm",style:{backgroundColor:"var(--theme-bg-tertiary)",borderColor:"var(--theme-border-primary)",color:"var(--theme-text-primary)"},disabled:N})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-themed-primary mb-2",children:"Device Name (Optional)"}),t.jsx("input",{type:"text",value:T,onChange:u=>p(u.target.value),placeholder:"e.g., My Desktop",className:"w-full p-3 rounded-lg border text-sm",style:{backgroundColor:"var(--theme-bg-tertiary)",borderColor:"var(--theme-border-primary)",color:"var(--theme-text-primary)"},disabled:N})]}),t.jsx(Se,{variant:"filled",color:"blue",leftSection:N?t.jsx(ge,{className:"w-4 h-4 animate-spin"}):t.jsx(Qe,{className:"w-4 h-4"}),onClick:fe,disabled:N||!x.trim(),fullWidth:!0,children:N?"Authenticating...":"Authenticate"})]}),t.jsx("div",{className:"mt-6 p-4 rounded-lg",style:{backgroundColor:"var(--theme-info-bg)",borderColor:"var(--theme-info)",color:"var(--theme-info-text)"},children:t.jsxs("p",{className:"text-sm",children:[t.jsx("strong",{children:"Where to find your API key:"}),t.jsx("br",{}),'The API key was displayed when you first started the server. Check your server logs for "API Key:" or look in the ',t.jsx("code",{children:"data/api_key.txt"})," file."]})})]}):t.jsxs(t.Fragment,{children:[t.jsxs("p",{className:"text-themed-secondary text-center mb-6",children:["To identify Steam games from your cache logs, depot mapping data is required.","Choose how you'd like to initialize this data:"]}),A&&t.jsx("div",{className:"mb-6 p-4 rounded-lg",style:{backgroundColor:"var(--theme-info-bg)",borderColor:"var(--theme-info)",color:"var(--theme-info-text)"},children:t.jsxs("p",{className:"text-sm",children:[t.jsx("strong",{children:"Current PICS Data Status:"}),t.jsx("br",{}),((te=A.jsonFile)==null?void 0:te.exists)&&t.jsxs(t.Fragment,{children:["JSON File: ",((re=(ie=A.jsonFile)==null?void 0:ie.totalMappings)==null?void 0:re.toLocaleString())??0," mappings",t.jsx("br",{})]}),"Database: ",((q=(ae=A.database)==null?void 0:ae.totalMappings)==null?void 0:q.toLocaleString())??0," mappings",t.jsx("br",{}),"SteamKit2: ",((F=(V=A.steamKit2)==null?void 0:V.depotCount)==null?void 0:F.toLocaleString())??0," depots",(Z=A.steamKit2)!=null&&Z.isReady?" (Ready)":" (Not Ready)"]})}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{className:"p-6 rounded-lg border-2 transition-all",style:{backgroundColor:b==="cloud"?"var(--theme-primary)/10":"var(--theme-bg-tertiary)",borderColor:b==="cloud"?"var(--theme-primary)":"var(--theme-border-primary)"},children:[t.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[t.jsx(De,{size:24,style:{color:"var(--theme-info)"}}),t.jsx("h3",{className:"text-lg font-semibold text-themed-primary",children:"Pre-created Data"})]}),t.jsxs("p",{className:"text-sm text-themed-secondary mb-3",children:["Download community-maintained depot mappings from GitHub.",A&&(((B=A.database)==null?void 0:B.totalMappings)>0||((L=A.steamKit2)==null?void 0:L.depotCount)>0)&&t.jsx("span",{className:"text-themed-success",children:" Will update existing data."})]}),t.jsxs("ul",{className:"text-xs text-themed-muted space-y-1 mb-4",children:[t.jsx("li",{children:"âœ“ Quick setup (~30 seconds)"}),t.jsx("li",{children:"âœ“ 290,000+ mappings ready"}),t.jsx("li",{children:"âœ“ Regularly updated"}),t.jsx("li",{children:"âœ“ Won't delete existing data"})]}),t.jsx(Se,{variant:"filled",color:"blue",leftSection:s&&b==="cloud"?t.jsx(ge,{className:"w-4 h-4 animate-spin"}):t.jsx(De,{className:"w-4 h-4"}),onClick:z,disabled:s||i,fullWidth:!0,children:s&&b==="cloud"?"Downloading...":"Download Pre-created"})]}),t.jsxs("div",{className:"p-6 rounded-lg border-2 transition-all",style:{backgroundColor:b==="generate"?"var(--theme-primary)/10":"var(--theme-bg-tertiary)",borderColor:b==="generate"?"var(--theme-primary)":"var(--theme-border-primary)"},children:[t.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[t.jsx(ke,{size:24,style:{color:"var(--theme-success)"}}),t.jsx("h3",{className:"text-lg font-semibold text-themed-primary",children:"Generate Fresh"})]}),t.jsxs("p",{className:"text-sm text-themed-secondary mb-3",children:["Build your own depot mappings directly from Steam.",A&&(((ce=A.database)==null?void 0:ce.totalMappings)>0||((le=A.steamKit2)==null?void 0:le.depotCount)>0)&&t.jsx("span",{className:"text-themed-success",children:" Will continue from where you left off."})]}),t.jsxs("ul",{className:"text-xs text-themed-muted space-y-1 mb-4",children:[t.jsx("li",{children:"âœ“ Latest data from Steam"}),t.jsx("li",{children:"âœ“ Customized to your needs"}),t.jsx("li",{children:"âœ“ Continues from last position"}),t.jsx("li",{children:"â—‹ Takes 10-30 minutes (if starting fresh)"})]}),t.jsx(Se,{variant:"filled",color:"green",leftSection:s&&b==="generate"?t.jsx(ge,{className:"w-4 h-4 animate-spin"}):t.jsx(ke,{className:"w-4 h-4"}),onClick:Q,disabled:s||i,fullWidth:!0,children:s&&b==="generate"?"Processing...":A&&(((h=A.database)==null?void 0:h.totalMappings)>0||((f=A.steamKit2)==null?void 0:f.depotCount)>0)?"Continue Generation":"Generate Fresh Data"})]})]})]})}),g&&t.jsx("div",{className:"p-4 rounded-lg mb-4",style:{backgroundColor:"var(--theme-info-bg)",borderColor:"var(--theme-info)",color:"var(--theme-info-text)"},children:t.jsxs("p",{className:"text-sm flex items-center gap-2",children:[t.jsx(ge,{className:"w-4 h-4 animate-spin"}),g]})}),E&&t.jsx("div",{className:"p-4 rounded-lg mb-4",style:{backgroundColor:"var(--theme-error-bg)",borderColor:"var(--theme-error)",color:"var(--theme-error-text)"},children:t.jsx("p",{className:"text-sm",children:E})}),o&&t.jsx("div",{className:"p-4 rounded-lg mb-4",style:{backgroundColor:"var(--theme-error-bg)",borderColor:"var(--theme-error)",color:"var(--theme-error-text)"},children:t.jsx("p",{className:"text-sm",children:o})}),i&&t.jsxs("div",{className:"text-center text-xs text-themed-muted",children:[t.jsx(Te,{className:"inline w-4 h-4 mr-1"}),"Please authenticate to continue with depot initialization."]})]})]})},$e=l.lazy(()=>pe(()=>import("./Dashboard-BLfxoDu_.js"),__vite__mapDeps([0,1,2,3,4,5]))),ft=l.lazy(()=>pe(()=>import("./DownloadsTab-CY6ro0Vv.js"),__vite__mapDeps([6,1,2,7,3]))),bt=l.lazy(()=>pe(()=>import("./ClientsTab-CB8NoBrc.js"),__vite__mapDeps([8,1,2,3,5]))),pt=l.lazy(()=>pe(()=>import("./ServicesTab-ZMUVZn-w.js"),__vite__mapDeps([9,1,2,3,5]))),xt=l.lazy(()=>pe(()=>import("./ManagementTab-CHYNHKQ0.js"),__vite__mapDeps([10,1,2,3,7,11]))),vt=()=>{const[n,e]=l.useState("dashboard"),{connectionStatus:a}=it(),[s,r]=l.useState(null),[o,c]=l.useState(!0),[g,d]=l.useState(!1),[b,w]=l.useState(!0);l.useEffect(()=>{(async()=>{try{const T=await K.checkAuth();d(T.isAuthenticated)}catch(T){console.error("Failed to check auth status:",T),d(!1)}finally{w(!1)}})()},[]),l.useEffect(()=>{if(!b){const C=setInterval(()=>{d(K.isAuthenticated)},1e3);return()=>clearInterval(C)}},[b]),l.useEffect(()=>{if(b)return;const C=async()=>{var p,N,k,E;try{const $=await fetch("/api/gameinfo/pics-status",{headers:H.getHeaders()});if($.ok){const A=await $.json(),_=((p=A.database)==null?void 0:p.totalMappings)>0||((N=A.steamKit2)==null?void 0:N.isReady)&&((k=A.steamKit2)==null?void 0:k.depotCount)>0||((E=A.steamKit2)==null?void 0:E.isRebuildRunning)===!0;r(_)}else r(!1)}catch($){console.error("Failed to check depot initialization status:",$),r(!1)}finally{c(!1)}};C();const T=()=>{s!==null&&C()};return window.addEventListener("focus",T),()=>window.removeEventListener("focus",T)},[b,s]);const i=async()=>{var C,T,p,N;try{const k=await fetch("/api/gameinfo/pics-status",{headers:H.getHeaders()});if(k.ok){const E=await k.json();((C=E.database)==null?void 0:C.totalMappings)>0||((T=E.steamKit2)==null?void 0:T.isReady)&&((p=E.steamKit2)==null?void 0:p.depotCount)>0||((N=E.steamKit2)==null?void 0:N.isRebuildRunning)===!0?r(!0):console.warn("Depot initialization reported complete but no data found")}}catch(k){console.error("Error verifying depot initialization:",k)}},m=()=>{d(K.isAuthenticated)},x=()=>{const C=(()=>{switch(n){case"dashboard":return $e;case"downloads":return ft;case"clients":return bt;case"services":return pt;case"management":return xt;default:return $e}})();return t.jsx(l.Suspense,{fallback:t.jsx(Ie,{fullScreen:!1,message:"Loading..."}),children:t.jsx(C,{})})};return b||o?t.jsx("div",{className:"min-h-screen flex items-center justify-center",style:{backgroundColor:"var(--theme-bg-primary)"},children:t.jsx(Ie,{fullScreen:!1,message:b?"Checking authentication...":"Checking depot initialization status..."})}):g?s?t.jsxs("div",{className:"min-h-screen",style:{backgroundColor:"var(--theme-bg-primary)",color:"var(--theme-text-primary)",opacity:s?1:.5,pointerEvents:s?"auto":"none"},children:[t.jsx(ht,{connectionStatus:a}),t.jsx(mt,{activeTab:n,setActiveTab:e}),t.jsx(gt,{}),t.jsx("main",{className:"container mx-auto px-4 py-6",children:x()})]}):t.jsx(t.Fragment,{children:t.jsx(Ae,{onInitialized:i,isAuthenticated:g,onAuthChanged:m})}):t.jsx(t.Fragment,{children:t.jsx(Ae,{onInitialized:i,isAuthenticated:!1,onAuthChanged:m})})},yt=()=>t.jsx(ut,{children:t.jsx(nt,{children:t.jsx(ct,{children:t.jsx(vt,{})})})}),wt="1.2.0",Ct={version:wt};class St{constructor(){ue(this,"currentTheme",null);ue(this,"styleElement",null)}getContrastText(e){return!e||e==="transparent"?"var(--theme-text-primary)":getComputedStyle(document.documentElement).getPropertyValue("--theme-button-text").trim()||"#ffffff"}async loadThemes(){const e=this.getBuiltInThemes(),a=[],s=[];try{const c=await fetch(`${I}/theme`);if(c.ok){const g=await c.json();for(const d of g)if(d.format==="toml")try{const b=await fetch(`${I}/theme/${d.id}`);if(b.status===404){s.push(d.id);continue}if(b.ok){const w=await b.text(),i=this.parseTomlTheme(w);i&&a.push(i)}}catch(b){console.error(`Failed to load theme ${d.id}:`,b)}if(s.length>0&&this.currentTheme&&s.includes(this.currentTheme.meta.id)){const d=e.find(b=>b.meta.id==="dark-default");d&&this.applyTheme(d)}}}catch(c){console.error("Failed to load themes from server:",c)}const r=[...e],o=new Set(r.map(c=>c.meta.id));return a.forEach(c=>{o.has(c.meta.id)||(r.push(c),o.add(c.meta.id))}),r}getBuiltInThemes(){return[{meta:{id:"dark-default",name:"Dark Default",description:"Default dark theme with blue accents",author:"System",version:"1.0.0",isDark:!0},colors:{primaryColor:"#3b82f6",secondaryColor:"#8b5cf6",accentColor:"#06b6d4",bgPrimary:"#111827",bgSecondary:"#1f2937",bgTertiary:"#374151",bgHover:"#4b5563",textPrimary:"#ffffff",textSecondary:"#d1d5db",textMuted:"#9ca3af",textAccent:"#60a5fa",textPlaceholder:"#6b7280",dragHandleColor:"#6b7280",dragHandleHover:"#60a5fa",borderPrimary:"#374151",borderSecondary:"#4b5563",borderFocus:"#3b82f6",navBg:"#1f2937",navBorder:"#374151",navTabActive:"#3b82f6",navTabInactive:"#9ca3af",navTabHover:"#ffffff",navTabActiveBorder:"#3b82f6",navMobileMenuBg:"#1f2937",navMobileItemHover:"#374151",success:"#10b981",successBg:"#064e3b",successText:"#34d399",warning:"#fb923c",warningBg:"#44403c",warningText:"#fcd34d",error:"#ef4444",errorBg:"#7f1d1d",errorText:"#fca5a5",info:"#3b82f6",infoBg:"#1e3a8a",infoText:"#93c5fd",steamColor:"#3b82f6",epicColor:"#8b5cf6",originColor:"#10b981",blizzardColor:"#ef4444",wsusColor:"#06b6d4",riotColor:"#f59e0b",cardBg:"#1f2937",cardBorder:"#374151",buttonBg:"#3b82f6",buttonHover:"#2563eb",buttonText:"#ffffff",inputBg:"#374151",inputBorder:"#4b5563",inputFocus:"#3b82f6",badgeBg:"#3b82f6",badgeText:"#ffffff",progressBar:"#3b82f6",progressBg:"#374151",hitRateHighBg:"#064e3b",hitRateHighText:"#34d399",hitRateMediumBg:"#1e3a8a",hitRateMediumText:"#93c5fd",hitRateLowBg:"#44403c",hitRateLowText:"#fbbf24",hitRateWarningBg:"#44403c",hitRateWarningText:"#fcd34d",actionResetBg:"#f59e0b",actionResetHover:"#d97706",actionProcessBg:"#10b981",actionProcessHover:"#059669",actionDeleteBg:"#ef4444",actionDeleteHover:"#dc2626",iconBgBlue:"#3b82f6",iconBgGreen:"#10b981",iconBgEmerald:"#10b981",iconBgPurple:"#8b5cf6",iconBgIndigo:"#6366f1",iconBgOrange:"#f97316",iconBgYellow:"#eab308",iconBgCyan:"#06b6d4",iconBgRed:"#ef4444",chartColor1:"#3b82f6",chartColor2:"#10b981",chartColor3:"#f59e0b",chartColor4:"#ef4444",chartColor5:"#8b5cf6",chartColor6:"#06b6d4",chartColor7:"#f97316",chartColor8:"#ec4899",chartBorderColor:"#1f2937",chartGridColor:"#374151",chartTextColor:"#9ca3af",chartCacheHitColor:"#10b981",chartCacheMissColor:"#f59e0b",scrollbarTrack:"#374151",scrollbarThumb:"#6B7280",scrollbarHover:"#9CA3AF",publicAccessBg:"rgba(16, 185, 129, 0.2)",publicAccessText:"#34d399",publicAccessBorder:"rgba(16, 185, 129, 0.3)",securedAccessBg:"rgba(245, 158, 11, 0.2)",securedAccessText:"#fbbf24",securedAccessBorder:"rgba(245, 158, 11, 0.3)"}},{meta:{id:"light-default",name:"Light Default",description:"Default light theme with blue accents",author:"System",version:"1.0.0",isDark:!1},colors:{primaryColor:"#3b82f6",secondaryColor:"#8b5cf6",accentColor:"#06b6d4",bgPrimary:"#f8f9fa",bgSecondary:"#ffffff",bgTertiary:"#f3f4f6",bgHover:"#e5e7eb",textPrimary:"#111827",textSecondary:"#374151",textMuted:"#6b7280",textAccent:"#2563eb",textPlaceholder:"#9ca3af",dragHandleColor:"#9ca3af",dragHandleHover:"#2563eb",borderPrimary:"#e5e7eb",borderSecondary:"#d1d5db",borderFocus:"#3b82f6",navBg:"#ffffff",navBorder:"#e5e7eb",navTabActive:"#3b82f6",navTabInactive:"#6b7280",navTabHover:"#111827",navTabActiveBorder:"#3b82f6",navMobileMenuBg:"#ffffff",navMobileItemHover:"#f3f4f6",success:"#10b981",successBg:"#d1fae5",successText:"#047857",warning:"#f97316",warningBg:"#fef3c7",warningText:"#b45309",error:"#ef4444",errorBg:"#fee2e2",errorText:"#991b1b",info:"#3b82f6",infoBg:"#dbeafe",infoText:"#1e40af",steamColor:"#3b82f6",epicColor:"#8b5cf6",originColor:"#10b981",blizzardColor:"#ef4444",wsusColor:"#06b6d4",riotColor:"#f59e0b",cardBg:"#ffffff",cardBorder:"#e5e7eb",buttonBg:"#3b82f6",buttonHover:"#2563eb",buttonText:"#ffffff",inputBg:"#ffffff",inputBorder:"#d1d5db",inputFocus:"#3b82f6",badgeBg:"#3b82f6",badgeText:"#ffffff",progressBar:"#3b82f6",progressBg:"#e5e7eb",hitRateHighBg:"#d1fae5",hitRateHighText:"#047857",hitRateMediumBg:"#dbeafe",hitRateMediumText:"#1e40af",hitRateLowBg:"#fef3c7",hitRateLowText:"#92400e",hitRateWarningBg:"#fef3c7",hitRateWarningText:"#92400e",actionResetBg:"#f59e0b",actionResetHover:"#d97706",actionProcessBg:"#10b981",actionProcessHover:"#059669",actionDeleteBg:"#ef4444",actionDeleteHover:"#dc2626",iconBgBlue:"#3b82f6",iconBgGreen:"#10b981",iconBgEmerald:"#10b981",iconBgPurple:"#8b5cf6",iconBgIndigo:"#6366f1",iconBgOrange:"#f97316",iconBgYellow:"#eab308",iconBgCyan:"#06b6d4",iconBgRed:"#ef4444",chartColor1:"#3b82f6",chartColor2:"#10b981",chartColor3:"#f59e0b",chartColor4:"#ef4444",chartColor5:"#8b5cf6",chartColor6:"#06b6d4",chartColor7:"#f97316",chartColor8:"#ec4899",chartBorderColor:"#e5e7eb",chartGridColor:"#d1d5db",chartTextColor:"#6b7280",chartCacheHitColor:"#047857",chartCacheMissColor:"#b45309",scrollbarTrack:"#e5e7eb",scrollbarThumb:"#9ca3af",scrollbarHover:"#6b7280",publicAccessBg:"#d1fae5",publicAccessText:"#047857",publicAccessBorder:"#86efac",securedAccessBg:"#fef3c7",securedAccessText:"#92400e",securedAccessBorder:"#fde047"}}]}async getTheme(e){const a=this.getBuiltInThemes().find(s=>s.meta.id===e);if(a)return a;try{const s=await fetch(`${I}/theme/${e}`);if(!s.ok)return null;const r=await s.text();return this.parseTomlTheme(r)}catch(s){return console.error("Error loading theme:",s),null}}parseTomlTheme(e){try{const a=tt.parse(e);return!a.meta||!a.meta.id||!a.meta.name?(console.error("Invalid theme: missing meta.id or meta.name"),null):a.colors?a:(console.error("Invalid theme: missing colors section"),null)}catch(a){return console.error("Error parsing TOML theme:",a),null}}async uploadTheme(e){const a=await e.text(),s=this.parseTomlTheme(a);if(!s)throw new Error("Invalid TOML theme format");const r=new FormData;r.append("file",e);try{const o=await fetch(`${I}/theme/upload`,{method:"POST",headers:K.getAuthHeaders(),body:r});if(!o.ok){const c=await o.json().catch(()=>({error:"Failed to upload theme"}));throw new Error(c.error||"Failed to upload theme")}return s}catch(o){throw o.message.includes("Failed to fetch")||o.message.includes("NetworkError")?new Error("Cannot save theme: API server is not running. Please start the LANCache Manager API service."):o}}async deleteTheme(e){const a=await fetch(`${I}/theme/${e}`,{method:"DELETE",headers:K.getAuthHeaders()});if(!a.ok&&a.status!==404){const s=await a.json().catch(()=>({error:"Failed to delete theme"}));throw new Error(s.error||"Failed to delete theme")}}applyDefaultVariables(){const e=localStorage.getItem("lancache_sharp_corners")==="true",o=`
      :root {
        --theme-primary: #3b82f6;
        --theme-secondary: #8b5cf6;
        --theme-accent: #06b6d4;
        --theme-bg-primary: #111827;
        --theme-bg-secondary: #1f2937;
        --theme-bg-tertiary: #374151;
        --theme-bg-hover: #4b5563;
        --theme-text-primary: #ffffff;
        --theme-text-secondary: #d1d5db;
        --theme-text-muted: #9ca3af;
        --theme-text-accent: #60a5fa;
        --theme-drag-handle: #6b7280;
        --theme-drag-handle-hover: #60a5fa;
        --theme-border-primary: #374151;
        --theme-border-secondary: #4b5563;
        --theme-border-focus: #3b82f6;
        --theme-border-radius: ${e?"0px":"0.5rem"};
        --theme-border-radius-lg: ${e?"0px":"0.75rem"};
        --theme-border-radius-xl: ${e?"0px":"1rem"};
        --theme-nav-bg: #1f2937;
        --theme-nav-border: #374151;
        --theme-nav-tab-active: #3b82f6;
        --theme-nav-tab-inactive: #9ca3af;
        --theme-nav-tab-hover: #ffffff;
        --theme-nav-tab-active-border: #3b82f6;
        --theme-nav-mobile-menu-bg: #1f2937;
        --theme-nav-mobile-item-hover: #374151;
        --theme-success: #10b981;
        --theme-success-bg: #064e3b;
        --theme-success-text: #34d399;
        --theme-warning: #f59e0b;
        --theme-warning-bg: #78350f;
        --theme-warning-text: #fbbf24;
        --theme-error: #ef4444;
        --theme-error-bg: #7f1d1d;
        --theme-error-text: #fca5a5;
        --theme-info: #3b82f6;
        --theme-info-bg: #1e3a8a;
        --theme-info-text: #93c5fd;
        --theme-steam: #3b82f6;
        --theme-epic: #8b5cf6;
        --theme-origin: #10b981;
        --theme-blizzard: #ef4444;
        --theme-wsus: #06b6d4;
        --theme-riot: #f59e0b;
        --theme-card-bg: #1f2937;
        --theme-card-border: #374151;
        --theme-button-bg: #3b82f6;
        --theme-button-hover: #2563eb;
        --theme-button-text: #ffffff;
        --theme-input-bg: #374151;
        --theme-input-border: #4b5563;
        --theme-input-focus: #3b82f6;
        --theme-checkbox-accent: #3b82f6;
        --theme-checkbox-border: #4b5563;
        --theme-slider-accent: #3b82f6;
        --theme-slider-thumb: #3b82f6;
        --theme-slider-track: #374151;
        --theme-badge-bg: #3b82f6;
        --theme-badge-text: #ffffff;
        --theme-progress-bar: #3b82f6;
        --theme-progress-bg: #374151;
        --theme-hit-rate-high-bg: #064e3b;
        --theme-hit-rate-high-text: #34d399;
        --theme-hit-rate-medium-bg: #1e3a8a;
        --theme-hit-rate-medium-text: #93c5fd;
        --theme-hit-rate-low-bg: #ea580c;
        --theme-hit-rate-low-text: #fb923c;
        --theme-hit-rate-warning-bg: #78350f;
        --theme-hit-rate-warning-text: #fbbf24;
        --theme-action-reset-bg: #f59e0b;
        --theme-action-reset-hover: #d97706;
        --theme-action-process-bg: #10b981;
        --theme-action-process-hover: #059669;
        --theme-action-delete-bg: #ef4444;
        --theme-action-delete-hover: #dc2626;
        --theme-icon-blue: #3b82f6;
        --theme-icon-green: #10b981;
        --theme-icon-emerald: #10b981;
        --theme-icon-purple: #8b5cf6;
        --theme-icon-indigo: #6366f1;
        --theme-icon-orange: #f97316;
        --theme-icon-yellow: #eab308;
        --theme-icon-cyan: #06b6d4;
        --theme-icon-red: #ef4444;
        --theme-chart-1: #3b82f6;
        --theme-chart-2: #10b981;
        --theme-chart-3: #f59e0b;
        --theme-chart-4: #ef4444;
        --theme-chart-5: #8b5cf6;
        --theme-chart-6: #06b6d4;
        --theme-chart-7: #f97316;
        --theme-chart-8: #ec4899;
        --theme-chart-border: #1f2937;
        --theme-chart-grid: #374151;
        --theme-chart-text: #9ca3af;
        --theme-chart-cache-hit: #10b981;
        --theme-chart-cache-miss: #f59e0b;
      }
    `;let c=document.getElementById("lancache-default-vars");c||(c=document.createElement("style"),c.id="lancache-default-vars",document.head.appendChild(c)),c.textContent=o}clearTheme(){this.styleElement&&(this.styleElement.remove(),this.styleElement=null);const e=document.documentElement;e.removeAttribute("data-theme"),e.removeAttribute("data-theme-id"),this.currentTheme=null,localStorage.removeItem("lancache_selected_theme"),localStorage.removeItem("lancache_theme_css"),localStorage.removeItem("lancache_theme_dark"),this.applyDefaultVariables()}applyTheme(e){var i;if(!e||!e.colors)return;this.styleElement&&(this.styleElement.remove(),this.styleElement=null);const a=document.getElementById("lancache-theme-preload");a&&a.remove();const s=document.getElementById("lancache-default-preload");s&&s.remove();const r=e.colors,o=localStorage.getItem("lancache_sharp_corners")==="true",c=o?"0px":"0.5rem",g=o?"0px":"0.75rem",d=o?"0px":"1rem",b=`
    :root {
      --theme-primary: ${r.primaryColor};
      --theme-secondary: ${r.secondaryColor};
      --theme-accent: ${r.accentColor};
      --theme-bg-primary: ${r.bgPrimary};
      --theme-bg-secondary: ${r.bgSecondary};
      --theme-bg-tertiary: ${r.bgTertiary};
      --theme-bg-hover: ${r.bgHover};
      --theme-text-primary: ${r.textPrimary};
      --theme-text-secondary: ${r.textSecondary};
      --theme-text-muted: ${r.textMuted};
      --theme-text-accent: ${r.textAccent};
      --theme-text-placeholder: ${r.textPlaceholder};
      --theme-drag-handle: ${r.dragHandleColor};
      --theme-drag-handle-hover: ${r.dragHandleHover};
      --theme-border-primary: ${r.borderPrimary};
      --theme-border-secondary: ${r.borderSecondary};
      --theme-border-focus: ${r.borderFocus};
      --theme-border-radius: ${c};
      --theme-border-radius-lg: ${g};
      --theme-border-radius-xl: ${d};
      
      /* Navigation Variables */
      --theme-nav-bg: ${r.navBg};
      --theme-nav-border: ${r.navBorder};
      --theme-nav-tab-active: ${r.navTabActive};
      --theme-nav-tab-inactive: ${r.navTabInactive};
      --theme-nav-tab-hover: ${r.navTabHover};
      --theme-nav-tab-active-border: ${r.navTabActiveBorder};
      --theme-nav-mobile-menu-bg: ${r.navMobileMenuBg};
      --theme-nav-mobile-item-hover: ${r.navMobileItemHover};
      
      /* Status Colors */
      --theme-success: ${r.success};
      --theme-success-bg: ${r.successBg};
      --theme-success-text: ${r.successText};
      --theme-warning: ${r.warning};
      --theme-warning-bg: ${r.warningBg};
      --theme-warning-text: ${r.warningText};
      --theme-error: ${r.error};
      --theme-error-bg: ${r.errorBg};
      --theme-error-text: ${r.errorText};
      --theme-info: ${r.info};
      --theme-info-bg: ${r.infoBg};
      --theme-info-text: ${r.infoText};
      
      /* Service Colors */
      --theme-steam: ${r.steamColor};
      --theme-epic: ${r.epicColor};
      --theme-origin: ${r.originColor};
      --theme-blizzard: ${r.blizzardColor};
      --theme-wsus: ${r.wsusColor};
      --theme-riot: ${r.riotColor};
      
      /* Component Colors */
      --theme-card-bg: ${r.cardBg};
      --theme-card-border: ${r.cardBorder};
      --theme-button-bg: ${r.buttonBg};
      --theme-button-hover: ${r.buttonHover};
      --theme-button-text: ${r.buttonText};
      --theme-input-bg: ${r.inputBg};
      --theme-input-border: ${r.inputBorder};
      --theme-input-focus: ${r.inputFocus};
      --theme-checkbox-accent: ${r.checkboxAccent};
      --theme-checkbox-border: ${r.checkboxBorder};
      --theme-slider-accent: ${r.sliderAccent};
      --theme-slider-thumb: ${r.sliderThumb};
      --theme-slider-track: ${r.sliderTrack};
      --theme-badge-bg: ${r.badgeBg};
      --theme-badge-text: ${r.badgeText};
      --theme-progress-bar: ${r.progressBar};
      --theme-progress-bg: ${r.progressBg};
      
      /* Hit Rate Colors - FIXED WITH PRETTIER COLORS */
      --theme-hit-rate-high-bg: ${r.hitRateHighBg};
      --theme-hit-rate-high-text: ${r.hitRateHighText};
      --theme-hit-rate-medium-bg: ${r.hitRateMediumBg};
      --theme-hit-rate-medium-text: ${r.hitRateMediumText};
      --theme-hit-rate-low-bg: ${r.hitRateLowBg};
      --theme-hit-rate-low-text: ${r.hitRateLowText};
      --theme-hit-rate-warning-bg: ${r.hitRateWarningBg};
      --theme-hit-rate-warning-text: ${r.hitRateWarningText};
      
      /* Action Button Colors */
      --theme-action-reset-bg: ${r.actionResetBg};
      --theme-action-reset-hover: ${r.actionResetHover};
      --theme-action-process-bg: ${r.actionProcessBg};
      --theme-action-process-hover: ${r.actionProcessHover};
      --theme-action-delete-bg: ${r.actionDeleteBg};
      --theme-action-delete-hover: ${r.actionDeleteHover};
      
      /* Icon Colors */
      --theme-icon-blue: ${r.iconBgBlue};
      --theme-icon-green: ${r.iconBgGreen};
      --theme-icon-emerald: ${r.iconBgEmerald};
      --theme-icon-purple: ${r.iconBgPurple};
      --theme-icon-indigo: ${r.iconBgIndigo};
      --theme-icon-orange: ${r.iconBgOrange};
      --theme-icon-yellow: ${r.iconBgYellow};
      --theme-icon-cyan: ${r.iconBgCyan};
      --theme-icon-red: ${r.iconBgRed};
      
      /* Chart Colors */
      --theme-chart-1: ${r.chartColor1};
      --theme-chart-2: ${r.chartColor2};
      --theme-chart-3: ${r.chartColor3};
      --theme-chart-4: ${r.chartColor4};
      --theme-chart-5: ${r.chartColor5};
      --theme-chart-6: ${r.chartColor6};
      --theme-chart-7: ${r.chartColor7};
      --theme-chart-8: ${r.chartColor8};
      --theme-chart-border: ${r.chartBorderColor};
      --theme-chart-grid: ${r.chartGridColor};
      --theme-chart-text: ${r.chartTextColor};
      --theme-chart-cache-hit: ${r.chartCacheHitColor};
      --theme-chart-cache-miss: ${r.chartCacheMissColor};
      
      /* Scrollbar Colors */
      --theme-scrollbar-track: ${r.scrollbarTrack||r.bgTertiary};
      --theme-scrollbar-thumb: ${r.scrollbarThumb||r.textMuted};
      --theme-scrollbar-hover: ${r.scrollbarHover||r.textSecondary};

      /* Access Indicator Colors */
      --theme-public-access-bg: ${r.publicAccessBg||r.warningBg};
      --theme-public-access-text: ${r.publicAccessText||r.errorText};
      --theme-public-access-border: ${r.publicAccessBorder||r.error};
      --theme-secured-access-bg: ${r.securedAccessBg};
      --theme-secured-access-text: ${r.securedAccessText};
      --theme-secured-access-border: ${r.securedAccessBorder};
    }

    /* Global Transitions */
    body * {
      transition: background-color 0.2s ease, color 0.2s ease, border-color 0.2s ease;
    }

    /* Global Body Style */
    body {
      background-color: var(--theme-bg-primary) !important;
      color: var(--theme-text-primary) !important;
    }

    /* Custom CSS from theme */
    ${((i=e.css)==null?void 0:i.content)||""}
  `;this.styleElement=document.createElement("style"),this.styleElement.id="lancache-theme",this.styleElement.textContent=b,document.head.appendChild(this.styleElement);const w=document.documentElement;w.setAttribute("data-theme",e.meta.isDark?"dark":"light"),w.setAttribute("data-theme-id",e.meta.id),this.currentTheme=e,localStorage.setItem("lancache_selected_theme",e.meta.id),localStorage.setItem("lancache_theme_css",b),localStorage.setItem("lancache_theme_dark",e.meta.isDark?"true":"false"),window.dispatchEvent(new Event("themechange"))}async loadSavedTheme(){this.migrateLocalStorageFeatures();const e=document.getElementById("lancache-theme-preload"),a=localStorage.getItem("lancache_selected_theme");if(e&&a){const r=await this.getTheme(a);if(r){this.applyTheme(r),this.currentTheme=r;return}localStorage.removeItem("lancache_selected_theme"),localStorage.removeItem("lancache_theme_css"),localStorage.removeItem("lancache_theme_dark")}if(this.applyDefaultVariables(),a){const r=await this.getTheme(a);if(r){this.applyTheme(r);return}}const s=await this.getTheme("dark-default");s&&this.applyTheme(s)}migrateLocalStorageFeatures(){const e=localStorage.getItem("lancache_migration_version"),a=Ct.version;e!==a&&(localStorage.getItem("lancache_sharp_corners")||localStorage.setItem("lancache_sharp_corners","false"),localStorage.setItem("lancache_migration_version",a))}getCurrentThemeId(){var e;return((e=this.currentTheme)==null?void 0:e.meta.id)||"dark-default"}getCurrentTheme(){return this.currentTheme}isThemeApplied(){return this.currentTheme!==null}exportTheme(e){var s;let a="";return a+=`[meta]
`,a+=`name = "${e.meta.name}"
`,a+=`id = "${e.meta.id}"
`,e.meta.description&&(a+=`description = "${e.meta.description}"
`),e.meta.author&&(a+=`author = "${e.meta.author}"
`),e.meta.version&&(a+=`version = "${e.meta.version}"
`),e.meta.isDark!==void 0&&(a+=`isDark = ${e.meta.isDark}
`),a+=`
`,a+=`[colors]
`,e.colors&&Object.entries(e.colors).forEach(([r,o])=>{a+=`${r} = "${o}"
`}),a+=`
`,e.custom&&Object.keys(e.custom).length>0&&(a+=`[custom]
`,Object.entries(e.custom).forEach(([r,o])=>{a+=`"${r}" = "${o}"
`}),a+=`
`),(s=e.css)!=null&&s.content&&(a+=`[css]
`,a+=`content = """
${e.css.content}
"""
`),a}setSharpCorners(e){localStorage.setItem("lancache_sharp_corners",e.toString()),this.currentTheme?this.applyTheme(this.currentTheme):this.applyDefaultVariables()}getSharpCorners(){return localStorage.getItem("lancache_sharp_corners")==="true"}}const jt=new St;jt.loadSavedTheme();Ze.createRoot(document.getElementById("root")).render(t.jsx(et.StrictMode,{children:t.jsx(yt,{})}));export{H as A,Se as B,Nt as F,It as S,it as a,K as b,I as c,jt as t,He as u};
//# sourceMappingURL=index-BWakVz_d.js.map
