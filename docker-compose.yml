version: '3.8'

services:
  lancache-manager:
    image: ghcr.io/regix1/lancache-manager:latest
    container_name: lancache-manager
    restart: unless-stopped
    user: root
    ports:
      - "8080:80"
    volumes:
      # Your data directory
      - ./data:/data
      
      # Your actual paths from CACHE_ROOT
      - /mnt/logs:/logs:ro
      - /mnt/cache/cache:/cache:ro
    environment:
      - PUID=1006
      - PGID=1006
      - TZ=America/Chicago
      - ASPNETCORE_URLS=http://+:80
      - LanCache__LogPath=/logs/access.log
      - LanCache__CachePath=/cache
      - LanCache__StartFromEndOfLog=true
      - LanCache__ProcessHistoricalLogs=false
      # Security Settings
      - Security__EnableAuthentication=true    # GLOBAL: Set to 'false' to disable ALL authentication (dev/testing only)
      - Security__MaxAdminDevices=3            # Maximum number of admin devices that can share the same API key
      - Security__RequireAuthForMetrics=false  # Set to 'true' to require API key for /metrics endpoint (Prometheus/Grafana access)